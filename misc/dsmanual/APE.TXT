            APPENDIX E.  ADDITIONAL OPERATIONS

      

CONTENTS

           Voice/Data
           High Speed/Low Speed Protocol
           Dedicated and Leased Line
           Operations
           Hewlett Packard 3000 Installations
           MI/MIC Operations
VOICE/DATA

      

      The voice/data switch is located on the
      modem's front panel.  While the switch's
      primary function is to toggle back and
      forth between voice and data
      communications, this new feature also
      allows you to perform other functions at
      the touch of a switch.  Set Register S32
      for any one of the functions, and change
      that function any time you wish.

      NOTE:  Use the voice/data switch when
      the modem is in Command mode (offline).
      If you press the switch while the modem
      is online, the modem hangs up and
      returns a NO CARRIER result code.


VOICE/DATA OPERATIONSêS32=1, S32=2 OR AT
COMMANDS

      When you assemble the Courier, you have
      the option of plugging your phone into
      the second modular jack of the modem so
      it's available for voice calls.  You can
      also switch between the phone and modem
      during a call.

      Users of Courier modems have always been
      able to phone and make arrangements with
      another user before turning control of
      the call over to the modems.  However,
      it was difficult to switch from data to
      voice.  Now, if the remote modem has
      handset exclusion, you can change from
      voice to data and back again, with or
      without issuing a command.

      Handset exclusion means that if the
      modem is using the phone line, your
      phone (handset) is automatically dis-
      connected.  However, if you keep the
      handset off hook, once you hang up the
      modem the handset takes over the phone
      line and you can use voice
      communications again.  If the remote
      user does not have handset exclusion,
      you may not be able to switch back to
      voice mode successfully once you have
      switched to data mode.

      The following instructions begin with
      toggling voice/data communications with
      the switch.  These are followed by
      instructions for doing the same thing
      with AT commands.  Keep in mind that you
      can use the switch and, if the remote
      user does not have a switch, he or she
      can follow the instructions for using
      the appropriate AT command.
Voice/Data SwitchêS32=1, S32=2

      1. Phone the other user to establish the
         bit rate, parity, word length and
         number of Stop bits the other
         person's modem accepts.  (Both modems
         should be offline, in Command mode.)

         You and the other user must also
         agree on which modem will go off hook
         in Originate mode and which in Answer
         mode.  The Courier is factory set to
         go off hook in Originate mode, S32=1.
         The Answer modem should have S32 set
         to 2.

         NOTE:  Either party's device can be
         the originate or answer modem:  it
         doesn't matter who made the phone
         call.  But one modem must first enter
         Originate mode and the other then
         enter Answer mode.

      2. Without hanging up the phone, press
         the voice/data switch.

         (If S32 is set to 2, Answer mode,
         press the voice/data switch
         immediately after the remote user
         forces the remote modem off hook in
         Originate mode.)

      3. The other party should force the
         remote modem off hook in Answer mode
         by pressing the switch.

         (If yours is the Answer modem
         (S32=2), the other party should press
         the voice/data switch immediately
         before you do so.)

      4. If the remote modem has handset
         exclusion, the remote user should
         also keep the phone off hook in order
         to switch back to voice later.  If
         the remote modem doesn't have handset
         exclusion, you can try to switch back
         to voice later.  Or, you both can
         hang up your phones as soon as the
         modems go off hook.


Software CommandsêATD, ATA

      If your voice/data switch is set for a
      function other than voice/data
      operations and you don't wish to change
      it, use commands.

      1. Call the other user to establish the
         bit rate, parity, word length and
         number of Stop bits the other
         person's modem accepts.  Determine
         which modem will originate and which
         will answer.

      2. If you are to originate the
         connection, type the following
         command:
             ATD <Enter>
         NOTE:  Be sure the modem is not set
         to X2, X4, X6 or X7, or it will
         return the NO DIAL TONE result code
         and hang up.

      3. The other party must then have the
         remote modem go off hook in Answer
         mode.  The following command is used
         to do this:
             ATA <Enter>

      4. If the remote modem also has handset
         exclusion, leave both phones off hook
         in case you wish to switch back again
         to voice after your data transfer.
         If the remote modem doesn't have
         handset exclusion, switching back to
         voice may not be successful.  If you
         don't want to switch back to voice
         later, hang up both phones as soon as
         the modems go off hook.


ALLOWABLE VOICE/DATA SWITCH FUNCTIONS

      Use Register S32 to set the voice/data
      switch for the function you desire.  The
      default is S32=1 ê pressing the switch
      forces the modem off hook in Originate
      mode.  Pressing the switch when you
      power on the modem causes it to perform
      a power-on self-test.

      S32                          Related
      Value                        Voice/Data
      Switch Function              Command
      
       0                           Disabled  ê
       1       Voice/Data+Originate Mode
      (Default)                    ATD
                                        (Chapt
      er 7,                                       
           Appendix C)
       2       Voice/Data+Answer Mode   ATA
                                        (Appen
      dix C)
       3       Redial Last Number  ATDL
      (Chapter 6)
       4       Dial Number Stored at position
      0ATDS0
                                        (Chapt
      er 6)
       5       Auto Answer On/Off Toggle     A
      TS0=0 or 1
                                        (Chapt
      er 6)
       6       Reset Modem         ATZ
      (Chapter 5)
       7       Initiate Remote Digital
      Loopback AT&T6, S16=8
                                        (Appen
      dix F)
       8       Busy Out Phone Line Toggle
      
                 HIGH SPEED/LOW SPEED PROTOCOL

OVERVIEW

      This appendix explains how an answering
      Courier modem switches its link rate to
      match the rate of a calling modem.  It
      may be of help also to those users who
      want to try programming their computers
      to switch bit rates to match the
      Courier's connection rate.  The material
      here applies only when the modem is set
      for variable rates at both the DTE
      (computer) and link interfaces, &B0 and
      &N0, respectively.

      In both Originate and Answer modes, if
      the link rate is set to &N0, the Courier
      negotiates with the remote modem to
      connect at the highest possible rate.
      In addition, if the modem is set to
      Extended or Advanced result codes (X1 or
      higher) it signals the DTE with one of
      the following result codes or the
      optional result codes selected with the
      &An command.

                CONNECT  (300 bps)
                CONNECT 1200  (1200 bps)
                CONNECT 2400  (2400 bps)
                CONNECT 4800  (4800 bps)
                CONNECT 9600  (9600 bps)

      The modem sends the result code at its
      previous rate.  Then it switches to the
      new connection rate.

      If your computer doesn't switch rates
      and you want to program it to do so, use
      the example on the next page as a guide.
      It demonstrates the occurrence of the
      CONNECT codes in the connection
      sequence, so that recognition of the
      codes can be used to switch the
      computer.  The example uses a sequence
      of incoming calls, but the codes apply
      to Originate mode connections as well.

      The example assumes the following
      settings:

      Software:      Initially 9600 or 19.2K,
               or 38.4K bps, allowing the
               following range of link rates:
               9600/4800/2400/1200/300/110 bps

      Modem:         X1 or higher (rate-
               specific CONNECT codes) &B0
               (variable DTE rate) &N0
               (variable link rate)

      NOTE:  The HST-mode link rate of 14.4K
      bps is not included   because this link
      rate requires a fixed DTE rate of 19.2K
      or 38.4K bps, that is, a modem setting
      of &B1.


Example

                            Modem     DTE/DCE
      Action                Response     Rate
      
      1. Power on.                                
         9600
      2. 300-bps call comes in.          RING     
      9600
                                      CONNECT     
      9600
      3. Data link is established.
                            300
         Data transfer takes place.
      4. Data session is over.     NO CARRIER
          300
         Call is ended; loss of
         carrier.
      5. 2400-bps call comes in.         RING     
      300
                                      CONNECT
      2400                  300
      6. Data link is established.                          
      2400
         Data transfer takes place.
      7. Data session is over.     NO CARRIER     
      2400
         Call is ended; loss of
         carrier.
      8. 9600-bps call comes in.         RING          
      2400
                                      CONNECT
      9600                  2400
      9. Data link is established.                
         9600
         Data transfer takes place.
      10.                   Data session is
      over.                 NO CARRIER   9600
         Call is ended; loss of
         carrier.

   Explanation

      1. The modem is powered on and is
         operating at 9600 bps.  If the
         software is then set to 19.2K bps and
         an AT command sent, the DTE/DCE rate
         would be 19.2K bps.

      2. A 300-bps modem calls.  The Courier
         senses the incoming signal and sends
         the messages RING and CONNECT to the
         computer.  These messages are sent at
         9600 (or 19.2K) bps, the current
         rate.

      3. Since the Courier responds CONNECT,
         rather than CONNECT 1200, 2400, or
         9600, the computer switches to 300
         bps. The modem automatically shifts
         to 300 bps to accept the data from
         the incoming call.

      4. The 300-bps data session is
         terminated; the modem sends the
         computer the message NO CARRIER at
         300 bps.

      5. A 2400-bps call comes in.  The modem
         responds RING and CONNECT 2400.
         These message are sent at the current
         bit rate of 300 bps.

      6. The computer, receiving the CONNECT
         2400 message, adjusts accordingly to
         the higher bit rate.  The modem also
         shifts to 2400 bps.

      7. The 2400-bps data session is
         terminated; the modem sends the
         computer the message NO CARRIER at
         2400 bps.
      8. A 9600-bps call comes in.  The modem
         responds RING and CONNECT 9600.
         These messages are sent to the
         computer at the current bit rate of
         2400 bps.

      9. The computer, receiving the CONNECT
         9600 message, adjusts accordingly to
         the higher bit rate.  The modem also
         shifts to 9600 bps.

      10. The 9600-bps data session is
         terminated; the modem sends the
         message NO CARRIER at 9600 bps.

      Keep in mind that whether or not your
      computer adjusts to these rate changes,
      the Courier automatically shifts
      connection rates if it is set to &N0.
DEDICATED AND LEASED LINE OPERATIONS

      The following operations apply in
      installations where the modem's phone
      line is not part of a public-access
      switched telephone network.  Instead,
      the modem is connected to a special
      user-installed telephone line or a line
      that is leased from the telephone
      company.  These lines are often referred
      to as dedicated (to a pair of modems) or
      private lines.

      In both types of installation there is a
      continuous point-to-point connection
      between two modems.  No dialing of phone
      numbers is required.  The modems may be
      in either Smart or Dumb mode (determined
      by the position of DIP switch 8).


The User-Installed or Leased Telephone Line

      User-installed lines are most commonly
      2-wire lines, similar to the 2-wire
      lines that connect residential phones to
      the public switched network.

      If you are leasing a line from the
      telephone company, request a 2-wire
      line, the type of line the modem is
      designed to work with.  If the telephone
      company only makes a 4-wire line
      available, you'll need a 4-wire to 2-
      wire converter at each end of the
      connection.  If the phone company does
      not install the converters, you will
      have to supply them.

      For optimal operations, we recommend
      that the physical length of these lines
      not exceed 5 miles.

Setting the Modem

      If the Courier is set to &L1, as
      described in what follows, and the
      remote AT-compatible modem has a
      comparable setting, they automatically
      connect when they are powered on.  They
      also reconnect, without any operator
      intervention, if a disturbance on the
      line is severe enough to break the
      connection.

      Set the modem as follows:

      1. Set your terminal or communications
         software to the rate at which you
         want the modems to communicate.  For
         example, use a terminal/software
         setting of 19.2K bps and, if both
         modems have the capability, they will
         connect at 14.4K bps.  The following
         instructions assume that you are
         familiar with
         the guidelines on using the &B and &H
         commands (Chapter 3 or, in more
         detail, Chapter 4) and the &W command
         (Chapter 5).

      2. Send the modem the following command:

             AT &B1 &S2 &H1 &L1 &W <Enter>

         &B1 fixes the modem's computer
         interface rate at 19.2K bps.  &S2
         causes the modem to send a Clear to
         Send (CTS) signal only after it sends
         the Carrier Detect (CD) signal, that
         is, only after it connects with the
         remote modem.  (See the note that
         follows.)  &H1 enables hardware (CTS)
         flow control.

         &L1 forces the modems off hook at
         power on and enables them to re-
         establish the connection should it be
         broken.  &W writes the settings to
         nonvolatile memory (NVRAM) as power-
         on defaults.

         NOTE:  We recommend using the &S2
         setting, to delay CTS until after the
         connection is made, as a precaution.
         If the modems are in the process of
         connecting or reconnecting, the
         Courier interprets any keyboard data
         entry, including an accidental key
         stroke, as a key-press abort, and
         hangs up.  Delaying CTS until after
         carrier detection prevents this from
         happening, for example, if you are
         typing data to the remote modem when
         the modems momentarily disconnect and
         begin to reconnect.  However, you
         have to set the modem for hardware
         flow control, &H1.
         If your software or machine does not
         support Clear to Send (CTS), don't
         include &S2 and &H1 in the command
         string suggested above.  Follow the
         Transmit Data flow control (&H)
         guidelines in Chapter 4.  But keep in
         mind that if the modems fail to
         connect or reconnect, the reason
         could be a key-press abort.

      3. Set the modem to load NVRAM settings
         at power-on, DIP switch 10 UP.  It
         does not matter if the modem is in
         Dumb or Smart mode (DIP switch 8).

      4. Decide which modem is to be the
         calling modem and which the answering
         modem.  Set the answering modem to
         Auto Answer, DIP switch 5 UP, and the
         calling modem to Auto Answer
         suppressed, DIP switch 5 DOWN.

      5. Power off and power on the modems.
         This initiates the new DIP switch
         settings and loads the power-on
         defaults, including &L1.  The modems
         go off hook and establish the
         connection.

      NOTE:  If the modems cannot restore the
      connection and you could not set the
      modem to &S2, the reason could be a key-
      press abort.  If the problem persists,
      however, you may need to call your
      telephone company to have them check
      your line.
                 HEWLETT PACKARD INSTALLATIONS

      During error control connections, the
      Courier recognizes the ASCII ENQ/ACK
      characters exchanged between many
      Hewlett Packard host computers and their
      terminals.  The HP host sends the
      terminal an ENQ character at predefined
      intervals, and sends no more data until
      the terminal responds with an ACK
      character.

      Courier modems manage this ENQ/ACK
      protocol so that communication is
      speeded up, thereby enabling HP
      terminals to achieve high speeds on
      dial-up lines.  Special flow control
      settings, using the &I command, are
      required for HP users.  These settings
      apply to ARQ and non-ARQ connections and
      to Courier modems set to either B0 or
      B1.  Disregard other Courier flow
      control commands.

      Set the Courier to Host mode if it is
      attached to the host computer, or to
      Terminal mode if it is attached to a
      terminal, as follows:

             Host mode      AT&I3 <Enter>

             Terminal mode  AT&I4 <Enter>
MI/MIC OPERATIONS

DESCRIPTION

      Mode Indicate/Mode Indicate Common
      (MI/MIC) closure is required by some
      installations whose existing hardware
      does the dialing.  The modems do not
      Auto Dial.

      In these situations, the modem must be
      forced off hook in Originate mode.  This
      is done by shorting (closing) two of the
      pins (not Tip and Ring) in the phone
      connector.  The modem is then ready to
      go online and accept data when it
      connects with the number dialed by the
      system equipment.

      Courier modems are shipped with MI/MIC
      disabled, that is, for normal use.  To
      set the modems for MI/MIC closure,
      enable bit 5 of Register S34:  ATS34=32
      or ATS34 .5=1.  We recommend that you
      write that setting to NVRAM as a power-
      on default.

      Once you've set Register S34, have the
      system force the modem off hook by
      closing the MI/MIC leads in the phone
      line connector.  The modem's OH (Off
      Hook) status light, or LED, goes on when
      the modem goes off hook.


TROUBLESHOOTING

      You may find that the modem does not
      respond to MI/MIC closure, which you can
      monitor by observing the LED.  Or the
      modem may fail to go back on hook when
      the DTE drops the Data Terminal Ready
      (DTR) signal.  The probable reason for
      either of these conditions is that your
      phone equipment reverses MI/MIC
      polarity.

      It's possible to solve this problem by
      reversing the modem's MI/MIC wiring.
      You'll have to dismantle the modem case
      and reset two switches on the printed
      circuit board, as follows.

      1. Power off the modem and disconnect
         all of its cables.

      2. Turn the modem upside down.  Remove
         the two square vinyl feet near the
         back of the case, on either side of
         the bottom label's DIP switch
         diagram.  Be careful to put the vinyl
         feet aside, upside down, where they
         won't become stuck to another object.

      3. Remove the two Phillips screws.
         Raise the back end of the case bottom
         until it is at about a 60ø angle;
         lift it away from inside the front of
         the modem.  Put the case bottom
         aside.

      4. Locate the Voice/Data switch and
         Volume Control at the front of the
         modem.  Lift up and remove the modem
         (printed circuit board), carefully
         easing the Voice/Data switch out of
         its opening in the front panel.

      5. Turn the modem rightside up and
         locate jumper switches J6 and J8,
         near the power-adaptor socket.  Use
         Figure E-1 as a guide.

















           Figure E-1êCourier Modem Board


      6. The jumpers are black shunts that
         cover two out of three upright metal
         contacts.  As shown in the figure,
         the modem is shipped with the jumpers
         over the two contacts on each switch
         that are closest to the front panel.
         The third contact on each switch is
         exposed.

         Lift off the jumpers from J6 and J8.
         Reverse the positions shown in Figure
         E-5.1.  That is, on each switch,
         cover the contact closest to the back
         of the modem and the contact at the
         center.  Make sure the jumpers cover
         two contacts on each switch, or
         you'll disable the MI/MIC function.

      7. Replace the modem in the case top:
         ease the Voice/Data switch into the
         opening in the front panel; set the
         Volume Control on its semicircular
         rack; make sure the back of the board
         rests on the locator pins at the rear
         (from which you removed the screws).
      8. Reconnect the modem's RS-232, power
         and phone cables, in that order.  Be
         sure the phone cable is plugged into
         the jack closest to the center of the
         modemêthe jack represented by the
         wall jack icon on the case bottom
         label.

         CAUTION:  When you power on the modem
         there will be potential hazardous
         voltage, particularly near the phone
         jacks.  Do not touch the board when
         the power is on.

      9. Power on the modem.  Try MI/MIC
         closure again.  Check to see that the
         Off Hook (OH) status light goes on.
         If you dialed a number, listen for an
         answer tone from the remote modem.
         Then drop the DTR signal.  The modem
         should go on hook and the OH status
         light should go off.

      10. If closure is not working properly,
         review the steps in this appendix.
         Be sure the jumper switches are in
         the reverse position of those in
         Figure E-5.1.  If you still have
         problems, there may be a problem with
         the phone cable.  Or there may be a
         problem with your hardware.

      11. When the equipment is working
         correctly, replace the bottom of the
         modem case.  Ease the two nibs near
         the front corners into their openings
         in the front of the case top, and
         snap the back of the case bottom into
         place.  Replace the two screws and
         the two vinyl feet.
