
      THE ULTIMATE WAVEBLASTER (TM) TO AMIGA GUIDE V1.1 - 7. May 1997
      ---------------------------------------------------------------
         How to connect mindblasting PC soundcards to your Amiga.

   Written by Christian Buchner, flowerp@eikon.e-technik.tu-muenchen.de
                 (Please retry if my EMail host is down).

History: -Revised 23. Oct. 1996, 24. Oct. 1996
         -First released in comp.sys.amiga.audio 24. Oct. 1996
         -released on Aminet in hard/hack 24. Oct. 1996
         -added some more clarifications and tips 7. May 1997
         -translated into German 7. May 1997
         -upload to Aminet on 15. May 1997

Okay, guys!

You  wanted it, now you get it.  This is how to build an  interface  for PC
wavetable sound cards to your Amiga.  It is very easy and requires very few
electronic  components.  I am not  giving  any  exact  board  layout.  This
documentation  just  describes  the  pinout  of the sound  card and all the
required  components.  I can also  give you hints and clues on how to build
the interface.  Anything else is up to you.

You can not use any PC  wavetable  sound card.  Any boards  that use the PC
ISA or PCI  slots  will not  work.  You can only  use  wavetable  expansion
boards that have a Waveblaster (TM) compatible  interface.  The waveblaster
interface can be found on many PC soundcards (e.g.  Soundblaster AWE32, not
the value  editions).  So you can only use these wavetable boards that also
fit on the  AWE32.  This  hardware  hack  is  basically  about  building  a
Waveblaster (TM) compatible hardware interface.  And that is quite easy.

For  doing  this  hack,  you  _should_  have  some  basic  knowledge  about
electronics.   And  it  will be a great advantage if you have ever soldered
some electronic circuitry before in your life ;-)

The serial port will  (optionally)  stay free for external MIDI  interfaces
and  modems.  However  you cannot play MIDI files and use your modem at the
same time!  Also mind that the modem will  "mirror" any MIDI  signals  back
into the computer (AT command  mode).  So it might be better to turn it off
before  using MIDI  software.  It may also happen that your modem  tries to
interpret  the MIDI data.  Mine doesn't (most of the time) because the data
is sent at 31250 baud, which is not an accepted DTE rate for a modem.

You  could  also  use the serial port of any I/O extender card.  But please
note that _most_ of the Amiga MIDI software does not permit you to select a
device driver for MIDI output.  Even worse, some software directly accesses
the  serial  port hardware.  So usage of the internal serial port is highly
recommended.


Why using a PC MIDI sound card?
-------------------------------

* Well,  the  Amiga has only 4 voices.
* The Amiga cannot not create true HIFI sound.
* When you try to obtain a higher polyphony with the Amiga's internal sound
  capabilities you have to use a lot of CPU power for channel mixing.
* Good Amiga sounds (e.g. sound modules) require a lot of hard disk space.
* External MIDI synths are expensive
* and require you to buy a MIDI interface first

What if I told you that modern PC wavetable sound cards are

 a) usually very cheap
 b) of a high quality
 c) having lots of DSP-effects
 d) easily to interface
 and
 e) easily usable with _your_ Amiga!

It all started when a friend of mine bought a YAMAHA DB50XG wavetable board
for his PC.  He  showed  it to me and I  listened.  And I was  amazed.  The
sound card  played  music in a quality  that  really  sounded as if it came
right out of the radio.


Details about the YAMAHA DB50XG sound card
------------------------------------------

First  the  price  here in Germany is very exciting.  It is just DM199.- in
some  computer  stores.  It may, however be somewhat more expensive in your
country or region.

The  DB50XG  has  often  been chosen to be the best MIDI upgrade board from
many similar products at comparative tests in different computer magazines.

It has 4MB of wavetable ROM. 

It  supports  the  General  MIDI  standard,  of  course.  And it offers two
standardized  extensions  to General MIDI.  One is the TG300 mode (which is
mostly  compatible to Roland GS, in fact it even understands many Roland GS
SysEx  messages).   The other mode is the Yamaha XG mode.  This is excactly
compatible  to  the  external YAMAHA MU50 and MU80 MIDI expanders.  From my
point of view, the XG mode is really a breakthrough in MIDI technology.

The  polyphony  is  32  notes  maximum.   It  can  play  up to 16 different
instruments at the same time. Voice allocation is dynamic.

There are 676  different  wavetable  sounds.  In XG mode you can access 480
voices and 11 drum kits (with 202  different  sounds).  In TG300B  mode you
have 579 voices and 10 drum kits (with 173 different sounds).

The  most  exciting  part  is  the  DSP  effect section.  It allows up to 3
independent  and editable DSP effects at the same time.  There are 11 types
of  Hall,  11  types of Chorus effects and 42 variation effects.  All these
effects  have  parameters  that can be changed in real time.  Some exciting
things  are  e.g  a  Phaser  effect,  a  distortion effect, flanger, Rotary
Speaker, Equalizer, EQ filters, Wah-Wah and many more.

The  sound  card comes with a demo CD that contains CD audio tracks and the
same  tracks  in  form  of  MIDI files.  You also get a documentation on 60
pages   (german,   english,   francais)   that  contains  tables  with  all
instruments, drum kits, effects and SysEx messages.

The  sound  that  this  card  produces is in no way comparable to the "old"
Amiga  sound.  In fact I never want to listen to any sound modules any more
(->  Trashcan!).   What  you  get is HIFI sound.  You can make professional
music  with  this board.  It is in fact the same technology that is used in
external  MIDI  expanders.   And  it is compatible to this equipment (MU50,
MU80).  You get a lot of XG midi files in the Internet.

And  of  course you can also listen to all GS or GM midi files.  Usually XG
files sound better, but don't take this for granted.


The pinout of the Waveblaster cards
-----------------------------------

This  hack  will  only  work  with  PC wavetable upgrade boards that have a
WaveBlaster  (TM)  compatible  connector.   This  is  a  26  pin  dual  row
connector.   These  wavetable  upgrade  boards  are  usually  mounted  on a
SoundBlaster (TM) or compatible sound card.

This is the complete pinout of Waveblaster  (TM) compatible sound cards.  I
found it on the UK web  server of YAMAHA  (www.yamaha.co.uk)  in the XG FAQ
file.  However the pinout given there was  incomplete  (missing pin 26) and
the audio lines were reversed.

I  can  not  guarantee  that  this pinout is also valid for different sound
cards than the Yamaha DB50XG.

          /  1   2                  Better leave pins without
         |   3   4   MIDI In        any description unconnected!
digital  |   5   6   +5V
  GND    |   7   8   MIDI Out
         |   9  10   +5V
          \  11 12
             13 14   +5V
          /  15 16
         |   17 18   +12V
 analog  |   19 20   Left Audio
  GND    |   21 22   -12V
(Audio)  |   23 24   Right Audio
          \  25 26   !Reset (active low)

!Reset is Active Low.  MIDI In/Out and !Reset are TTL level  signals.  MIDI
is transmitted at 31250 Baud, 8 bits, 1 start bit, 1 stop bit.

Some more technical data:  The power consumption of the YAMAHA DB50XG board
is about 2 Watts.  So this makes  about  400mA  that are  needed at the +5V
pin.  Consider this when taking power from anywhere.  The +12V and -12V are
only  used  for the  audio  amplifier  on the  sound  card.  So they do not
require a lot of power.

The  YAMAHA  DB50XG  sound card does not send any usable information on its
MIDI  Out  pin.  At least I did not find any information in the user manual
that  indicate that the sound card is capable of sending any MIDI data.  So
we will not connect the MIDI out pin of the sound card.  This saves us some
work and it allows us to share the serial port between any external devices
and the sound card.

It  is  very  important  that the sound card gets a reset impulse after the
power  has  been switched on.  Without giving a reset, the card won't react
and  stay  quiet.   Before  I knew that there is a reset pin I was fiddling
around for three days searching for an error in my adaptor. ;-(

The Amiga RS232 serial port uses +12V and -12V for sending the signals.  As
we  don't  want to burn our sound card, we will have to convert this to TTL
signal level (+5V / 0V) before feeding it to the card.

Two chips I know about are capable of doing this:

The  MAX  232  from  MAXIM  -  it  is a bi-directional and dual RS232<->TTL
converter. 

The  MC1489  chip  from  Motorola  (or  the  compatible  SN75189 chip) is a
quadruple RS232 receiver that only converts from RS232 to TTL.

The  MAX232  is  more  expensive  than  the  MC1489  and  requires  a  more
complicated  circuitry.   It  uses four capacitors (22yF) for creating -5V,
+10V  and -10V from a single +5V VCC current.  As it is bi-directional, you
can  feed  the  sound  card's  MIDI  out signal into the serial port of the
Amiga.   But  in this case you may _NOT_ connect any external device to the
serial port at the same time.  Imagine the modem and the MAX232 chip trying
to  send  data to the RxD pin at the same time.  That will probably destroy
either the modem's or the MAX232's output drivers.

And  by  the  way, you can also grab the Amiga's TxD Data directly from the
Paula  chip,  right before it is converted to RS232 level.  The data signal
is  present  at  pin  40 of Paula.  But be careful.  It can be very easy to
damage  your Paula chip.  I recommend using the serial port and a converter
chip.

The !Reset pin can be  connected to +5V through a 4.7kOhm pull up resistor.
Use a switch or a button for connecting this pin to GND.  When you activate
the switch or button, the sound card will execute an internal reset because
pin 26 goes to 0V.  The reset must be given after you turn on the  computer
or the sound card will refuse to work.  You may optionally add an automated
reset logic (e.g.  by  replacing  the switch by an  adequately  dimensioned
capacitor).  You can also use the Amiga's internal system reset signal.

This is how the reset switch should be connected. The resistor is used as a
so called "pull up" resistor here.
         ----------
 +5V ---| 4.7 kOhm |-----x---- to pin 26 (!Reset)
         ----------      |
                         |
                       \       switch closed means card is in reset state
                        \      (turned off and silent)
                         |
                         | to GND
         
I recommend  using a switch for  manually  resetting  the sound card.  This
works as an "emergency" switch in case something on the MIDI bus went wrong
and the sound card  produces a  persistent,  awful and loud sound.  You can
also turn off the sound card by giving it a constant reset signal.

Never connect a headphone directly to the sound card's audio out!  You will
probably  kill  the  sound  card's  internal  amplifier.  Always connect an
amplifier (e.g.  HIFI set) to the output of the sound card.

If you want to mix the sound  card's audio  signal with that of your Amiga,
you can use  either an  external  mixing  console  or you can build a small
electronic  stereo mixer using two  Op-Amps.  Never try to mix the audio by
directly  connecting  the sound  card's  audio-out  directly to the Amiga's
audio-out!  An  internal  sound card  comes in handy.  I am using a Toccata
card for mixing the audio signals.


The pinout of the converter chips
---------------------------------

Here comes the pinout of the MAXIM MAX232 chip.

                   ___  ___
  These pins   / O|   \/   |O  +VCC = 5 Volts
  have to be  |  O|        |O  GND
  conncted to |  O|        |O  RS232 Out (C)
  22yF        |  O| MAX232 |O  RS232 In  (D)
  capacitors  |  O|        |O  TTL Out (D)
  (see below)  \ O|        |O  TTL In  (C)
  RS232 Out (B)  O|        |O  TTL In  (B)
  RS232 In  (A)  O|________|O  TTL Out (A)



                      -----  1      This is how the capacitors
                     |              have to be connected to pins
       22yF          |              1-6 of the MAX 232 chip.
          | |+       |              They are needed for creating
      ----| |--------|------ 2      internal voltages of +10V,
     |    | |       +|              -10V and -5V from of the +VCC
    ===        22yF-----
  (GND)            -----            Use electrolyte capacitors and
                     |              mind the polarity (given by the
                      -----  3      + signs). You don't want the
                                    capacitors explode right in your
                                    computer, don't you?
                      -----  4
                    +|
               22yF-----
                   -----
                     |
                      -----  5
       22yF
         +| |
      ----| |--------------- 6
     |    | |
    ===
  (GND)


Here comes the pinout of the Motorola MC1489 chip.

                   ___  ___
             1A  O|   \/   |O  +VCC = 5 Volts
      Control 1  O|        |O  4A
             1Y  O| MC1489 |O  Control 4
             2A  O|   or   |O  4Y
      Control 2  O| SN75189|O  3A
             2Y  O|        |O  Control 3
            GND  O|________|O  3Y

The A pins are the RS232 signal inputs, the Y pin is the TTL signal output.
The Control pins specify the  hysteresis.  For our purpose,  they should be
left unconnected.


The Internal version (A2000/A3000/A4000)
----------------------------------------

In the recent days, I have built a PC YAMAHA  DB50XG  sound card right into
my Amiga  2000.  I mounted the sound card to one of the metal  "pads"  that
are  covering  the back side of the Zorro  slots.  So the sound card is now
perfecly  fitting  into my Amiga.  The  adaptor  for the  serial  port is a
little  board that  resides on the  internal  serial port  connector.  This
connector only exists in the Amiga 2000.  It is located on the  motherboard
near the external  connector  of the serial  port.  So building an internal
version for any Amigas  other than the A2000 is somewhat  more  tricky, but
possible of course.

This  is  the  pinout  of  the  internal   A2000  serial  port   connector.
Unfortunately  most  internal  A2000  turbo  boards for the MMU slot reside
directly above the connector and make it more difficult to access it.

WARNING:  The pinout  given  below is NOT the pinout of the serial  port on
the back side of your Amiga  (which  can be found in the  addendum  of your
Amiga  manual.  The  pinout  below is an  internal  connector  on the A2000
mother board only.  Someone  actually  messed that up and  wondered  why it
didn't work.

    GND 1   2  -5V
    TxD 3   4  Audio Out (left channel only)
    RxD 5   6  Audio In  (to right channel only)
    RTS 7   8  E
    CTS 9  10  *INT2
    DSR 11 12  LEDPOWER
   DGND 13 14  DTR
     CD 15 16  +5V
        17 18  RI
           20  +12V
        21 22  *C2
        23 24  *BAST
        25 26

The only pin that is of interest  for us, is the TxD pin for  grabbing  the
MIDI data.  The +5V line is *too  weak* for  giving  the  necessary  power.
Trust me, I tried it and the computer  began crash over and over.  The +12V
pin at this connector  (+12V User) is indirectly  connected to system power
with a 1N4001  diode which eats up approx 1.2 Volts.  So you cannot get the
full 12Volts at this pin.

Conclusion:   Get  the  power  (+5V,  GND, +12V) from a floppy or hard disk
power connector.

And  where  can you grab the -12 Volts from?  I was soldering an additional
pin into the connector, right at the non-existing pin 19.  Then I connected
this  pin  to -12V (not -12V User, as this lacks approximately 1.2V because
of  another  diode).   This  required me to take the motherboard out of the
computer.   I  am sure you can find a simpler solution.  Have a look at the
circuitry  of  your  computer to find out where you can grab the -12 Volts.
You  can  of  course  go  directly  to  the  main  power  connector  on the
motherboard.

My  adaptor  board  resides on the internal serial connector.  Three cables
are leading away from this adaptor board.  One is a 3 wire power cable that
leads  to  a floppy drive power connector.  Another cable is a 6 wire cable
that  leads  to  the  sound  card  itself.  It carries power, MIDI data and
Reset.  I was using an old Joystick cable for this purpose.  The last cable
leads  to a switch that I inserted into the front casing of the Amiga right
next  to  the power LEDs.  It is the reset (or ON/OFF) switch for the sound
card.

If you have an A3000 or A4000,  you  should  grab the TxD pin from the back
side of the serial port  connector  (so that you can still  connect  serial
devices  at the  back  side of your  computer).  Just  solder a wire to the
correct pin or use a clip for fixing the wire.

For  the  sound  card  itself, I am using a 26 pin dual row male connector.
This  one  has a 90 degree angle so that the wires lead away to the side of
the sound card.  This makes the whole construction somewhat more flat.

For  leading  the  Audio  signal away from the sound card, you should use a
shielded  cable.   Hint:   Just  cut  a  standard Chinch audio cable in two
halves and solder the ends and the shielding to the appropriate pins of the
connector.   Be  sure to connect the analog (audio) ground to the shielding
of  the  audio cable.  In most cases the left audio wire will be white, the
right one red.

As  I  own a toccata board, I bought a very cheap walkman headphone and cut
off  the  wire.   This  fits  perfectly  into the internal AUX2 input of my
toccata board.


The external version (any Amiga)
--------------------------------

Similar to the internal version described above, but

- take the power (+5V, +12V, GND) externally from the floppy port.

- take TxD and -12V externally from the serial port.

Use standard Sub-D connectors with plastic or metallic casing.  Be careful:
A metallic  or  metallized  casing does not  insulate  and may cause  short
circuits if you do not take care of that.

The  converter electronics may fit into the casing of the serial port SUB-D
connector  if  you  just use the MC1489 chip.  Take care of the insulation.
It  may  be  wise  to  fill the whole interior of the SUB-D casing with hot
plastic glue using a hot plastic glue gun.  Or use wax from a candle.  This
should work as well.

You  may  want  to put the sound card into a box or a casing as well.  This
looks smarter and prevents damage to the sound card.

Take  care  that  no connector ever touches any metallic surface.  This can
cause a short circuit and damage the sound card and/or your computer or the
power  supply.   Same thing for the sound card.  Never put it on a metallic
surface.  Always put some insulation (e.g.  sheet of paper) in between.

For  creating  an  adaptor  that  does  not allocate the serial port and/or
floppy  port, you can use two-sided Sub-D casings.  Put a male connector on
one  side  and a female connector to the other side.  Connect all the 25 or
23  pins  internally  with  a flat ribbon cable.  And of course connect the
converter electronics and/or the power cable to the correct pins.  And pray
that all this fits into the casing.

Never  connect  or  disconnect  the  floppy  and  serial connectors of your
adapter when the computer is running.  Turn off the computer before.  After
restarting,  do  not  forget  to  reset the sound card after turning on the
computer or you will not hear anything.


Recommended Software
--------------------

- MIDIPlay 2.65b by Janne Syväniemi (Shareware, available on AmiNet)

- Bars  &  Pipes  by  Blue  Ribbon  Soundworks  (available for FREE through
  CompuServe).   A  professional  MIDI  sequencer with Drag & Drop and some
  very innovative features.

- SuperJam  by  Blue  Ribbon  Soundworks  (also  available for FREE through
  CompuServe).  A kind of an automated accompaniment sequencer with several
  different styles.  General MIDI support only.

- MIDITracker  (available on AmiNet).  Kind of a SoundTracker for MIDI.  No
  external MIDI keyboard required for composing.

- DeluxeMusic  2.0  by  Electronic  Arts  for  composing  on  a note sheet.
  General MIDI support only.

- Camouflage (demo available on Aminet), a MIDI sequencer

- Dominator (demo available on Aminet), a MIDI sequencer

- OctaMED  6.0  (demo available on Aminet), a tracker capable of doing MIDI
  as well.

- GMPlay  1.2  (available  on  Aminet)  a General MIDI player that does not
  require  a  sound card or any external devices.  Written by Alessandro de
  Luca and _me_.

- The  XPK  compression  package and xpkSHRI Library (available on Aminet).
  SHRI gives an excellent compression ratio when used at 100% efficiency on
  MIDI  files.   The  files  are  often  shrinked  to 20% of their original
  length.   Make  sure to decompress the files before loading them into any
  MIDI software!

This list is incomplete. Any suggestions welcome.


Recommended Websites and Songs
------------------------------

Have  a  look  at  www.yamaha.com  or  the  local YAMAHA web server in your
country.  They offer (PC) software and MIDI files as well as technical data
and valuable tips.

There  are  a  lot  of  internet  sites that offer song collections for the
Yamaha   DB50XG.    The   best   site   is   probably   "The  XG  Home"  at
"http://www.ids.net/~marshall/xg.htm"

The link  "The  Songs"  at the  bottom  of the  page  will  take you to the
collection of midi files.  Links to the composers' pages are also provided.
The songs on this server are especially written for the Yamaha DB50XG sound
card and may sound very different on other MIDI equipment.

There  are more web  sites  that  offer XG midi  files.  Another  excellent
German site was created by Michael  Banz.  His site offers more than 500 XG
midi files (even more that can be found on  Marshall's  XG Home  page).  Be
sure to check out this URL:
"http://www.castrop-rauxel.netsurf.de/~michael.banz/"

A lot of cover version of original chart hits and old C-64 songs in XG MIDI
format can be found on "http://www.cs.vu.nl/~arthur/xg.html"

Be sure to get the song  "Children.MID".  It is amazing, although it starts
quite dull (just as the original song from the charts).  Other  recommended
songs:

        Running Scared.MID - acid-trance, really exciting
  Marin County Morning.MID - ballad, ressembles to Fleetwood Mac
              Children.MID - charts-hit: Robert Miles, "Children", very good
          Locust Dance.MID - unusual rhythms and a very good E-guitar solo
          It's Only Me.MID - sentimental song with good sound
                Images.MID - house-trance, spacy, excellent!
              Suburbia.MID - jungle-trance, quite good
             Mr. Bones.MID - true blues-rock, hammond-organ and E-guitar
             Sea Scape.MID - moody song with undersea sounds, wales, relaxing
            Heart Land.MID - melodic song, lot of organ
             Hypnotica.MID - melodic song, partly trance-like, excellent
              Espagnol.MID - perfect (!!!) Flamenco, excellent
           Interleaver.MID - perfect trance, cool organs
Memories Of Arden Road.MID - rock-ballad, cool E-guitar solos
             Jock Rock.MID - rock music, like some kind of TV title song
               D-Shake.MID - spacy acid sequence, lots of filter and echo
                X-Cita.MID - spacy trance
       Feel The Energy.MID - spacy song, ressembles to Robert Miles "Children"
      Over The Rainbow.MID - well-known piece from a musical, lots of violins
              Tek Toys.MID - trance or breakbeat, nice spacy sound
  Sonic Surfing Part 3.MID - trance with cool synth bass
  Water Flowing Uphill.MID - wonderful ballad
         Secret Garden.MID - wonderful dreamy song, very cool sfx
 Quest For Lost Heroes.MID - hard rock, excellent guitars, live atmosphere

This list is incomplete and reflects my personal  taste.  Meanwhile lots of
excellent new XG midi files have been released.

If  you  intend to connect different sound cards, just let me know what web
sites you can recommend.


LEGAL STUFF
-----------

Any  commercial  use  of  this  text  is  explicitly  forbidden  without my
permission.   This  text  may  only  be  spread  through  computer networks
(newsgroups, AmiNet) if it is left unchanged.

There  is  no  warranty for correctness of the above information.  Building
the  interface  is  at  your  own  risk.   I  cannot be made liable for any
hardware damage to your sound card and/or your Amiga.

SoundBlaster and WaveBlaster are trademarks of Creative Labs Inc.

Please excuse any misspellings or the choice of inadequate technical terms.
I  may be an expert in the German language, but in English, I am definitely
not.


Contact me
----------

Suggestions, corrections and improvements welcome.

Drop  me  an  EMail  if  you  succeeded  in  building  the interface.  I am
currently  writing  some  software  for  accessing  all  the  sound  card's
instruments.

EMail to:  flowerp@eikon.e-technik.tu-muenchen.de
Please retry if the EMail server is down.

 (c) 1996,97 Christian Buchner

  //
\X/ Flowerpower
