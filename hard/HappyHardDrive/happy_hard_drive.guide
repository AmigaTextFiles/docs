@database LSD-aminet/hard/hack/happy_hard_drive.guide
@master happy_hard_drive.guide
@$VER: 1.0
@author "Matt Whitfield and Steve Clack"

@remark Copyright 1997 Matt Whitfield, Steve Clack and Liquid Software Design

@remark This may not be redistributed in any changed form. If it is included on
@remark any compilation CDs, the authors must be contacted to receive a copy
@remark of the CD first.

@node "Main" "How to make your hard drive happier..."


  @{b}How to connect your 3.5" HDD to your Amiga 1200 in a nice friendly way,
                                      @{ub}@{i}or@{ui}@{b} 
 How to make your currently installed 3.5" HDD a lot happier (i.e. cooler)@{ub}

    @{"Introduction" link "Introduction" 0}
    @{"What you need" link "Needed" 0}
    @{"How to build the project" link "Build" 0}

    @{"Programs" link "Programs"} you can use to test your drives
    @{"Disclaimer & Copyright" link "Disclaimer"}
    @{"Authors & Contact" link "Authors"}
    @{"Drive Connections" link "connex"}

  Copyright (C) 1997 Matt Whitfield, Steve Clack and Liquid Software Design
@endnode

@node "Introduction" "Introduction"
@{b}@{i}Introduction@{ub}@{ui}

Okay. So you want a hard drive, or maybe you already have one. People tell you
that 3.5" drives work fine in an A1200, so you try one out. It works just fine
until one day you start to run a BBS and find you leave your amiga on for a
few weeks. One morning, you wake up to find the hard drive light consistently
on, and your amiga is very hot. You take your hard drive out, cool it down, 
and luckily it still works, as does your amiga. You dont want a fright like 
that again so that is where this hack comes in.

This hack was born when we connected a broken ProGrab 24 RT to Matt's A1200 
and it didn't work. We took the A1200 apart to check the PCMCIA port was not 
broken and found out the hard drive was very hot. So we decided to remedy 
this situation....

Please note here that neither Matt Whitfield nor Steve Clack can in any way
be held responsible for any damage caused by the use of this information nor
for damage resulting from innacuracies herein. Do not take this warning too
lightly, as we broke 2 floppy drives making this hack. That is not to say
that everyone who does this hack will break their floppy drives, but be
warned of the risk before you start, and you must know what you are doing.
@endnode

@node "Programs" "Programs to test your set up"
@{b}@{i}Programs to test your set up@{ub}@{ui}

We have included the program DriveID by Dick Diederik, which is useful for
testing the floppy drive set-up, and it will be obviously apparant if you
have a hard drive, because you will be able to see it in HD Toolbox.

@endnode

@node "Needed" "What you need to build this project"
@{b}@{i}What you need to build this project@{ub}@{ui}

@{b}Parts:@{ub}

1 Amiga 1200
1 3.5" IDE/EIDE Hard Disk
1 44-pin Micro IDE -> 40-pin IDE Adaptor cable, at least 25cm long
1 Power adaptor cable (1 * small -> 1 * big, 1 * small)

@{b}Optional Parts:@{ub}

1 External 3.5" Amiga Disk Drive (to use this you must have the ribbon cable)
35cm 40-way standard ribbon cable
2 34-pin drive heads

@{b}Tools needed:@{ub}

Screwdriver
Pliers

@{b}Other needed things:@{ub}

Nerves of steel

@endnode

@node "Build" "How to build the project"
@{i}@{b}How to build the project@{ui}@{ub}

We'll do this in simple steps...

1. Remove the A1200's Casing by removing the three screws at the front, and
   the two at the very edges and lifting the top off. Welcome to the inside
   of your amiga.

2. Remove the keyboard. For now you can just yank the flat cable out from the
   motherboard, and remove the actual keyboard. Put it to one side for now.

3. Remove the floppy drive. Note that this is held down by 2 screws under the
   back of the amiga. Also at this time you should remove any metal plates
   that are around this area as they will get in the way later.

4. Remove the RF Shield by undoing all the screws you can see (including the 
   one at the front of the case, on the bottom), then prying up the tabs that
   hold it down and lifting it off fairly firmly. Fold it up, stamp on it, do
   whatever you like with it, because it is not going back in there! :)

5. You now have two options. You can either have no drive DF0: and use only 
   the external drives, or have DF0: externally, by using the parts 
   mentioned in the 'optional parts list'. 

5.1a) We will first deal with having no drive DF0:, as this is an easier 
      solution, once you know what you are doing. 
 
      Get the ribbon cable from the floppy drive, and with a piece of wire, 
      connect pin 10 to pin 2. You can just stick the wire into the holes, and
      that should make a connection. What this does is fools the amiga into 
      thinking there is never a disk in DF0:, but that it does work. Once this
      is done, take the ribbon cable and fold it triangularly so that the
      cable fits underneath where the floppy drive was.

      For those of you who are interested, see the @{"technical background" link "tech"}

5.2a) The other option is to take the amigas DF0 device into the outside 
      world. This is perhaps a more ugly solution but it has the advantage of
      retaining compatibility with some software that requires DF0. An 
      example of this might be the demo 'Big Time Sensuality'. This is where 
      the optional parts come in.

      Take the external floppy drive, and take the case off. Just a note to
      owners of Cumana drives (like Matt is)... To open your drive just take
      a screw driver (flat one) to the back of the case, put it in the crack
      and twist until the case snaps open. Do this both sides, then force it
      open. It should snap open before it breaks, but don't blame me if it
      actually does snap. Now you will notice in most drives they have a
      main drive mechanism (similar to the internal drive removed earlier)
      and a small circuit board which has leads that plug into the drive, or
      in some drives (such as the Cumana ones) plugs straight into the back
      of the drive. Remove this circuit board by undoing any necessary screws
      etc. If your drive interface does not have 34 pins, @{b}STOP NOW@{ub}. The drive
      must have a 34-pin interface for this hack to work.

   b) Now, take the ribbon cable and strip off the 6 extra wires at the
      opposite end to the marked wire. It does not actually matter, but the
      marked wire helps a lot. Do not throw the 6 wire bit away as we will
      need that for drive power. Now, take the ribbon cable used to connect
      the internal drive originally and take off the black heads. This is
      done by putting a screw driver in the side of the head and prising the
      small tabs up. Do this gently or they will snap. If you do not feel
      comfortable doing this you can buy 34-pin heads from any good computer
      shop. If your computer shop does not sell them, then insult the owners
      because many shops do not cater for 'hardware hackers' :). Now that 
      you have the heads off, put them on the long 34-wire cable. This is
      done by placing the head around the wire and squeezing them gently
      with a large pair of pliers. Once again, do this gently because the
      connections are prone to snapping. Matt broke his own, but managed to
      do Steve's without breaking them! (Practise makes perfect!) Also be
      careful that if your drive heads have notches you put them in the
      right way round. The easiest way to do this is look at which way they
      were when you took them off the original cabling.

   c) Now you should have a long drive cable. You now need a long power
      cable. Take 2 of the wires off from the 6 wire leftover, and throw
      them away. With the other 4, mark one wire all the way down with a 
      felt marker or similar, so that you can know which end is which. Now
      take the original drive power cable, and cut it exactly in half. With
      a pair of pliers or scissors (or even your teeth) strip all the wires
      on both sections. Strip off the wires on the 4 wire ribbon cable, and
      then connect the 4 way ribbon cable in between the two halfs of the
      original connection. Make sure you remain consistent with your
      connections (i.e. keep the same colour going to the same colour at 
      both ends) because if you mess this part up, you will almost certainly
      blow up your drive, which will then smell nice.

   d) You have two options of how to take the drive cables out of the Amiga,
      you can either take them out from just above the disk drive port, or
      you can take them out of where the internal floppy drive used to be.
      
      If you want to take the wires out of the disk drive port, you must
      remove your motherboard, push the interface cable through, then put
      a slight kink in the cable, because the internal interface is not in
      line with the disk drive port. Look at this @{"diagram" system "run >nil: multiview DrivePort.Iff"} to see how to do
      this. This is what Matt did. Then putting the motherboard back in, be 
      firm because the RF shield will hinder putting the wires through the 
      disk drive port hole.

      Your other option is to fold the interface cable triangularly and run
      it under where the floppy drive used to be, and out through the 
      internal floppy disk hole. This is what Steve did. Make sure you pass 
      the interface cable 1through the hole before plugging it in anywhere, 
      otherwise you will be frustrated when you come to put the computer back 
      together.

   e) Now take the interface and power cables, and feed them through the back
      of the external drives casing (we put them through where the pass
      through port had been) and plug the cables into the drive mechanism.
      Put the casing back together and lay it on the desk.

6. Now comes the part of putting the Hard Disk into the Casing. This is
   relatively easy. First of all, lay the Hard Disk in the place where the
   floppy drive had been, to check that it sits in alright. Also, make sure
   all the tabs on the RF shield are folded down, and you have gone over the
   areas where the drive will touch with insulating tape or something similar.
   Fix the Hard Disk in place however you see fit, just make sure it is
   fairly secure. Steve stuck his down with tape, and Matt fixed his with
   screws and double sided sticky pads (he had to make new holes in the back
   of the case in order to screw the drive down). @{b}Important:@{ub} If you have an
   accelerator card, make sure the drive can sit in place without hindering
   the positioning of the card. Above all, make sure they do not touch. Even 
   if just by 1mm, make sure they do not touch. Matt found that his Hard Disk 
   sat very close to his 68030 (on his GVP Turbo Plus Series ][) and this made
   it harder to control the positioning of the Hard Disk.

7. Now take the 44-pin to 40-pin adaptor cable, and plug it in to the main IDE
   interface on the motherboard, then into the Hard Disk. If you wish, you can
   put a kink in it, in a similar fashion to before, like Matt did. When you
   have done this, your setup should look like in this @{"diagram" system "run >nil: multiview HardDrive.IFF"}.
   
8. You are now almost ready to put your computer back together. First though,
   it is a very good idea to check that it works at this point. Make sure the
   white housing of the keyboard connector on the motherboard is lifted up,
   and plug the keyboard in. Then boot up the machine. If it all works fine,
   then great. If it pauses and the drive does not click @{b}turn off now.@{ub} This
   probably means the cable is in back-to-front, so check this. If the power
   is in OK, then check the power. If the hard drive does not work, then
   check the cable and power. If all cables and power are OK, then check the
   wiring. If the wiring is fine check the ribbon cable to the drives have
   their backs firmly on. If all this is alright and it still doesnt work then
   you are up shit creek without a paddle, because you have almost certainly
   blown something up. :(

9. If you are here, it is probably working, so congratulations on a successful
   hardware hack. Your 3.5" HDD will live longer than most 'normally' put in
   drives, and you can put your A1200 up against something without having to
   worry about being able to put the disks in! You now have a successfully
   hacked A1200. So put the top on, do up the screws and roll! Don't forget
   to put the drive lights back onto the motherboard, and dont worry, the 
   connector will only fit one way round.

Click here to read about @{"further possibilites" link "further"} with this project.
@endnode

@node "further" "Further Possibilites with this project"
@{b}@{i}Further Possibilities with this prohect@{ub}@{ui}

Before we continue, we must say that we have not performed any of the 
following hacks, and say that these are entirely theoretical.

You could, if you wish, make the drive detachable, by getting a 40-pin male
and a 40-pin female adaptor, then cutting the interface and power cables,
then clipping them both in, in the same way as before. If you do this, make
sure you line up the cables right both ends, or you will have more explosions!

Another beauty of this project is that you can now have 2 3.5" Hard Disks
within your amiga. To do this, it is best to have 2 drives of the same type.
To do this, you need some 40-pin cable and another 40-pin head. Just take
off the existing head, then press both cables together (making sure you line
up the pin 1s) and put the head back on. Then put the other head on the end
of the cable that is loose. Plug this into the other Hard Disk and then plug
a power cable into the other Hard Disk (you may have to get this). Set one
drive to master (the one closest to the motherboard, in terms of the IDE
cable) and the other to slave. You now have a two drive system.

Many people will tell you this can not happen without a buffer. Well it can.
Because I know several people who have done it. Companies like Golden Image
will tell you that you cannot do it to sell you their devices. Ignore their
warnings. Go for it. But dont come running to me if you blow your 1200 up.
The most likely scenario is you run out of power. In this case, you could
get another PSU and power the drives by making the psu plug in to the back of 
the external drive (if you chose to make one) and passing power to the Hard 
Disks like that. 

Yet another good point of this project, is that you could have a CD Drive
plugged in, by running the IDE cable out of the side of the computer through
the disk drive hole, like with Steve's method of attaching the floppy drive,
and then attaching the CD Drive there. The possibilities are truly endless.

Also, becuase there is now so much space where other 3.5" Hard Drives are,
you could install a fan, to cool your system down. 

Another possibility, is to put the internal disk drive in the other end of
the Amiga. This is probably possible, but we have not investigated it, and
probably will not. This is because we're quite happy with our external DF0!

If anyone does perform any of these hacks, please let us know, so that we
can document what you did for others to use.
@endnode

@node "tech" "Technical background to 'No DF0: hack'"
@{b}@{i}Technical background to 'No DF0: hack'@{ub}@{ui}

This pulls DISKCHANGE low when DRIVE SELECT 0 is low. What this means is that 
when the amiga polls the disk drive to say 'hello, are you there and is there
a disk in?' it says 'hello, yes i am and no there isn't.' 

Originally we had tried just pulling READY low permanently, but this made 
READY low all the time for @{b}all drives.@{ub} This meant the amiga detected DF0,
DF1, DF2 and DF3 whether they were there or not. Then we tried the same with
DISKCHANGE, and this detected the right number of drives, but did not let 
any of them signal a disk. 

So it was only when we found the drive pinouts in Dick Diederik's 
PCFloppy2Amiga project, that we could link DRIVE SELECT 0 straight to 
DISKCHANGE, thus allowing any external drives to be used, but disabling DF0 
and avoiding any wait states. 
@endnode

@node "disclaimer" "Disclaimer & Copyright"
@{b}@{i}Disclaimer@{ui}@{ub}
This document is provided "as-is" and the authors accept no responsibility for
damage and/or loss of data/equipment as a result from performing the hardware
hack as described in this document or any accompanying material.

@{b}@{i}Copyright@{ub}@{ui}
This document is Copyright 1997 (C) Matt Whitfield, Steve Clack and Liquid
                                    Software Design

This document may not be redistributed in any changed form. If it is included
in any compilation CD's the authors must be contacted to receive a copy first.
@endnode

@node "Authors" "Authors & Contact Info"
@{b}@{i}Authors@{ub}@{ui}

We both live on the Isle of Wight. Matt is co-sysop of Steve's BBS, and we
often meet up for fun and games, and this time, a lot of hardware hacking :))

That's enough about us... if you want to know more then @{i}@{b}contact us@{ui}@{ub}:

   E-Mail:  Matt: mattw@ndirect.co.uk
           Steve: steeevc@ndirect.co.uk 

      BBS:  --==## Total Eclipse On-Line ##==--
                    +44(0)1983 522428

                 Liquid Software Design HQ
             Maxs Pro, KewlCD & KewlCDPro, MMC,
                MagicFile & BBS Chat support

      WWW: http://www.ndirect.co.uk/tronix-d

Thanks to:

  Dick Diederik for PCFloppy2Amiga, sorry we didnt have time to ask!

  Ozz Scott for being the hackiest bloke about, and giving me the final idea
            of how to fix the 'Disable DF0 Hack'

  Jake for being fat, lazy and stepping on Matt's motherboard

  Commodore for being amusing while they lasted

  Micro$oft for ensuring the world is a worse place to compute each year

  All scene groups for keeping me attracted to the amiga for so long!

                                  """""          
                                 ( o o )         
                       +----oooo---(_)---ooo----+
                       |                        | 
                       | Liquid Software Design | 
                       | The sun and  the stars | 
                       |                        | 
                       |             Oooo       | 
                       |        oooO (   )      | 
                       +-------(   )--) /-------+
                                \\ (  (_/         
                                 \\_)             
                                                   
                         ANSI by jaVa maN/LsD    
@endnode

@node "connex" "Connections for the project"
@{b}@{i}Connections for the project@{ub}@{ui}

You don't need to know this, but we found it useful so here it is.

The connector for the power supply consists of 4 pins:
    
    Pin #    Connection
         
      1      5 volts
      2      Ground
      3      Ground
      4      12 volts

Be careful with this one, as getting it wrong could be fatal (well for your
drive, at any rate!)

The actual drive connector only uses 17 of the 34 pins. All of the odd 
numbered pins are connected to ground.

In the 'Dir' (direction) column, 1 means from drive to amiga and 2 means from
amiga to drive.

    Pin #   Connection       Dir   Description

      2     DISKCHANGE        1    Goes low when selected and disk isnt in
      4     IN USE            1    Activates when drive motor spins
      6     DRIVE SELECT 3    2    Low when drive 3 is selected *
      8     INDEX             1    Low every rotation when select is low
     10     DRIVE SELECT 0    2     Low when drive 0 is selected *
     12     DRIVE SELECT 1    2    Low when drive 1 is selected *
     14     DRIVE SELECT 2    2    Low when drive 2 is selected *
     16     MOTORON           2    Drive motor spins when MOTORON is low
     18     DIR. SELECT       2    Low for inwards, High for outwards
     20     STEP              2    When low head is stepped to next track +
     22     WRITE DATA        2    Data to be written to disk
     24     WRITE GATE        2    When low data is written to disk
     26     TRACK 0           1    Low when head is over track 0
     28     WRITE PROTECT     1    Low when selected and disk is protected  
     30     READ DATA         1    Data is written to this line from the disk
     32     SIDE 1 SELECT     2    Selects side to be written to / read from
     34     READY             1    Low when selected and ready to read / write

* I.E. Low when computer wants to talk to this drive.
+ The next track is determined by DIR (Direction) SELECT

Here are the pins for the IDE Hard Drive:

Pin #    Connection      Pin #    Connection
  1      -Reset            2      GND
  3      Data 7            4      Data 8
  5      Data 6            6      Data 9
  7      Data 5            8      Data 10
  9      Data 4           10      Data 11
 11      Data 3           12      Data 12
 13      Data 2           14      Data 13
 15      Data 1           16      Data 14
 17      Data 0           18      Data 15 
 19      GND              20      Key
 21      (reserved)       22      GND
 23      -IOW             24      GND
 25      -IOR             26      GND
 27      IO Chrdy         28      Ale
 29      (reserved)       30      GND
 31      IRQ14            32      -IOCS16
 33      Addr 1           34      (reserved)
 35      Addr 0           36      Addr 2
 37      -CS0 (1F0-1F7)   38      -CS1 (3f6-3f7)
 39      -Active          40      GND

Dont ask us to explain these as we only *just* grabbed them off from the
internet :)
@endnode

@remark This may not be redistributed in any changed form. If it is included on
@remark any compilation CDs, the authors must be contacted to receive a copy
@remark of the CD first.

@remark End Of Guide
