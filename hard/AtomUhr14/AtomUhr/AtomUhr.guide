@database AtomUhr.guide

@width 80

@Node Main "AtomUhr.guide"
@Next "I"

                             Atomuhr
                           Version 1.4
                        von Stefan Glükler
                         29. Januar 2000
___________________________________________________________________

Willkommen beim kleinen Hardware-Projekt eines DCF77-Empfängers
für den Amiga. Lese folgende 5 Kapitel zuerst durch, bevor Du mit
dem Bau des Moduls beginnst.

   @{" 1)   Einleitung             " Link "I"}
   @{" 2)   Bau des Moduls         " Link "II"}
   @{" 3)   Inbetriebnahme         " Link "III"}
   @{" 4)   Software AtomUhr       " Link "IIII"}
   @{" 5)   Kontakt                " Link "IIIII"}
   @{" 6)   Entwicklungsgeschichte " Link "IIIIII"}

                                           Viel Spass    S. Glükler

@EndNode

@Node "I" "Einleitung"
@Next "II"
@Prev Main
@Toc Main

1)  Einleitung
-----------------------------------------------------------------------------

Sicher hast Du auch schon von der supergenauen Atomuhr gehört. Dies ist
die Funkuhr DCF77. Diesen Zeitsender gibts schon seit 1974. Mit einem kleinen
Empfänger kann man ihn überall empfangen.

Kodiert wird die Zeit über eine Minute. Bei jeder Sekunde wird ein Bit der
Zeitkodierung übermittelt.

Dieses Modul ist bei mir installiert. Du kannst also ohne Bedenken dieses
Modul nachbauen. Es wird bestimmt auch bei Dir funktionieren.

Der Bau dieses Moduls kostet an Material ca. sFr 50.-

Das Programm benötigt Kick2.0 oder höher.

Es besteht die Moeglichkeit, zwischen 3 verschiedenen Varianten des Eingangs-
Ports auszuwaehlen :
                       Joystickport / Pin 1 (Oben)
                       Joystickport / Pin 6 (Fire)
                       Serialport   / Pin 8 (CD)

@EndNode

@Node "II" "Bau des Moduls"
@Next "III"
@Prev "I"
@Toc Main

2)  Bau des Moduls
-----------------------------------------------------------------------------

Der Bau des Moduls sollte für einigermassen geübte Bastler kein Problem sein.
Ich selber habe den Aufbau auf einer kleinen Versuchsplatine gemacht. Dann
das ganze in ein kleines Plastikgehäuse gepackt, ein langes Kabel angehängt,
um die beste Empfangsposition suchen zu können.

Alle Bauteile können bei Distrelec AG bestellt werden. In Deutschland sind
die Bauteile incl. DCF77-Modul bei Connrad Elektronik zu bekommen.

Adresse :   Distrelec AG
            Grabenstr. 6
            8606 Nänikon (Schweiz)
Tel     :   01 / 944 99 11
Fax     :   01 / 944 99 88
VTX     :   *distrelec#

   Artikel                        Anzahl    Bestellnummer
   ------------------------------------------------------
   DCF77-Empfängermodul           1 Stk.    67 44 00
   DCF77-Ferrit-Antenne           1 Stk.    67 44 02
   Widerstand 240E                1 Stk.    71 21 57
   Widerstand 470E                2 Stk.    71 21 64
   Widerstand 15K                 1 Stk.    71 22 00
   Widerstand 180K                1 Stk.    71 22 26
   Z-Diode BZX79-2V7              1 Stk.    60 32 79
   Leuchtdiode Rot                1 Stk.    25 27 82
   Folien-Kondensator 0.1uF       1 Stk.    82 05 96
   Folien-Kondensator 1uF         1 Stk.    82 06 04
   IC 74HC14                      1 Stk.    64 32 08
   Buchse + Gehäuse DSUB-9-Pol    1 Stk.    12 48 18
   Kabel 3Pol * 0.14              5 Meter   52 03 20

Die Bauteilkosten kommen auf ca. sFr 50.-

Der Zusammenbau sollte vorsichtig durchgeführt werden. Kurzschlüsse können
zu Defekten des DCF77-Moduls oder sogar zum Tod des Computers führen.
Kontrolliere nach dem Zusammenbau nochmals alle Verbindungen.

Adresse Conrad Electronics:

          Conrad Electronics
          Klaus-Conrad-Strasse 1
          92240 Hirschau (Deutschland)
          Tel. 01 80 / 5 31 21 11
          Fax. 01 80 / 5 31 21 11

@EndNode

@Node "III" "Inbetriebnahme des Moduls"
@Next "IIII"
@Prev "II"
@Toc Main

3)  Inbetriebnahme des Moduls
-----------------------------------------------------------------------------

Bei der Inbetriebnahme des Moduls sollte die LED im Sekundentakt immer wieder
aufleuchten. Somit empfängt das Modul den Zeitcode. Das Programm kann somit
die Zeit ermitteln. Maximal braucht das Programm 2 Minunten, um die ganze
Zeitinformation dekodiert zu haben.

Hat die LED immer wieder grosse Unterbrüche, so ist der Empfang nicht optimal.
Versuche einen besseren Standort zu finden (z.B. beim Fenster)

Leuchtet die LED immer oder nie, so ist momentan kein guter Empfang des
DCF77-Signals. In der Nacht ist vielmals der Empfang besser.

Manchmal braucht das Modul nach dem Einschalten auch einige Minuten, bis es
den Zeitkode empfangen kann.

Es steht auch noch ein Debug-Modus zur Verfügung. Dieser stellt wie die LED
den Status der Empfangsleitung grafisch dar. Man muss im Sekundentakt kürzere
und längere Impulse dargestellt sehen.

@EndNode

@Node "IIII" "Software AtomUhr"
@Next "IIIII"
@Prev "III"
@Toc Main

4)  Software AtomUhr
-----------------------------------------------------------------------------

Das Programm kann in die WBStartup-Schublade kopiert werden. So wird beim
Aufstarten des Rechners automatisch die richtige Uhrzeit ermittelt und
gesetzt.


CLI-Start :
-----------

Wird das Programm vom CLI aus gestartet, werden die Tooltypes immer noch
vom Workbench-Icon gelesen.

Achtung : Es muss unbedinngt das aktuelle Verzeichnis gewechselt werden,
          indem das Programm inklusiv Workbench-Icon vorhanden ist !

          DH0:> cd AtomUhr
          DH0:AtomUhr> AtomUhr

Wenn das Workbench-Icon nicht gefunden werden kann, werden die Default-
Einstellungen verwendet.


Tooltypes des Programmes :
--------------------------

DOS_BEFEHL     Nach dem erfolgten Dekodieren der Zeit,kann ein Dos-Programm
               aufgerufen werden. Typisch ist z.b. "setclock save", dass die
               aktuelle Zeit gleichzeitig auch noch in die batteriegepufferte
               Uhr abgespeichert wird.

MAX_SUCHEZEIT  Maximale Zeit,in der eine gültige Zeit dekodiert werden muss.
               Danach wird das Programm abgebrochen. Die Angabe ist in
               Sekunden.

AUSGABE        Die Status der Zeit-Ermittlung kann in einem Fenster angezeigt
               werden.
               EIN = Das Ausgabefenster ist sichtbar.
               AUS = Keine Ausgabe ist sichtbar. Das Programm läuft im
                     Hintergrund. Fehlermeldungen werden nicht angezeigt.

VERGLEICH      Damit kann ein Zeitvergleich eingeschaltet werden. Die Zeit
               wird zweimal gelesen und verglichen. Dies erhöht die Sicher-
               heit.
               EIN = Zeitvergleich eingeschaltet.
               AUS = Zeitvergleich ausgeschaltet.

FENSTER_X      X-Koordinate des Fensters

FENSTER_Y      Y-Koordinate des Fensters

DEBUG          Der Pulszustand (gleiche Anzeige wie LED), kann grafisch
               dargestellt werden. Zu sehen ist mit ausgefuellten Bloecken
               der Zustand des LEDs.
               EIN = Das Ausgabefenster ist mit einer grafischen Debug-
                     Information sichtbar.
               AUS = Keine Debug-Ausgabe ist sichtbar.

PRIORITAET     Priorität des Programms. Diese Prioritaet sollte hoch gestellt
               werden, dass während der Zeitsuche kein anderes Programm die
               Zeitabtastung beeinflussen kann. Bleibt während dem Debug-Mode
               der Rechner plötzlich stehen (mit der Retina-Grafikkarte fest-
               gestellt worden), so muss die Priorität auf 0 gestellt werden.

PORT           Mit dieser Option kann eingestellt werden, welcher Eingang
               Hardwaremaessig verwendet worden ist. (Siehe auch Schema)
               JOY_PIN1 = Der Puls-Eingang ist am Joystickport 1 Pin 1 (Oben)
                          angeschlossen.
               JOY_PIN6 = Der Puls-Eingang ist am Joystickport 1 Pin 6 (Fire)
                          angeschlossen.
               SER_PIN8 = Der Puls-Eingang ist am internen Serialport Pin 8
                          (CD) angeschlossen. Falls ein Modem zugleich
                          angeschlossen ist, muss diese Leitung zum Modem
                          unterbrochen werden.


Status des Programms :
----------------------

"Suche Zeitblock-Anfang ..."      Es wird der Anfang der Zeitkodierung gesucht.
                                  Dies kann maximal 1 Minute dauern.

"Empfange Zeitblock ..."          Momentan wird die Zeitkodierung übertragen.
                                  Dies dauert 1 Minute.

"Zeitblock fertig"                Zeitblock ist fertig übertragen.

"Progamm-Exit"                    Das Programm wird verlassen.


Fehlermeldungen :
-----------------

"Error : Zuwenig Bits !"          Es sind zuwenig Bits übermittelt worden.
                                  Dies ist bei schlechtem Empfang der Fall.

"Error : Zuviel Bits !"           Es sind zuviele Bits übermittelt worden.
                                  Dies ist bei schlechtem Empfang der Fall.

"Error : Zeitcheck falsch !"      Ungültige Zeit übermittelt.

"Error : Zeitparity falsch !"     Parity-Check misslungen.

"Error : Bit nicht erkannt !"     Ungültige Bit-Zeitlänge übertragen.
                                  Dies ist bei schlechtem Empfang der Fall.

@EndNode

@Node "IIIII" "Kontakt"
@Next "IIIIII"
@Prev "IIII"
@Toc Main

5)  Kontakt
-----------------------------------------------------------------------------

Falls Du Fragen oder Probleme hast, kannst Du Dich bei folgenden E-Mail
Adressen melden :

     AMINET   : 44:8010/516@Stefan Gluekler
     FIDONET  : 2:301/723@Stefan Gluekler
     INTERNET : gluekler@swissonline.ch
     MAILBOX  : GIZMOZ ++41 (0)81 250 50 21

Oder auch mit Briefpost an :
                               Stefan Glükler
                               Rigastr. 5
                               7000 Chur
                               Schweiz

Falls Du auch eine kleine Änderung oder Verbesserung des Programmes wünschst,
kannst Du Dich bei mir melden.

Ps: Ein grosses Dank an meinen Betatester Rinaldo Pfister alias Fennek.

@EndNode

@Node "IIIIII" "Entwicklungsgeschichte"
@Prev "IIIII"
@Toc Main

6)  Entwicklungsgeschichte
-----------------------------------------------------------------------------

  V 1.0   01 November 95   Versuchsversion um die Hardware zu testen

  V 1.1   15 November 95   Erste lauffähige Version

  V 1.2   30 Dezember 95   Erste offizielle Version

  V 1.3   23 März     96   Neue Option für Zeitvergleich
  
  V 1.4   29 Januar   00   Bugfix fuer Jahr 2000

@EndNode
