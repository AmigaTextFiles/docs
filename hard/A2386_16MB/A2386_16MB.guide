@database A2386_16MB_Guide

@author "Jordan Krim"
@master A2386_16MB.guide
@$VER: A2386_16MB.guide 1.0 (04/05/98)
@font courier.font 13
@width 80

@node "Main"

     Manual to get 16 MB of On-Board RAM for the A2386sx BB  V1.1 (04/05/98)
                               (c) by Jordan Krim


                               @{B}Freeware@{UB}

-----------------------------------------------------------------------------

                     @{"  " link "Disclaim"} Disclaimer

                     @{"  " link "Intro"} Introduction


                     @{"  " link "Descript"} Description

                     @{"  " link "ROMChange"} ROM BIOS change

                     @{"  " link "Installation"} Installation



                     @{"  " link "Freeware"} Freeware

                     @{"  " link "Author"} About the author

                     @{"  " link "Copyright"} Copyright


                     @{"  " link "Future"} Future Projects

                     @{"  " link "Thanks"} Thanks to ...

-----------------------------------------------------------------------------
@endnode



@node "Disclaim" Disclaimer
NOTICE:
=======

I am not responsible for any damage which is produced by the use of this
information.  That having been said, if you do have problems, I will still
try to help you resolve them.

@endnode





@node "Intro" Introduction
Introduction
============

For many years, I have been happily running my A2386sx BB.  I have made
many upgrades along the way, including adding the Evergreen #300.  This
increased the performance from 25 Mhz to 75 Mhz which made a great
improvement in the performance.  However, I still found that running OS/2
with only 8 MB of RAM was slow.  I really wanted 16 MB of RAM.

So, I looked into how I might do this.  First, I could buy a card, but
this takes an AT slot.  I had removed my Amiga motherboard and soldered
the 2 outside AT slot comnnectors in some time ago, so I had 4 slots,
but they were all taken:  the Bridgeboard, a Diamond Speestar ISA video
card, a Sound Blaster card, and a multi I/O card.  So, I bought a Winstorm
card, but I haven't got it to work, yet.  Anyway, the off-motherboard
RAM is always slower..

There was only one answer left.  I had to attempt to get the whole 16 MB
on-board.  In order to do this, the ZIP memory had to go.  So, that's when
I stumbled onto the AmiFast-II, which is a nice ZIP to SIMM converter.
I started out with an 8 MB SIMM, just to make sure it worked.  Of course,
I thought, why not put a 32 MB SIMM in the AmiFast-II?  Well, thankfully,
before I tried this I found the specification for the DRAM controller and
quickly realized that the limit of it's memory access is 16 MB.  So after
verifying the 8 MB SIMM, I tried a 16 MB SIMM, but even with the extra address
I only got 4 MB.

So, then I had no choice but to give up or start disassembling the BB BIOS.
So I spent a couple months and with a lot of help, I found the fixes to the
BIOS that results in almost 16 MB.  I say "almost" because, unfortunately,
the DRAM Controller sends the last 128 KB below 16 MB to ROM and there is
no way to prevent this.

I did this because I love my Bridgeboard, I love my Amiga, and I don't
need a 333 Mhz Pentium and I'm sure there are lots of BB users who can get
the type of performance increase I am seeing now.  OS/2 is muuch snappier
now and for those who are running Windows 3.x or Windows 95, I think this
could make a big difference.  Besides, it was a great opportunity to re-learn
assembly language and assembly coding.

So, what's the price tag on this?  Well, it depends on how good a hardware
and firmware hacker you are.  It probably can cost as little as $30 US.
So, I hope you read through the rest of the manual and get some useful
information on how to increase your Bridgeboard performance.

Enjoy!


@endnode








@node Descript
Description
===========

There are 4 basic steps in achieving the 16 MB on-board RAM fix:

(1)  I suggest that you obtain or build a ZIP to SIMM adapter.  There are
     2 available that I know about at this time.  There is the AmiFast-II
     available from Provtech.  It has room for 1 SIMM, but it is very
     compact and probably won't waste an Amiga or AT slot.  Try e-mailing
     provtech@hotmail.com, ksiders@viaduct.custom.net or
     provtech@viaduct.custom.net.
     The second ZIP to SIMM adapter is a 2 SIMM adapter which probably
     is less compact and may require wasting an Amiga or AT slot due
     to heighth.  A description of how to build it is on Aminet
     under hard/hack and is called A2386_PS2_V1.3.lha.  It is stated that
     the adapter may be ordered from the author who can be contacted at
     Heiko.Pruessing@mni.fh-giessen.de.
(2)  The second step is to connect the extra address line (MA10) from the
     Bridgeboard to the SIMM.  Hold the Bridgeboard with the component
     side up.  Find the compenent labled R205 which is a 19.K ohm resistor.
     It is left of the DRAM Controller chip, which is marked VLSI 82C311.
     The left end of R205 needs to be attached to Pin 19 of the SIMM adapter
     or adapters (if more than one) or directly to the SIMM if you are bold
     enough to wire a SIMM directly from the Bridgeboard to the SIMM.
(3)  Obtain the SIMM for your particular adapter.  For the AmiFast-II you
     will need a 16 MB 72 pin non-parity (page mode) SIMM with 8 DRAM
     modules on it.  Do not get an EDO SIMM.  It will not work.  Do not
     get a SIMM with less than 8 DRAM chips.  It probably won't work, either.
     For the A2386_PS2 adapter the above 16 MB SIMM should work.  Also,
     it is possible that 2 8 MB SIMMs may work, but again they have to
     be 72 pin non-parity with 16 DRAM chips (8 on each side).  Again,
     not EDO or less than 16 DRAM chips.
(4)  The ROM BIOS of the Bridgeboard needs to be modified.  See the section
     @{"ROM BIOS change" link "ROMChange"} on how to do this.





@endnode













@node ROMChange
How to change the ROM BIOS
==========================

In order to accomplish this task you need a EPROM burner and possibly an
ultra-violet (UV) light source.  If you decide not to re-burn your original
BIOS ROM, which I highly discourage, then you may not need the UV source.
If you do not have access to such a device, contact @{"me" link "author"}
for help.

Here is a list of the changes that must be made:


ADDRESS     OLD DATA    NEW DATA
=======     ========    ========

6989        a8          7e
698A        09          6a


73a6        8a          e0
73a7        b4          ff

c078        c1          e8
c079        e8          a5
c07a        06          13


d409        ff          b0
d40a        ff          03
d40b        ff          8a
d40c        ff          e0
d40d        ff          e8
d40e        ff          c5
d40f        ff          9b
d410        ff          24
d411        ff          f0
d412        ff          0c
d413        ff          09
d414        ff          86
d415        ff          c4
d416        ff          e8
d417        ff          cd
d418        ff          9b
d419        ff          e8
d41a        ff          17
d41b        ff          8f
d41c        ff          c3

d420        ff          c1
d421        ff          e8
d422        ff          06
d423        ff          3c
d424        ff          00
d425        ff          0f
d426        ff          84
d427        ff          02
d428        ff          00
d429        ff          b0
d42a        ff          ff
d42b        ff          c3

ffff        00          f3


@endnode



@node Installation
Installation
============

Power the machine off. Remove the Bridgeboard, if you need to.

The installation of the adapter should be installed according to the
installation instructions of the product that you obtain.

In order to remove the ROM BIOS chip from the scoket, one need only carefully
pry it up using a screwdriver or if you have some other chip remover.  Then
pop in the new ROM BIOS chip or the re-programmed original chip  BE SURE THAT
THE ORIENTAION IS CORRECT!  The notch on the top of the ROM BIOS chip needs
to face toward the left if you are holding the Bridgeboard in front of
you with the component side up.  It is best to note the orientation before
removing the chip, so no problems occur.  Make sure the chip is firmly
seated back in the socket.

Reinstall the Bridgeboard if you need to.  Make sure the MA10 line is attached
as described in the @{"Description" link "Descript"} section.

Power back on.  The Power-on-self-test (POST) memory test should detect
640 KB Base Memory and 15232 KB extended memory.  Go into the CMOS with
Ctrl-Alt-Esc or the program supplied with the Bridgeboard called BBSETUP.COM
and change the "On-board Extended memory" to 15232 KB.  The Bridgeboard
should then boot successfully with no "Invalid Configuration" message.

That's it!  Hopefully, this will work.


@endnode






@node "Freeware" Freeware


This is totally freeware.  However, if you cannot perform any of these
steps contact @{"me" link "author"} and I will do all or some of the
necessary steps for a nominal fee.  This means that parts cost that
you do not obtain and that I need to obtain and shipping from you
to me and/or shipping from me to you.



@endnode








@node "Copyright" Copyright
Copyright
=========

You may distribute this manual as long as no file is changed.
@endnode






@node "author"
The author
==========

If you have any problems with these instructions or can not perform
the steps necessary to do this, you can reach me at:


Jordan Krim
Tel. 520-298-4521
     520-794-9212
Tucson, AZ  (USA)

email: krim@azstarnet.com or jakrim@ccgate.hac.com or jakrim@mail.tu.hac.com.

My configuration:

* AMIGA 2000 (Rev 3.9 motherboard) with OCS chipset
  except I have installed Fat Agnus
* GVP G Force 30 (with 40 Mhz 030EC)
* 5 MegaBytes RAM
* Dataflyer IDE card with 546 MB Maxtor drive attached
* 100 MB Seagate SCSI drive (attached to GVP card)
* Picasso II (2 MB)
* OS 1.2/3.1
* Commodore 2002 monitor
* 880 KB Amiga Floppy Drive
* 1.76 MB Amiga Floppy Drive (shared with Bridgeboard)

* A2386-Bridgeboard (25Mhz)
  with Evergreen #300 486 @ 75 Mhz
* Original ROM BIOS V1.00 (1991) (with my modifications)
* 16 MB RAM (Yeah!)
* 1.44 MB Floppy (see above)
* 1.2 MB Floppy
* Seagate IDE 6.4 Gigabytes
* NEC 4x IDE CDROM
* Diamond Speedstar Pro ISA card
* IDE Professional VL Multi-I/O card
* Sound Blaster IDE Value Edition card
* IBM VGA 8515 Monitor

* Dynalink 28.8 KBaud Modem shared between Amiga and Bridgeboard
 via A/B Switch

  All the hardware is (skillfully) installed in a standard
  Amiga case and a small PC tower connected by
  ribbon cable through the back of each case.



@endnode




@node "Future" Future projects

Future projects
===============


I was hoping that I would have time to create a ROM image that was
capable of supporting all the various configurations. This would be
all the ones that are listed in the A2386SX Bridgeboard user's Guide
for the ZIP DRAM.  It would also support the new ones which involve SIMMs.
Mostly, I wanted to get the 1 8 MB SIMM and the 1 16 MB SIMM configuration
to work.  But it could work for 2 8 MB SIMMs or other configurations of
various sized SIMMs.  If I have more free time, I will look into this.


@endnode







@node "Thanks" "Thanks go to ..."


Finally, I need to thank the following people who helped out on this project:

Remi Lenoir - provided an annotated BIOS disassembly listing and provided
              consultation on the BIOS fix including much needed and useful
              CMOS information.
Ian Shef    - Also provided help in understanding the dissassembled code and
              other issues related to 386 PCs.  Also, provided me with a copy
              of the VLSI 82C311 SCAMP DRAM controller chip (used on the BB)
              specification.
Keith Siders - Sold me the Amifast-II ZIP to SIMM converter which has been
               removed and put back in the BB countless times now and works
               flawlessly.  BTW, I use it with the original BIOS and an 8 MB
               SIMM.
James R. Van Zandt - Author of DIS86.  An extremely well done 386 dissassembler,
                     which helped determine the BIOS fix.
Heiko Prüssing - Author of A2386_PS2_V1.3.  I used his Amigaguide manual
                 as a template to do mine, since I have never done one
                 before and I did not want to spend great time to learn
                 another program (such as Heddley).
Arthur Perkins - Beta tester




@endnode
