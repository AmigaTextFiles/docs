                   Batteriegepufferte Echtzeituhr
----------------------------------------------------------------------------


***************************************************************************
* Diese Bastelanleitung fanden wir auf der Fred Fish Pulic Domain Library *
*                              Disk Nr. 65                                *
* Wir haben uns diese Echtzeituhr bis zum heutigen Tage (20.06.87) nicht  *
* gebaut, daher können wir nicht mit Bestimmtheit sagen ob die Schaltung  *
*         ihrem Amiga nicht das Lebenslicht ausblasen wird !              *
***************************************************************************

Inhalt dieses Ordners: LiesMich, Poster, Jtime.txt, Liste,
                       Schaltplan, Zeitdiagram, Software für die Uhr.


Einführung:

Der Amiga speichert mit jedem File die Uhrzeit und das Datum der internen
Uhr ab. Dieses Feature ist sehr hilfreich für die Filesuche aus dem CLI.
So können Sie z.B. mit 'list since Saturday' alle Files auflisten lassen,
die Sie seit dem letzten Samstag abgespeichert haben. Für diesen Luxus müßen
Sie aber nach jedem Booten die Uhr stellen (WB: Preferences, CLI: date).
Des eintönigen Stellens wird man sehr schnell müde und unterläßt es dann.
Um dieses Problem zu lösen gibt es batteriegepufferte Echtzeituhren.
Z.Zt existieren drei, über diverse Fremdfirmen angebotene, Varianten dieser
Hardwareerwiterung.
Die erste Art der Erweiterung wird, wie diverse Sound-Sampler auch, an den
den seriellen und den parallelen Port angeschlossen. Diese Anschlußweise
macht aber den Druckerbetrieb unmöglich. Des weiteren sind einige Hardware-
karten nicht in der Lage diese Erweiterung zu erkennen.
Die zweite Anschlußweise nutzt den Systembus seitlich des Amigas. Leider
werden diese Erweiterungen fast nur in Verbindung mit einer Ramerweiterung
angeboten. Wenn man sich aber eine Ramerweiterung zulegen will, stellt
diese Erweiterung eine preiswerte Möglichkeit dar.
Der dritte Type einer Echtzeituhr wird auf den Mausport #2 gesteckt.
Da dieser Port nur vom Joystick genutzt wird und man beim Spielen keine
Echtzeiuhr benötigt, stellt diese Art der Anschlußweise meiner Meinung nach
die günstigste Alternative dar. Diese Möglichkeit nutzt die hier erklärte
batteriegepufferte Echtzeituhr.


Der 'Clock Chip':

Die JTime Erweiterung benutzt einen preiswerten, gebräuchlichen Clock Chip,
der RTC 58321, der Firma SaRonix. Dieser Chip enthält alles was ein
Computer für eine Echtzeituhr benötigt. Eine komplette Uhr mit Kalender und
Schaltjahrkorrektur, einen 4 Bit breiten Bidirektionalen Datenbus und einen
eingbauten Quarz, eingebaut in ein 16 Pin Gehäuse. Der Chip nimmt nur 10 bis
20 Mikroamp. bei 3 bis 5 Volt auf.


Die Schaltung:

Der Amiga Mausport #2 stellt sieben I/O Anschlüsse zu Verfügung.
Vier dieser Anschlüsse (normalerweise für Joystick oben/unten/rechts/links
gebraucht) können für das Lesen der Uhr genutzt werden. Zwei der restlichen
Anschlüsse können für das Stellen der Uhr genutzt werden.
Der Computer sendet 8 Bit Pulse and das IC1 (siehe Schaltplan).


Benötigte Software:

Die Software wird benötigt, um die Echtzeituhr nach jedem Booten des Amiga
zu lesen und um die Echtzeituhr zweimal im Jahr zu stellen (Sommer-, Winter-
zeit). Die Programme könnten in jeder Sprache geschrieben sein, der Autor
entschied sich für die Sprache C. Um die Echtzeituhr auszulesen, muß man
nur das Programm 'JTime' ohne jegliche Parameter starten. (vom CLI: JTIME).
Um die Echtzeituhr zu stellen muß man noch eine '1' als Parameter über-
geben (vom CLI: JTIME 1).
Daten fließen zu und von JTIME durch die RAMfiles RAM:TimeIN und
RAM:TimeOUT. Nachdem die extere Uhr ausgelesen ist steht in der
RAM:-'Floppy' das File TimeOUT. Es enthält Uhrzeit und Datum im AmigaDOS
Format. Mit 'Execute' wird es ausgeführt, um so die interne Uhr zu stellen.
Natürlich stellt dieses mehr Arbeit dar als das manuelle Stellen der
internen Uhr durch 'Preferences' bzw. 'Date'. Daher sollte man diese Arbeit
dem Computer überlassen indem man folgendes in die 'Startup-Sequence'
einfügt:

JTime
Execute RAM:TimeOUT
delete Ram:TimeOUT

Das Stellen der externen Uhr ist sehr leicht, zunächst muß man die interne
Uhr stellen (Preferences oder DATE). Nun muß man nur noch das 'Batchfile'
SET, auch in diesem Ordner enthalten, durch 'EXECUTE SET' starten, fertig.


Die Herstellung der Uhr:

Diese Uhr kann man für weniger als 25 Dollar basteln (orig. Text Fred Fish:
You can buy all the parts for the circuit for less than $25). Wie die
Preise für die benötigten Teile hier in Deutschland aussehen entzieht sich
leider meines Wissens. Als Bezugsadresse für die Teile nannte Fred die Firma
'Jameco Electronics, 1355 Shoreway Road, Belmont CA 94002' .


Die neue Startup-Sequence:

Wie vorrausgehend schon erklärt muß man die 'Startup-Sequence' ein wenig
erweitern, hier ein Prototyp einer solchen 'Startup-Sequence':

JTime
Execute RAM:TimeOUT
delete RAM:TimeOUT
Date > LastDate
LoadWb
EndCLI


Ich hoffe, meine Anleitung war informativ und bewegte Sie zum Basteln
dieser kleinen Erweiterung. Der amerikanische Originaltext ist aber auch
in diesem Ordner enthalten. Bei Unklarheiten können Sie ihn zu Rate ziehen.
Viel Vergnügen mit Ihrer zukünftigen batteriegepufferten Echtzeituhr

                                                        ...... A.U.G.E. 4000
