<html>
<head>
<title>SELFHTML: Dynamisches HTML /  Praxis / Datums-/Uhrzeitanzeige</title>
<meta name="description" content="(SELFHTML 7.0) Beispiel einer Datums- und Uhrzeitanzeige mit Dynamischem HTML, die mit dem MS Internet Explorer und mit Netscape funktioniert.">
<meta name="keywords" content="SELFHTML, Dynamisches HTML, Dynamic">
<link rel=stylesheet type="text/css" href="wselfhtm.css">
</head>
<body bgcolor=#ffffff text=#000000 link=#aa5522 vlink=#772200 alink=#000000>

<p><nobr><a class="an" name="top"><img src="x2.gif" width=16 height=13 border=0></a> <a href="selfhtml.htm"><b>SELFHTML</b></a>/<a href="tq.htm" target="_parent">Quickbar</a>&#160;
<img src="x2.gif" width=16 height=13 border=0> <a href="tf.htm"><b>Dynamisches HTML</b></a>&#160;
<img src="x2.gif" width=16 height=13 border=0> <a href="tfc.htm"><b>L&ouml;sungen f&uuml;r die Praxis</b></a></nobr></p>
<hr noshade size=1>
<table cellpadding=4 cellspacing=1 width=100%>
<tr>
<td bgcolor=#EEEEEE class="doc" width=110><img src="xweb.gif" width=106 height=109></td>
<td bgcolor=#EEEEEE class="doc" valign=bottom width=100%><h2>Datums-/Uhrzeitanzeige</h2></td>
</tr>
<tr>
<td bgcolor=#EEEEEE class="doc" valign=top align=center>
<img src="x5.gif" width=30 height=20 vspace=6 border=0 alt="Diese Seite ist ein Dokument mit Informationstext">
</td>
<td bgcolor=#ffffff valign=top nowrap>

<p>
<img src="xgdown.gif" width=14 height=10 border=0>&nbsp;<a href="#a1"><b>Datums-/Uhrzeitanzeige - das Beispiel</b></a>
</p>

</td>
</tr><tr><td colspan=2 bgcolor=#EEEEEE class="doc"><a href="#bottom"><img src="xgdown.gif" width=14 height=10 border=0></a>&#160;</td></tr>
</table>



<h2 class="Sh2"><a class="an" name="a1"><img src="xmsie4.gif" width=30 height=30 border=0 alt="MS IE 4.0"><img src="xnetsi4.gif" width=30 height=30 border=0 alt="Netscape4.0"> Datums-/Uhrzeitanzeige - das Beispiel</a></h2>

<p><img src="xview.gif" width=30 height=20 border=0 alt="Beispiel" align=absmiddle> <a href="tfcaa.htm"><b>Anzeigebeispiel: So sieht's aus</b></a></p>

<p>Dieses Beispiel zeigt, wie Sie eine laufende Uhr, die Sie beliebig formatieren k&ouml;nnen, so realisieren k&ouml;nnen, da&szlig; sie sowohl auf dem MS Internet Explorer ab V4.0 als auch auf Netscape ab V4.0 funktioniert.</p>

<p><b>Hinweis:</b> Zur besseren Orientierung enth&auml;lt das Beispiel Verweise zu den entsprechenden Erl&auml;uterungen, z.B. <a name="a1b1" href="#a1a1"><b>1*</b></a>. Diese Verweise geh&ouml;ren nicht zum Quellcode. Falls Sie das Beispiel in einen Editor kopieren, m&uuml;ssen Sie diese Verweise l&ouml;schen. Andernfalls erhalten Sie JavaScript-Fehlermeldungen.</p>

<h3 class="xmp">Beispiel:</h3>
<table width=100% cellpadding=10><tr><td class="xmpcode" bgcolor=#FFFFE0><pre>
&lt;html&gt;
&lt;head&gt;
&lt;style type=&quot;text/css&quot;&gt;
all.Uhr { font-family:Century Gothic,Arial; font-size:36pt; color:blue; }
&lt;/style&gt;
<a name="a1a2" href="#a1b2"><b>2*</b></a> &lt;script language=&quot;JavaScript&quot;&gt;
&lt;!--
 Wochentagname =
 new Array(&quot;Sonntag&quot;,&quot;Montag&quot;,&quot;Dienstag&quot;,&quot;Mittwoch&quot;,&quot;Donnerstag&quot;,&quot;Freitag&quot;,&quot;Samstag&quot;);
function ZeitAnzeigen() 
{ 
 var Jetzt = new Date();
 var Tag = Jetzt.getDate();
 var Monat = Jetzt.getMonth() + 1;
 var Jahr = Jetzt.getYear();
 var Stunden = Jetzt.getHours();
 var Minuten = Jetzt.getMinutes();
 var Sekunden = Jetzt.getSeconds();
 var WoTag = Jetzt.getDay();
 var Vortag  = ((Tag &lt; 10) ? &quot;0&quot; : &quot;&quot;);
 var Vormon  = ((Monat &lt; 10) ? &quot;.0&quot; : &quot;.&quot;);
 var Vorstd  = ((Stunden &lt; 10) ? &quot;0&quot; : &quot;&quot;);
 var Vormin  = ((Minuten &lt; 10) ? &quot;:0&quot; : &quot;:&quot;);
 var Vorsek  = ((Sekunden &lt; 10) ? &quot;:0&quot; : &quot;:&quot;);
 var Datum = Vortag + Tag + Vormon + Monat  + &quot;.&quot; + Jahr;
 var Uhrzeit = Vorstd + Stunden + Vormin + Minuten + Vorsek + Sekunden;
 var Gesamt = Datum + &quot;&lt;br&gt;&quot; + Wochentagname[WoTag] + &quot;&lt;br&gt;&quot; + Uhrzeit;

<a name="a1a4" href="#a1b4"><b>4*</b></a> if(document.all)
   document.all.MicrosoftUhr.innerHTML = Gesamt;
 else if(document.layers)
  {
   document.NetscapeUhr.document.open();
   Gesamt = '&lt;span class=&quot;Uhr&quot;)&gt;' + Gesamt + '&lt;/span&gt;';
   document.NetscapeUhr.document.write(Gesamt);
   document.NetscapeUhr.document.close();
  }

 window.setTimeout(&quot;ZeitAnzeigen()&quot;,1000);
}
// --&gt;
&lt;/script&gt;
&lt;/head&gt;
&lt;body bgcolor=#FFFFFF&gt;

<a name="a1a1" href="#a1b1"><b>1*</b></a> &lt;div id=&quot;MicrosoftUhr&quot; class=&quot;Uhr&quot;&gt;
&lt;/div&gt;

&lt;layer id=&quot;NetscapeUhr&quot;&gt;
&lt;/layer&gt;

<a name="a1a3" href="#a1b3"><b>3*</b></a> &lt;script language=&quot;JavaScript&quot;&gt;
&lt;!--
window.setTimeout(&quot;ZeitAnzeigen()&quot;,1000);
// --&gt;
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre></td></tr></table>

<h3 class="xpl">Erl&auml;uterung:</h3>

<p>Im K&ouml;rper der HTML-Datei im Beispiel werden zwei leere Beh&auml;lter definiert: ein <tt>&lt;div&gt;</tt>-Bereich und ein <tt>&lt;layer&gt;</tt>-Bereich (<a name="a1b1" href="#a1a1"><b>1*</b></a>). Die <tt>id</tt>-Namen der beiden Bereiche sagen bereits alles &uuml;ber die Bedeutung der Bereiche. Der <tt>&lt;div&gt;</tt>-Bereich wird f&uuml;r den MS Internet Explorer definiert, der <tt>&lt;layer&gt;</tt>-Bereich f&uuml;r Netscape. Netscape kennt zwar beide HTML-Tags, stellt den <tt>&lt;div&gt;</tt>-Bereich aber in keiner Weise dar, weil dieser leer ist.</p>

<p>Die Beispieldatei enth&auml;lt ferner zwei JavaScript-Bereiche. Der eine Bereich ist im Dateikopf notiert (<a name="a1b2" href="#a1a2"><b>2*</b></a>), der andere unterhalb der beiden &quot;Beh&auml;lter&quot; (<a name="a1b3" href="#a1a3"><b>3*</b></a>). Im unteren JavaScript-Bereich passiert nichts weiter als der erste Aufruf der JavaScript-Funktion <tt>ZeitAnzeigen()</tt>, die im oberen Script-Bereich steht und f&uuml;r die Zeitanzeige verantwortlich ist. Der Aufruf erfolgt durch die Einbettung in eine <tt>setTimeout()</tt>-Methode um 1000 Millisekunden, also um eine Sekunde verz&ouml;gert. Dies ist notwendig, da der MS Internet Explorer sonst eine merkw&uuml;rdige Fehlermeldung bringt (Begr&uuml;ndung daf&uuml;r gibt es keine, das sind typische Probleme, die nur durch viel Herumprobieren zu l&ouml;sen sind).</p>

<p>In dem JavaScript-Bereich, der im Dateikopf steht, wird gleich beim Einlesen ein global definierter Array f&uuml;r die deutschen Wochentage definiert. Darunter steht die Funktion <tt>ZeitAnzeigen()</tt>, die f&uuml;r die dynamische Datums-/Uhrzeitanzeige verantwortlich ist. Die Funktion ermittelt zun&auml;chst mit Hilfe des Date-Objekts die aktuelle Zeit. Mit Hilfe diverser Formatierbefehlen erzeugt sie dann eine Zeichenkette, die einen ordentlich Datums-/Uhrzeitdarstellung Konvention darstellt. Diese Zeichenkette wird in der Variablen mit dem Namen <tt>Gesamt</tt> gespeichert. All diese Dinge haben noch nichts mit der Anzeige zu tun und funktionieren problemlos mit beiden Browsern.</p>

<p>Die entscheidende Abfrage zur Unterscheidung der Browser erfolgt in den Anweisungen (<a name="a1b4" href="#a1a4"><b>4*</b></a>):<br>
<tt>if(document.all)</tt> und<br>
<tt>else if(document.layers)</tt><br>
Es handelt sich um Abfragen, ob das betreffende Objekt existiert. Der MS Internet Explorer kennt das all-Objekt, das Layer-Objekt dagegen nicht. Netscape dagegen kennt das Layer-Objekt, aber nicht das all-Objekt. &Auml;ltere Browser, die keines dieser beiden JavaScript-Objekte kennen, gelangen in keinen der beiden Zweige.</p>

<p>Beim MS Internet Explorer ist die Sache relativ einfach. Mit der Eigenschaft <tt>innnerHTML</tt> des all-Objekts l&auml;&szlig;t sich jederzeit dynamisch der Inhalt eines HTML-Elements neu setzen. Mit <tt>document.all.MicrosoftUhr</tt> wird das Element angesprochen, das mit <tt>id=</tt> den entsprechenden Namen erhalten hat, also der <tt>&lt;div&gt;</tt>-Bereich. Die Eigenschaft <tt>innnerHTML</tt> bekommt einfach den Wert der Variablen Gesamt zugewiesen. Damit zeigt der Internet Explorer die aktuelle Uhrzeit in dem <tt>&lt;div&gt;</tt>-Bereich an.</p>

<p>Bei Netscape macht sich das Beispiel die Eigenschaft zu nutze, da&szlig; ein Layer eine Art Dokument im Dokument darstellt, in das man jederzeit mit Hilfe von <tt>document.write()</tt> neue Daten schreiben kann. Das Dokument im Dokument wird im Beispiel mit <tt>document.NetscapeUhr.document</tt> angesprochen. Dabei ist <tt>NetscapeUhr</tt> der Name, den der Layer bei <tt>id=</tt> erhalten hat. Ganz wichtig ist, da&szlig; zun&auml;chst <tt>document.open()</tt> notiert wird und am Ende <tt>document.close()</tt>. Ansonsten w&uuml;rde Netscape die Uhrzeitanzeige nicht jede Sekunde &uuml;berschreiben, sondern fortlaufend hintereinander schreiben.</p>

<p>Leider &uuml;bernimmt Netscape bei <tt>document.write()</tt> keine CSS-Style-Sheet-Angaben. Deshalb wird dynamisch innerhalb des <tt>document.write()</tt>-Befehls mit einem <tt>&lt;span&gt;</tt>-Tag die n&ouml;tige Zuweisung nachgeholt. Alle Angaben, die zur Formatierung der Uhr geh&ouml;ren, stehen in einem Style-Sheet-Bereich im Dateikopf.</p>


<table cellpadding=4 cellspacing=1 width=100%>
<tr><td colspan=2 bgcolor=#EEEEEE class="doc">
<a href="#top"><img src="xgoup.gif" width=14 height=10 border=0></a>
</td></tr>
<tr><td bgcolor=#EEEEEE class="doc" align=right width=110>weiter:<a href="tfcb.htm"><img src="xgnext.gif" width=10 height=10 border=0 hspace=10></a></td>
<td bgcolor=#ffffff><img src="x3.gif" width=15 height=10 border=0> <a href="tfcb.htm"><b>Verschiebbare Seitenelemente</b></a>
</td></tr>
<tr>
<td bgcolor=#EEEEEE class="doc" align=right width=110>zur&uuml;ck:<a href="tfbe.htm"><img src="xgprev.gif" width=10 height=10 border=0 hspace=10></a></td>
<td bgcolor=#ffffff width=100%><img src="x3.gif" width=15 height=10 border=0> <a href="tfbe.htm"><b>Dynamisches Positionieren (Netscape)</b></a>
</td>
</tr>
<tr><td colspan=2 bgcolor=#EEEEEE class="doc">&#160;</td></tr>
</table>
<hr noshade size=1>
<p><nobr><img src="x2.gif" width=16 height=13 border=0> <a href="selfhtml.htm"><b>SELFHTML</b></a>/<a href="tq.htm" target="_parent">Quickbar</a>&#160;
<img src="x2.gif" width=16 height=13 border=0> <a href="tf.htm"><b>Dynamisches HTML</b></a>&#160;
<img src="x2.gif" width=16 height=13 border=0> <a href="tfc.htm"><b>L&ouml;sungen f&uuml;r die Praxis</b></a></nobr></p>
<p><nobr><a class="an" name="bottom">&copy; 1998</A> <img src="xgmail.gif" width=15 height=10 border=0>&nbsp;<a href="mailto:muenz@csi.com">Stefan M&uuml;nz, muenz@csi.com</a></nobr></p>


</body>
</html>