<html>
<head>
<title>SELFHTML: JavaScript / Anwendungsbeispiele / Formulareingaben &uuml;berpr&uuml;fen</title>
<meta name="description" content="(SELFHTML 7.0) JavaScript, das Eingaben in einem Formular &uuml;berpr&uuml;ft, bevor das Formular abgesendet wird.">
<meta name="keywords" content="SELFHTML, JavaScript, Formular, pr&uuml;fen">
<link rel=stylesheet type="text/css" href="wselfhtm.css">
</head>
<body bgcolor=#ffffff text=#000000 link=#aa5522 vlink=#772200 alink=#000000>

<p><nobr><a class="an" name="top"><img src="x2.gif" width=16 height=13 border=0></a> <a href="selfhtml.htm"><b>SELFHTML</b></a>/<a href="tq.htm" target="_parent">Quickbar</a>&#160;
<img src="x2.gif" width=16 height=13 border=0> <a href="te.htm"><b>JavaScript</b></a>&#160;
<img src="x2.gif" width=16 height=13 border=0> <a href="ted.htm"><b>Anwendungsbeispiele</b></a></nobr></p>
<hr noshade size=1>
<table cellpadding=4 cellspacing=1 width=100%>
<tr>
<td bgcolor=#EEEEEE class="doc" width=110><img src="xweb.gif" width=106 height=109></td>
<td bgcolor=#EEEEEE class="doc" valign=bottom width=100%><h2>Formulareingaben &uuml;berpr&uuml;fen</h2></td>
</tr>
<tr>
<td bgcolor=#EEEEEE class="doc" valign=top align=center>
<img src="x5.gif" width=30 height=20 vspace=6 border=0 alt="Diese Seite ist ein Dokument mit Informationstext">
</td>
<td bgcolor=#ffffff valign=top nowrap>

<p>
<img src="xgdown.gif" width=14 height=10 border=0>&nbsp;<a href="#a1"><b>Formulareingaben &uuml;berpr&uuml;fen - das Beispiel</b></a>
</p>

</td>
</tr><tr><td colspan=2 bgcolor=#EEEEEE class="doc"><a href="#bottom"><img src="xgdown.gif" width=14 height=10 border=0></a>&#160;</td></tr>
</table>



<h2 class="Sh2"><a class="an" name="a1"><img src="xnetsi3.gif" width=30 height=30 border=0 alt="Netscape3.0"><img src="xmsie4.gif" width=30 height=30 border=0 alt="MS IE 4.0"> Formulareingaben &uuml;berpr&uuml;fen - das Beispiel</a></h2>

<p><img src="xview.gif" width=30 height=20 border=0 alt="Beispiel" align=absmiddle> <a href="tedfa.htm"><b>Anzeigebeispiel: So sieht's aus</b></a></p>

<p>Wenn Sie HTML-basierte <img src="x1.gif" width=15 height=13 border=0>&nbsp;<a href="tch.htm"><b>Formulare</b></a> im WWW anbieten, kann jeder Anwender irgendeinen Unsinn in das Formular schreiben und es dann abschicken. Betroffen davon sind vor allem einzeilige und mehrzeilige Eingabefelder. Dadurch erhalten Sie &uuml;berfl&uuml;ssige E-Mails, oder ein <img src="x1.gif" width=15 height=13 border=0>&nbsp;<a href="tg.htm"><b>CGI</b></a>-Script, das die Formulareingaben verarbeitet, speichert leere oder nutzlose Daten ab. Mit Hilfe von JavaScript k&ouml;nnen Sie Formulareingaben &uuml;berpr&uuml;fen, bevor das Formular abgeschickt wird. Bei fehlenden oder offensichtlich fehlerhaften Eingaben k&ouml;nnen Sie das Absenden des Formulars verhindern.</p>

<p>Das Beispiel auf dieser Seite zeigt, wie eine solche &Uuml;berpr&uuml;fung im Prinzip funktioniert. Je nachdem, was Ihr Formular enth&auml;lt, m&uuml;ssen Sie das Beispiel nat&uuml;rlich erweitern.</p>

<p><b>Hinweis:</b> Zur besseren Orientierung enth&auml;lt das Beispiel Verweise zu den entsprechenden Erl&auml;uterungen, z.B. <a href="#a1a1"><b>1*</b></a>. Diese Verweise geh&ouml;ren nicht zum Quellcode. Falls Sie das Beispiel in einen Editor kopieren, m&uuml;ssen Sie diese Verweise l&ouml;schen. Andernfalls erhalten Sie JavaScript-Fehlermeldungen.</p>

<h3 class="xmp">Beispiel:</h3>
<table width=100% cellpadding=10><tr><td class="xmpcode" bgcolor=#FFFFE0><pre>
 &lt;html&gt;
 &lt;head&gt;
 &lt;title&gt;Seitentitel&lt;/title&gt;
 &lt;script language=&quot;JavaScript&quot;&gt;
  &lt;!--
  <a name="a1a2" href="#a1b2"><b>2*</b></a> function chkFormular()
  {
   if(document.Formular.User.value == &quot;&quot;)
    {
     alert(&quot;Bitte Ihren Namen eingeben!&quot;);
     document.Formular.Name.focus();
     return false;
    }
   if(document.Formular.Ort.value == &quot;&quot;)
    {
     alert(&quot;Bitte Ihren Wohnort eingeben!&quot;);
     document.Formular.Ort.focus();
     return false;
    }
   if(document.Formular.Mail.value == &quot;&quot;)
    {
     alert(&quot;Bitte Ihre E-Mail-Adresse eingeben!&quot;);
     document.Formular.Mail.focus();
     return false;
    }
   if(document.Formular.Alter.value == &quot;&quot;)
    {
     alert(&quot;Bitte Ihr Alter eingeben!&quot;);
     document.Formular.Alter.focus();
     return false;
    }
   if(document.Formular.Mail.value.indexOf('@') == -1)
    {
     alert(&quot;Keine E-Mail-Adresse!&quot;);
     document.Formular.Mail.focus();
     return false;
    }
   var chkZ = 1;
   for(i=0;i&lt;document.Formular.Alter.value.length;++i)
     if(document.Formular.Alter.value.charAt(i) &lt; &quot;0&quot;
     || document.Formular.Alter.value.charAt(i) &gt; &quot;9&quot;)
       chkZ = -1;
   if(chkZ == -1)
   {
     alert(&quot;Altersangabe keine Zahl!&quot;);
     document.Formular.Alter.focus();
     return false;
    }
  }
  //--&gt;
 &lt;/script&gt;
 &lt;/head&gt;
 &lt;body&gt;
 <a name="a1a1" href="#a1b1"><b>1*</b></a> &lt;form name=&quot;Formular&quot; action=&quot;mailto:du@duda.de&quot;
method=post onSubmit=&quot;return chkFormular()&quot;&gt;
 &lt;pre&gt;
 Name:     &lt;input type=text size=40 name=&quot;User&quot;&gt;
 Wohnort:  &lt;input type=text size=40 name=&quot;Ort&quot;&gt;
 E-Mail:   &lt;input type=text size=40 name=&quot;Mail&quot;&gt;
 Alter:    &lt;input type=text size=40 name=&quot;Alter&quot;&gt;
 Formular: &lt;input type=submit value=&quot;Absenden&quot;&gt;&lt;input type=reset value=&quot;Loeschen&quot;&gt;
 &lt;/pre&gt;
 &lt;/form&gt;
 &lt;/body&gt;
 &lt;/html&gt;
</pre></td></tr></table>


<h3 class="xpl">Erl&auml;uterung:</h3>

<p><img src="xgoup.gif" width=14 height=10 border=0>&nbsp;<a name="a1b1" href="#a1a1"><b>Formular definieren</b></a><br>
Im Beispiel wird ein gew&ouml;hnliches <img src="x1.gif" width=15 height=13 border=0>&nbsp;<a href="tch.htm"><b>HTML-Formular</b></a> mit einigen Eingabefeldern, einem Rest-Button zum Zur&uuml;cksetzen des Formulars und einem Submit-Button zum Absenden des Formulars definiert. Die einzige Besonderheit ist die Anweisung <tt>onSubmit=&quot;return chkFormular()&quot;</tt> im einleitenden <tt>&lt;form&gt;</tt>-Tag. Der <img src="x3.gif" width=15 height=10 border=0>&nbsp;<a href="tebj.htm"><b>Event-Handler</b></a> <tt>onSubmit=</tt> wird aktiv, wenn der Anwender auf den Submit-Button klickt, um das Formular abzusenden. Dann wird die JavaScript-Funktion <tt>chkFormular()</tt> aufgerufen, die im Dateikopf notiert ist. Wenn die Funktion Fehler bei den Eingaben findet, gibt sie den Wert <tt>false</tt> (<i>falsch</i>) zur&uuml;ck, ansonsten den voreingestellten Wert <tt>true</tt> (<i>wahr</i>). Mit <tt>return</tt> wird dieser Wert im einleitenden <tt>&lt;form&gt;</tt>-Tag an den Browser weitergegeben. Der Browser kennt die beiden Werte <tt>true</tt> und <tt>false</tt>. Im Zusammenhang mit <tt>onSubmit=</tt> reagiert er so, da&szlig; er das Formular nur dann abschickt, wenn der Wert <tt>true</tt> ist. Ist der Wert <tt>false</tt>, wird das Absenden der Formulardaten verhindert.</p>





<p><img src="xgoup.gif" width=14 height=10 border=0>&nbsp;<a name="a1b2" href="#a1a2"><b>Formular &uuml;berpr&uuml;fen</b></a><br>
Die eigentliche Formular&uuml;berpr&uuml;fung findet im Beispiel in der Funktion <tt>chkFormular()</tt> statt, die in dem Scriptbereich im Dateikopf notiert ist. Im Beispiel soll jedes Eingabefeld daraufhin &uuml;berpr&uuml;ft werden, ob es einen Inhalt hat, d.h. ob der Anwender es ausgef&uuml;llt hat. Bei der Angabe zur E-Mail-Adresse soll zus&auml;tzlich &uuml;berpr&uuml;ft werden, ob in der Eingabe das Zeichen @ vorkommt. Ist das nicht der Fall, kann man davon ausgehen, da&szlig; der Anwender Unsinn eingegeben hat in dem entsprechenden Feld. Bei der Altersangabe schlie&szlig;lich soll zus&auml;tzlich &uuml;berpr&uuml;ft werden, ob die Eingabe eine positive ganze Zahl ist. Andernfalls mu&szlig; man auch hierbei eine unsinnigen Angabe vermuten.</p>

<p>Mit einer Abfrage wie <tt>if(document.Formular.User.value == &quot;&quot;)</tt> wird ermittelt, ob das entsprechende Formularfeld (im Beispiel also das Feld mit dem Namen <tt>User</tt> im Formular mit dem Namen <tt>Formular</tt>) &uuml;berhaupt einen Inhalt hat. Es wird also auf die leere Zeichenkette <tt>&quot;&quot;</tt> hin gepr&uuml;ft.</p>

<p>Mit einer Abfrage wie <tt>if(document.Formular.Mail.value.indexOf('@') == -1)</tt> wird ermittelt, ob in der Eingabe ein bestimmtes Zeichen fehlt (hier das @-Zeichen, das f&uuml;r E-Mail-Adressen charakteristisch ist).</p>

<p>Mit einem Ausdruck wie:<br>
<tt>for(i=0;i&lt;document.Formular.Alter.value.length;++i)</tt><br>
<tt> if(document.Formular.Alter.value.charAt(i) &lt; &quot;0&quot;</tt><br>
<tt> || document.Formular.Alter.value.charAt(i) &gt; &quot;9&quot;)</tt><br>
ermitteln Sie Zeichen f&uuml;r Zeichen, ob ein eingegebener Wert etwas anderes als Ziffern enth&auml;lt. Wenn ja, wird im Beispiel eine Merkvariable namens <tt>chkZ</tt> auf den Wert <tt>-1</tt> gesetzt.</p>

<p>Bei allen Abfragen dieser Art werden jeweils drei Anweisungen ausgef&uuml;hrt, wenn die Anwendereingaben der Pr&uuml;fung nicht standhalten. Zuerst wird mit <tt>alert()</tt> jeweils in einem Meldungsfenster ausgegeben, was der Anwender falsch gemacht hat. In der zweiten Anweisung wird mit der <tt>focus()</tt>-Methode auf das Formularelement positioniert, auf das sich der Fehler bezieht. Der Anwender kann seine Feldeingabe also gleich korrigieren. Die dritte Anweisung schlie&szlig;lich gibt <tt>false</tt> zur&uuml;ck. Dadurch wird das Absenden des Formulars verhindert.</p>



<table cellpadding=4 cellspacing=1 width=100%>
<tr><td colspan=2 bgcolor=#EEEEEE class="doc">
<a href="#top"><img src="xgoup.gif" width=14 height=10 border=0></a>
</td></tr>
<tr><td bgcolor=#EEEEEE class="doc" align=right width=110>weiter:<a href="tedg.htm"><img src="xgnext.gif" width=10 height=10 border=0 hspace=10></a></td>
<td bgcolor=#ffffff><img src="x3.gif" width=15 height=10 border=0> <a href="tedg.htm"><b>Dynamische grafische Buttons</b></a>
</td></tr>
<tr>
<td bgcolor=#EEEEEE class="doc" align=right width=110>zur&uuml;ck:<a href="tede.htm"><img src="xgprev.gif" width=10 height=10 border=0 hspace=10></a></td>
<td bgcolor=#ffffff width=100%><img src="x3.gif" width=15 height=10 border=0> <a href="tede.htm"><b>Pers&ouml;nliche Seitenbesuche z&auml;hlen mit Cookies</b></a>
</td>
</tr>
<tr><td colspan=2 bgcolor=#EEEEEE class="doc">&#160;</td></tr>
</table>
<hr noshade size=1>
<p><nobr><img src="x2.gif" width=16 height=13 border=0> <a href="selfhtml.htm"><b>SELFHTML</b></a>/<a href="tq.htm" target="_parent">Quickbar</a>&#160;
<img src="x2.gif" width=16 height=13 border=0> <a href="te.htm"><b>JavaScript</b></a>&#160;
<img src="x2.gif" width=16 height=13 border=0> <a href="ted.htm"><b>Anwendungsbeispiele</b></a></nobr></p>
<p><nobr><a class="an" name="bottom">&copy; 1998</A> <img src="xgmail.gif" width=15 height=10 border=0>&nbsp;<a href="mailto:muenz@csi.com">Stefan M&uuml;nz, muenz@csi.com</a></nobr></p>


</body>
</html>