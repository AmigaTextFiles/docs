<html>
<head>
<title>SELFHTML: Dynamisches HTML /  Praxis / Verschiebbare Seitenelemente</title>
<meta name="description" content="(SELFHTML 7.0) Beispiel einer Datei, in der verschiedene Bereiche mit Hilfe von Dynamischem HTML frei im Anzeigefenster verschiebbar sind.">
<meta name="keywords" content="SELFHTML, Dynamisches HTML, Dynamic">
<link rel=stylesheet type="text/css" href="wselfhtm.css">
</head>
<body bgcolor=#ffffff text=#000000 link=#aa5522 vlink=#772200 alink=#000000>


<p><nobr><a class="an" name="top"><img src="x2.gif" width=16 height=13 border=0></a> <a href="selfhtml.htm"><b>SELFHTML</b></a>/<a href="tq.htm" target="_parent">Quickbar</a>&#160;
<img src="x2.gif" width=16 height=13 border=0> <a href="tf.htm"><b>Dynamisches HTML</b></a>&#160;
<img src="x2.gif" width=16 height=13 border=0> <a href="tfc.htm"><b>L&ouml;sungen f&uuml;r die Praxis</b></a></nobr></p>
<hr noshade size=1>
<table cellpadding=4 cellspacing=1 width=100%>
<tr>
<td bgcolor=#EEEEEE class="doc" width=110><img src="xweb.gif" width=106 height=109></td>
<td bgcolor=#EEEEEE class="doc" valign=bottom width=100%><h2>Verschiebbare Seitenelemente</h2></td>
</tr>
<tr>
<td bgcolor=#EEEEEE class="doc" valign=top align=center>
<img src="x5.gif" width=30 height=20 vspace=6 border=0 alt="Diese Seite ist ein Dokument mit Informationstext">
</td>
<td bgcolor=#ffffff valign=top nowrap>

<p>
<img src="xgdown.gif" width=14 height=10 border=0>&nbsp;<a href="#a1"><b>Verschiebbare Seitenelemente - das Beispiel</b></a>
</p>

</td>
</tr><tr><td colspan=2 bgcolor=#EEEEEE class="doc"><a href="#bottom"><img src="xgdown.gif" width=14 height=10 border=0></a>&#160;</td></tr>
</table>



<h2 class="Sh2"><a class="an" name="a1"><img src="xmsie4.gif" width=30 height=30 border=0 alt="MS IE 4.0"><img src="xnetsi4.gif" width=30 height=30 border=0 alt="Netscape4.0"> Verschiebbare Seitenelemente - das Beispiel</a></h2>

<p><img src="xview.gif" width=30 height=20 border=0 alt="Beispiel" align=absmiddle> <a href="tfcba.htm"><b>Anzeigebeispiel: So sieht's aus</b></a></p>

<p>Dieses Beispiel realisiert eine HTML-Datei, in der verschiedene Bereiche f&uuml;r den Anwender mit der Maus frei verschiebbar sind, so wie Fenster in einer grafischen Benutzeroberfl&auml;che. Die Bereiche k&ouml;nnen sich dabei auch beliebig &uuml;berlappen. Der zuletzt angeklickte und zurechtgeschobene Bereich ist automatisch im Vordergrund. Das Beispiel ist so geschrieben, da&szlig; die Funktionalit&auml;t bei Netscape 4.x und MS Internet Explorer 4.x in etwa gleich ist. An diesem Beispiel k&ouml;nnen Sie auch erkennen, da&szlig; der Programmieraufwand f&uuml;r &quot;schicke&quot; Features schnell h&ouml;her werden kann.</p>

<p><b>Hinweis:</b> Zur besseren Orientierung enth&auml;lt das Beispiel Verweise zu den entsprechenden Erl&auml;uterungen, z.B. <a name="a1b1" href="#a1a1"><b>1*</b></a>. Diese Verweise geh&ouml;ren nicht zum Quellcode. Falls Sie das Beispiel in einen Editor kopieren, m&uuml;ssen Sie diese Verweise l&ouml;schen. Andernfalls erhalten Sie JavaScript-Fehlermeldungen.</p>

<h3 class="xmp">Beispiel:</h3>
<table width=100% cellpadding=10><tr><td class="xmpcode" bgcolor=#FFFFE0><pre>
&lt;html&gt;
&lt;head&gt;
&lt;style type=&quot;text/css&quot;&gt;
 layer { padding:10px }
&lt;/style&gt;
<a name="a1a3" href="#a1b3"><b>3*</b></a> &lt;script language=&quot;JScript&quot;&gt;
&lt;!--
var max = 4;
var Merker = 0;
<a name="a1a9" href="#a1b9"><b>9*</b></a> function Merken()
{
 if(window.event.srcElement.id == &quot;div1&quot; &amp;&amp; Merker == 0) Merker = 1;
 else if(window.event.srcElement.id == &quot;div2&quot; &amp;&amp; Merker == 0) Merker = 2;
 else if(window.event.srcElement.id == &quot;div3&quot; &amp;&amp; Merker == 0) Merker = 3;
 else if(Merker &gt; 0) Merker = 0;
}
<a name="a1a10" href="#a1b10"><b>10*</b></a> function Plazieren()
{
 if(window.event.srcElement.id == &quot;div1&quot; &amp;&amp; Merker == 1)
 {
  document.all.div1.style.zIndex = max; max+=1;
  document.all.div1.style.left = window.event.x - 100;
  document.all.div1.style.top = window.event.y - 125;
 }
 if(window.event.srcElement.id == &quot;div2&quot; &amp;&amp; Merker == 2)
 {
  document.all.div2.style.zIndex = max; max+=1;
  document.all.div2.style.left = window.event.x - 150;
  document.all.div2.style.top = window.event.y - 200;
 }
 if(window.event.srcElement.id == &quot;div3&quot; &amp;&amp; Merker == 3)
 {
  document.all.div3.style.zIndex = max; max+=1;
  document.all.div3.style.left = window.event.x - 200;
  document.all.div3.style.top = window.event.y - 90;
 }
}
// --&gt;
&lt;/script&gt;
<a name="a1a7" href="#a1b7"><b>7*</b></a> &lt;script for=&quot;document&quot; Event=&quot;onclick()&quot; language=&quot;JScript&quot;&gt;
 Merken();
&lt;/script&gt;
<a name="a1a8" href="#a1b8"><b>8*</b></a> &lt;script for=&quot;document&quot; Event=&quot;onmousemove()&quot; language=&quot;JScript&quot;&gt;
 Plazieren();
&lt;/script&gt;
&lt;/head&gt;
&lt;body bgcolor=#FFFFFF&gt;

<a name="a1a1" href="#a1b1"><b>1*</b></a> &lt;div id=&quot;div1&quot; style=&quot;position:absolute; top:150px; left:30px;
width:200px; height:250px; background-color:#DDFFDD; color:#006600; 
font-family:Arial; font-size:9pt; font-weight:bold; padding:10px;&quot;&gt;
<a name="a1a2" href="#a1b2"><b>2*</b></a> &lt;layer id=&quot;lay1&quot; width=200 height=250 bgcolor=#DDFFDD&gt;
Hier steht der Inhalt von Bereich 1.
&lt;/layer&gt;
&lt;/div&gt;

&lt;div id=&quot;div2&quot; style=&quot;position:absolute; top:30px; left:300px;
width:300px; height:400px; background-color:#FFDDDD; color:#660000; 
font-family:Arial; font-size:9pt; font-weight:bold; padding:10px;&quot;&gt;
&lt;layer id=&quot;lay2&quot; width=300 height=400 bgcolor=#FFDDDD&gt;
Hier steht der Inhalt von Bereich 2.
&lt;/layer&gt;
&lt;/div&gt;

&lt;div id=&quot;div3&quot; style=position:&quot;absolute; top:180px; left:100px;
width:400px; height:180px; background-color:#DDDDFF; color:#000066; 
font-family:Arial; font-size:9pt; font-weight:bold; padding:10px;&quot;&gt;
&lt;layer id=&quot;lay3&quot; width=400 height=180 bgcolor=#DDDDFF&gt;
Hier steht der Inhalt von Bereich 3.
&lt;/layer&gt;
&lt;/div&gt;


<a name="a1a4" href="#a1b4"><b>4*</b></a> &lt;script language=&quot;JavaScript&quot;&gt;
&lt;!--
var maxlay = 4;
if(document.layers)
{ Gruen = document.layers[0]; Rot = document.layers[1]; Blau = document.layers[2];
   InitGruen(); InitRot(); InitBlau();
}
function InitGruen()
<a name="a1a5" href="#a1b5"><b>5*</b></a> { Gruen.captureEvents(Event.CLICK);
  Gruen.onclick=StartGruen; Gruen.onload=GruenReset; 
}
function InitRot()
{ Rot.captureEvents(Event.CLICK);
  Rot.onclick=StartRot; Rot.onload=RotReset;
}
function InitBlau()
{ Blau.captureEvents(Event.CLICK);
  Blau.onclick=StartBlau; Blau.onload=BlauReset;
}
function StartGruen()
{ Gruen.zIndex = maxlay; maxlay+=1;
  <a name="a1a6" href="#a1b6"><b>6*</b></a> Gruen.captureEvents(Event.MOUSEMOVE|Event.CLICK); 
  Gruen.onmousemove=ZiehGruen; Gruen.onclick=EndGruen;
}
function EndGruen()
{ Gruen.onmousemove=0; Gruen.releaseEvents(Event.MOUSEMOVE); InitGruen(); }
function GruenReset() 
{ Gruen.captureEvents(Event.CLICK|Event.MOUSEMOVE); }
function ZiehGruen(Ereignis)
{ Gruen.left = Ereignis.pageX - 100; Gruen.top = Ereignis.pageY  - 240; }
function StartRot()
{ Rot.zIndex = maxlay; maxlay+=1;
  Rot.captureEvents(Event.MOUSEMOVE|Event.CLICK); 
  Rot.onmousemove=ZiehRot; Rot.onclick=EndRot;
}
function EndRot()
{ Rot.onmousemove=0; Rot.releaseEvents(Event.MOUSEMOVE); ; InitRot(); }
function RotReset() 
{ Rot.captureEvents(Event.CLICK|Event.MOUSEMOVE); }
function ZiehRot(Ereignis)
{ Rot.left = Ereignis.pageX - 150; Rot.top = Ereignis.pageY - 390; }
function StartBlau()
{ Blau.zIndex = maxlay; maxlay+=1;
  Blau.captureEvents(Event.MOUSEMOVE|Event.CLICK); 
  Blau.onmousemove=ZiehBlau; Blau.onclick=EndBlau;
}
function EndBlau()
{ Blau.onmousemove=0; Blau.releaseEvents(Event.MOUSEMOVE); ; InitBlau(); }
function BlauReset() 
{ Blau.captureEvents(Event.CLICK|Event.MOUSEMOVE); }
function ZiehBlau(Ereignis)
{ Blau.left = Ereignis.pageX - 200; Blau.top = Ereignis.pageY - 170; }
// --&gt;
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre></td></tr></table>

<h3 class="xpl">Erl&auml;uterung:</h3>

<p>Etwa in der Mitte des obigen Beispiels, unterhalb des &ouml;ffnenden <tt>&lt;body&gt;</tt>-Tags, werden insgesamt drei Bereiche definiert (<a name="a1b1" href="#a1a1"><b>1*</b></a>). Alle drei Bereiche werden zun&auml;chst als <tt>&lt;div&gt;</tt>-Bereiche definiert. Die drei Bereiche erhalten die id-Namen <tt>&quot;div1&quot;</tt>, <tt>&quot;div2&quot;</tt> und <tt>&quot;div3&quot;</tt>. Mit Hilfe von Style-Sheet-Angaben zur Positionierung werden die Bereiche im Anzeigefenster genau plaziert. Die Bereiche &uuml;berlappen sich dabei. Da keine spezielle Schichtreihenfolge festgelegt wird, liegt der zuletzt definierte Bereich zun&auml;chst &uuml;ber den beiden anderen Bereichen. Es handelt sich bei dieser Anordnung jedoch nur um den Ausgangszustand, den der Anwender sp&auml;ter &auml;ndern kann.</p>

<p>Innerhalb der drei <tt>&lt;div&gt;</tt>-Bereiche finden Sie im obigen Beispiel jeweils drei entsprechende <tt>&lt;layer&gt;</tt>-Bereiche (<a name="a1b2" href="#a1a2"><b>2*</b></a>). Diese Form der Verschachtelung hat sich als praktikabel erwiesen. Denn der MS Internet Explorer ignoriert das <tt>&lt;layer&gt;</tt>-Tag, interpretiert jedoch den Inhalt, der zwischen <tt>&lt;layer&gt;</tt> und <tt>&lt;/layer&gt;</tt> steht. Netscape dagegen interpretiert zwar zuerst das <tt>&lt;div&gt;</tt>-Tag, freut sich dann aber &uuml;ber das innere <tt>&lt;layer&gt;</tt>-Tag, mit dem er bei Dynamischem HTML letztlich doch besser klar kommt. Die <tt>&lt;layer&gt;</tt>-Bereiche im Beispiel haben keine Angaben zu den Werten <tt>left=</tt> und <tt>top=</tt>. Dadurch beginnen sie einfach links oben innerhalb der &uuml;bergeordneten <tt>&lt;div&gt;</tt>-Bereiche.</p>

<p>Das gesamte Handling zum Verschieben der Bereiche f&uuml;r den Fall, da&szlig; der Anwender mit der Maus darauf klickt und anschlie&szlig;end die Maus bewegt, ist in dem Beispiel in zwei Script-Bereichen untergebracht. Beide Script-Bereiche sind streng voneinander getrennt. Einer der beiden Bereiche steht im Dateikopf - das ist der Scriptbereich f&uuml;r den MS-Internet Explorer (<a name="a1b3" href="#a1a3"><b>3*</b></a>). Dieser Script-Bereich ist mit der Angabe <tt>language=&quot;JScript&quot;</tt> ausgezeichnet. Dadurch wird erreicht, da&szlig; Netscape diesen Bereich komplett ignoriert. Der andere Script-Bereich ist unterhalb der drei <tt>&lt;div&gt;</tt>-Bereiche notiert  (<a name="a1b4" href="#a1a4"><b>4*</b></a>). Dieser Script-Bereich ist mit <tt>language=&quot;JavaScript&quot;</tt> ausgezeichnet, wird also von Netscape und vom MS Internet Explorer wahrgenommen. Da der MS Internet Explorer in diesem Bereich allerdings nichts zu suchen hat, werden die Anweisungen, die gleich am Anfang des Script-Bereichs au&szlig;erhalb jeder Funktion stehen, durch die Abfrage <tt>if(document.layers)</tt> nur Netscape zug&auml;nglich gemacht.<br>
Das strenge Trennen der Script-Bereiche in diesem Beispiel macht insofern Sinn, als das Behandeln von Ereignissen wie Mausaktionen des Anwenders in Netscape und im MS Internet Explorer so unterschiedlich gel&ouml;st sind, da&szlig; es schwierig w&auml;re, mit Hilfe einzelner if-Abfragen innerhalb der gleichen Code-Bereiche zu arbeiten.</p>

<p>Das Handling f&uuml;r Netscape entspricht in etwa dem, das im Beispiel zum <img src="x3.gif" width=15 height=10 border=0>&nbsp;<a href="tfbe.htm#a8"><b>Event-Objekt bei Netscape</b></a> genauer beschrieben wird. Mit <tt>captureEvents(Event.CLICK)</tt> werden alle drei <tt>&lt;layer&gt;</tt>-Bereiche initialisiert (<a name="a1b5" href="#a1a5"><b>5*</b></a> ). Das CLICK-Ereignis wird also f&uuml;r die drei Bereiche &uuml;berwacht. Wenn es eintritt, also wenn der Anwender mit der Maus auf einen der Bereiche klickt, wird f&uuml;r den betreffenden Bereich eine Funktion aufgerufen. Wenn beispielsweise der gr&uuml;ne Bereich angeklickt wird, wird die Funktion <tt>StartGruen</tt> aufgerufen. Diese &quot;Start&quot;-Funktionen &uuml;berwachen mit <tt>captureEvents(Event.MOUSEMOVE)</tt> das Ereignis &quot;Anwender bewegt Maus&quot;, und mit <tt>captureEvents(Event.CLICK)</tt> das Ereignis &quot;Anwender klickt erneut auf den Bereich&quot; (<a name="a1b6" href="#a16"><b>6*</b></a>). Beim Bewegen der Maus wird der Bereich verschoben, beim erneuten Klicken wird der Bereich an der aktuellen Stelle gelassen. Dazu werden zum Bewegen Funktionen wie <tt>ZiehGruen</tt> und zum beendenden Klicken Funktionen wie <tt>EndGruen</tt> aufgerufen. Am Ende so einer Funktion, etwa am Ende der Funktion <tt>EndGruen</tt>, wird wieder die Initialisierung aufgerufen. Dadurch wird wieder &uuml;ber einen neuen Verschiebewunsch des Anwenders gewacht.</p>

<p>Zum Handling f&uuml;r den MS Internet Explorer kommt das <img src="x3.gif" width=15 height=10 border=0>&nbsp;<a href="tfba.htm#a5"><b>Event-Objekt bei Microsoft</b></a> zum Einsatz. Dazu werden im Dateikopf des Beispiels zwei spezielle Scriptbereiche definiert (<a name="a1b7" href="#a1a7"><b>7*</b></a> und <a name="a1b8" href="#a1a8"><b>8*</b></a>). Diese Scripts mit ihrer speziellen Syntax &uuml;berwachen dokument&uuml;bergreifend die beiden Anwenderaktionen &quot;Mausklick&quot; - <tt>onclick()</tt> - und &quot;Mausbewegung&quot; - <tt>onmousemove()</tt>. Wenn der Anwender mit der Maus ins Anzeigefenster klickt, wird die Funktion <tt>Merken()</tt> aufgerufen (<a name="a1b9" href="#a1a9"><b>9*</b></a>). Diese Funktion verwaltet eine global definierte Variable namens <tt>Merker</tt>. Wenn der Merker den Wert 0 hat, wird der Mausklick als Anfangsklick interpretiert, dem ein Bewegen des Bereichs folgen kann. Wenn der Merker einen h&ouml;heren Wert hat als 0, wird der Klick als Endklick interpretiert. Danach ist kein Bewegen des Bereichs m&ouml;glich.<br>
Wenn die Maus bewegt wird, wird die Funktion <tt>Plazieren()</tt> aufgerufen (<a name="a1b10" href="#a1a10"><b>10*</b></a>). Ist der Merker gr&ouml;&szlig;er als 0, wird sein Wert ausgelesen und der entsprechende Bereich neu positioniert.</p>

<p>Erw&auml;hnt werden sollte noch, wie das Positionieren eines der verschiebbaren Bereiche beim Bewegen der Maus programmiert ist. Das Bewegen der Bereiche wird durch Zuordnen der aktuellen Position des Bereichs zur aktuellen Position der Maus realisiert. Beim MS Internet Explorer geschieht dies innerhalb der Funktion <tt>Plazieren()</tt>, beispielsweise mit folgenden Anweisungen:<br>
<tt>document.all.div1.style.left = window.event.x - 100;</tt><br>
<tt>document.all.div1.style.top = window.event.y - 125;</tt><br>
Bei Netscape geschieht die vergleichbare Zuordnung innerhalb der <tt>Zieh*</tt>-Funktionen, etwa innerhalb der Funktion <tt>ZiehGruen</tt>, und zwar durch Anweisungen wie:<br>
<tt>Gruen.left = Ereignis.pageX - 100;</tt><br>
<tt>Gruen.top = Ereignis.pageY  - 240;</tt><br>
Abgesehen von der unterschiedlichen Syntax f&auml;llt auf, da&szlig; die Angaben f&uuml;r den Wert der neuen oberen linken Ecke &quot;von links&quot; nicht in beiden F&auml;llen gleich ist. Der y-Wert ist im einen Fall 125, im anderen 240. Die x-Werte sind dagegen in beiden F&auml;llen mit 100 angegeben. Die 100 bedeutet: 100 Pixel links (&quot;minus&quot;) von der aktuellen Mausposition. Da der gr&uuml;ne Bereich, um den es dabei geht, eine Breite von 200 Pixeln hat, bleibt die Maus beim Bewegen dadurch immer horizontal in der Mitte des Bereichs. Analog dazu ist es beim MS Internet Explorer auch f&uuml;r den vertikalen Wert. Der Wert der neuen oberen linken Ecke &quot;von oben&quot; liegt 125 Pixel oberhalb der aktuellen Mausposition. Da der Bereich 250 Pixel hoch ist, ist das also auch hier genau die Mitte. Leider w&uuml;rde der gleiche Wert bei Netscape Probleme aufwerfen, sobald der Layer an der Stelle, an der sich die Maus befindet, irgendwelche Inhalte hat, also Text, Grafiken usw. Deshalb wurde bei Netscape als Wert f&uuml;r &quot;von oben&quot; 240 gew&auml;hlt. Bei der Bereichsh&ouml;he von 250 Pixeln bleibt die Maus w&auml;hrend des Bewegens also ziemlich weit unten im Bereich, dort, wo keine Inhalte mehr stehen.</p>



<table cellpadding=4 cellspacing=1 width=100%>
<tr><td colspan=2 bgcolor=#EEEEEE class="doc">
<a href="#top"><img src="xgoup.gif" width=14 height=10 border=0></a>
</td></tr>
<tr><td bgcolor=#EEEEEE class="doc" align=right width=110>weiter:<a href="tfcc.htm"><img src="xgnext.gif" width=10 height=10 border=0 hspace=10></a></td>
<td bgcolor=#ffffff><img src="x3.gif" width=15 height=10 border=0> <a href="tfcc.htm"><b>Bilderbuch zum Umbl&auml;ttern</b></a>
</td></tr>
<tr>
<td bgcolor=#EEEEEE class="doc" align=right width=110>zur&uuml;ck:<a href="tfca.htm"><img src="xgprev.gif" width=10 height=10 border=0 hspace=10></a></td>
<td bgcolor=#ffffff width=100%><img src="x3.gif" width=15 height=10 border=0> <a href="tfca.htm"><b>Datums-/Uhrzeitanzeige</b></a>
</td>
</tr>
<tr><td colspan=2 bgcolor=#EEEEEE class="doc">&#160;</td></tr>
</table>
<hr noshade size=1>
<p><nobr><img src="x2.gif" width=16 height=13 border=0> <a href="selfhtml.htm"><b>SELFHTML</b></a>/<a href="tq.htm" target="_parent">Quickbar</a>&#160;
<img src="x2.gif" width=16 height=13 border=0> <a href="tf.htm"><b>Dynamisches HTML</b></a>&#160;
<img src="x2.gif" width=16 height=13 border=0> <a href="tfc.htm"><b>L&ouml;sungen f&uuml;r die Praxis</b></a></nobr></p>
<p><nobr><a class="an" name="bottom">&copy; 1998</A> <img src="xgmail.gif" width=15 height=10 border=0>&nbsp;<a href="mailto:muenz@csi.com">Stefan M&uuml;nz, muenz@csi.com</a></nobr></p>


</body>
</html>