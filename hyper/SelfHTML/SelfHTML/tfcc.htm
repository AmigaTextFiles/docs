<html>
<head>
<title>SELFHTML: Dynamisches HTML /  Praxis / Bilderbuch zum Umbl&auml;ttern</title>
<meta name="description" content="(SELFHTML 7.0) Beispiel zum dynamischen Umbl&auml;ttern von angezeigten Grafiken. Mit Dynamischem HTML, das sowohl mit MS Internet Explorer als auch mit Netscape funktioniert.">
<meta name="keywords" content="SELFHTML, Dynamisches HTML, Dynamic">
<link rel=stylesheet type="text/css" href="wselfhtm.css">
</head>
<body bgcolor=#ffffff text=#000000 link=#aa5522 vlink=#772200 alink=#000000>


<p><nobr><a class="an" name="top"><img src="x2.gif" width=16 height=13 border=0></a> <a href="selfhtml.htm"><b>SELFHTML</b></a>/<a href="tq.htm" target="_parent">Quickbar</a>&#160;
<img src="x2.gif" width=16 height=13 border=0> <a href="tf.htm"><b>Dynamisches HTML</b></a>&#160;
<img src="x2.gif" width=16 height=13 border=0> <a href="tfc.htm"><b>L&ouml;sungen f&uuml;r die Praxis</b></a></nobr></p>
<hr noshade size=1>
<table cellpadding=4 cellspacing=1 width=100%>
<tr>
<td bgcolor=#EEEEEE class="doc" width=110><img src="xweb.gif" width=106 height=109></td>
<td bgcolor=#EEEEEE class="doc" valign=bottom width=100%><h2>Bilderbuch zum Umbl&auml;ttern</h2></td>
</tr>
<tr>
<td bgcolor=#EEEEEE class="doc" valign=top align=center>
<img src="x5.gif" width=30 height=20 vspace=6 border=0 alt="Diese Seite ist ein Dokument mit Informationstext">
</td>
<td bgcolor=#ffffff valign=top nowrap>

<p>
<img src="xgdown.gif" width=14 height=10 border=0>&nbsp;<a href="#a1"><b>Bilderbuch zum Umbl&auml;ttern - das Beispiel</b></a>
</p>

</td>
</tr><tr><td colspan=2 bgcolor=#EEEEEE class="doc"><a href="#bottom"><img src="xgdown.gif" width=14 height=10 border=0></a>&#160;</td></tr>
</table>



<h2 class="Sh2"><a class="an" name="a1"><img src="xmsie4.gif" width=30 height=30 border=0 alt="MS IE 4.0"><img src="xnetsi4.gif" width=30 height=30 border=0 alt="Netscape4.0"> Bilderbuch zum Umbl&auml;ttern - das Beispiel</a></h2>

<p><img src="xview.gif" width=30 height=20 border=0 alt="Beispiel" align=absmiddle> <a href="tfcca.htm"><b>Anzeigebeispiel: So sieht's aus</b></a></p>

<p>In diesem Beispiel werden dynamisch mehrere Grafiken geladen, jedoch immer nur eine angezeigt. Mit Hilfe von Bl&auml;tterverweisen kann der Anwender vorw&auml;rts und r&uuml;ckw&auml;rts bl&auml;ttern, um die n&auml;chste Grafik an der gleichen Stelle wie die alte anzuzeigen. Dabei wird die neue Grafik von links her &quot;aufgerollt&quot;. Solche Effekte sind zwar f&uuml;r den MS Internet Explorer 4.x viel effizienter durch &Uuml;berblend-Effekte mit dem revealTrans-Filter machbar, doch dieses Beispiel hier funktioniert daf&uuml;r mit Netscape 4.x genau so.</p>

<p><b>Hinweis:</b> Zur besseren Orientierung enth&auml;lt das Beispiel Verweise zu den entsprechenden Erl&auml;uterungen, z.B. <a name="a1b1" href="#a1a1"><b>1*</b></a>. Diese Verweise geh&ouml;ren nicht zum Quellcode. Falls Sie das Beispiel in einen Editor kopieren, m&uuml;ssen Sie diese Verweise l&ouml;schen. Andernfalls erhalten Sie JavaScript-Fehlermeldungen.</p>

<h3 class="xmp">Beispiel:</h3>
<table width=100% cellpadding=10><tr><td class="xmpcode" bgcolor=#FFFFE0><pre>
&lt;html&gt;
&lt;head&gt;
<a name="a1a1" href="#a1b1"><b>1*</b></a> &lt;script language=&quot;JavaScript&quot;&gt;
&lt;!--
var Bild = new Array(7);
Bild[0] = new Image(); Bild[0].src=&quot;sonne.gif&quot;;
Bild[1] = new Image(); Bild[1].src=&quot;mond.gif&quot;;
Bild[2] = new Image(); Bild[2].src=&quot;sterne.gif&quot;;
Bild[3] = new Image(); Bild[3].src=&quot;feuer.gif&quot;;
Bild[4] = new Image(); Bild[4].src=&quot;wasser.gif&quot;;
Bild[5] = new Image(); Bild[5].src=&quot;luft.gif&quot;;
Bild[6] = new Image(); Bild[6].src=&quot;erde.gif&quot;;
var zeige = 0;
var aktuelleBreite = 0;
var Breite = 289; 
var Geschwindigkeit = 20;

<a name="a1a6" href="#a1b6"><b>6*</b></a> function Blaettern(Richtung)
{
 zeige = zeige + Richtung;
 if(zeige &gt; Bild.length - 1) zeige = 0;
 else if(zeige &lt; 0) zeige = Bild.length - 1;
 if(document.all)
 {
   document.all.Bildbereich.style.clip = &quot;rect(0 0 302 0)&quot;;
   document.all.Bildbereich.innerHTML =
   &quot;&lt;layer width=289 height=302&gt;&lt;img src=\&quot;&quot; + Bild[zeige].src + &quot;\&quot;&gt;&lt;/layer&gt;&quot;;
 }  
 else if(document.layers)
 {
  document.layers[0].visibility = &quot;hide&quot;;
  document.layers[0].document.open();
  document.layers[0].document.write(&quot;&lt;img src=\&quot;&quot; + Bild[zeige].src + &quot;\&quot;&gt;&quot;);
  document.layers[0].document.close(); 
  document.layers[0].clip.right = 0;
  document.layers[0].visibility = &quot;show&quot;;
 }  
 BildAufbauen();
}

<a name="a1a7" href="#a1b7"><b>7*</b></a> function BildAufbauen()
{
 if(aktuelleBreite &lt;= Breite) 
 {
  if(document.all)
    document.all.Bildbereich.style.clip=&quot;rect(0 &quot;+ aktuelleBreite + &quot; 302 0)&quot;;
  else if(document.layers)
    document.layers[0].clip.right = aktuelleBreite;	
  aktuelleBreite = aktuelleBreite + Geschwindigkeit;	
  window.setTimeout(&quot;BildAufbauen()&quot;,0);
 }
 else
 {
  aktuelleBreite = 0;
  if(document.all)
    document.all.Bildbereich.style.clip=&quot;rect(0 &quot; + Breite + &quot; 302 0)&quot;;
  else if(document.layers)
    document.layers[0].clip.right = Breite;	
 }
}
<a name="a1a4" href="#a1b4"><b>4*</b></a> function Init()
{
 if(document.all)
  document.all.Bildbereich.innerHTML =
  &quot;&lt;layer width=289 height=302&gt;&lt;img src=\&quot;&quot; + Bild[0].src + &quot;\&quot;&gt;&lt;/layer&gt;&quot;;
 else if(document.layers)
 {
  document.layers[0].document.open();
  document.layers[0].document.write(&quot;&lt;img src=\&quot;&quot; + Bild[0].src + &quot;\&quot;&gt;&quot;);
  document.layers[0].document.close();
 } 
}
// --&gt;
&lt;/script&gt;
&lt;/head&gt;
<a name="a1a3" href="#a1b3"><b>3*</b></a> &lt;body bgcolor=#FFFFFF onLoad=&quot;Init()&quot;&gt;

<a name="a1a2" href="#a1b2"><b>2*</b></a> &lt;div id=&quot;Bildbereich&quot; style=&quot;position:absolute; left:10px; top:140px;
padding:0px; clip:rect(0 289 302 0); visibility:show;&quot;&gt;
&lt;layer width=289 height=302&gt;&lt;/layer&gt;&lt;/div&gt;

<a name="a1a5" href="#a1b5"><b>5*</b></a> &lt;div style=&quot;position:absolute; left:320; top:140; width:100; font-size:18pt;&quot; width=100&gt;
[&lt;a href=&quot;javascript:Blaettern(-1)&quot;&gt;&amp;lt;&amp;lt;&lt;/a&gt;]
[&lt;a href=&quot;javascript:Blaettern(1)&quot;&gt;&amp;gt;&amp;gt;&lt;/a&gt;]
&lt;/div&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre></td></tr></table>

<h3 class="xpl">Erl&auml;uterung:</h3>

<p>Damit das Beispiel des Bilderbuches zum Umbl&auml;ttern sauber funktioniert, m&uuml;ssen beim Einlesen der HTML-Datei erst auch alle Grafiken eingelesen werden, die im Verlauf des Umbl&auml;tterns angezeigt werden sollen. Denn nur wenn die Grafiken zu diesem Zeitpunkt bereits im Arbeitsspeicher sind, gibt es keine Synchronisationsprobleme.<br>
Das Einlesen der betroffenen Grafiken geschieht in dem JavaScript-Bereich, der im Beispiel im Dateikopf notiert ist (<a name="a1b1" href="#a1b1"><b>1*</b></a>). Zuerst wird ein neuer Array angelegt, bestehend aus so vielen Elementen, wie das Bilderbuch an Bildern zeigen soll. Im obigen Beispiel gibt es dann 7 Variablen <tt>Bild</tt>, ansprechbar mit <tt>Bild[0]</tt> bis <tt>Bild[6]</tt>. Diese Variablen sind zun&auml;chst abstrakt, man kann darin speichern was man will. Im Beispiel wird in jeder der Variablen ein neues Bildobjekt gespeichert. Dem jeweiligen <tt>Image</tt>-Objekt, das zu diesem Zweck erzeugt wird, wird &uuml;ber die <tt>src</tt>-Eigenschaft eine gew&uuml;nschte Grafikdatei zugewiesen.</p>

<p>Anschlie&szlig;end werden noch ein paar globale Variablen definiert, die sp&auml;ter ben&ouml;tigt werden.</p>

<p>Im K&ouml;rper der HTML-Datei des Beispiels werden zwei <tt>&lt;div&gt;</tt>-Bereiche definiert (<a name="a1b2" href="#a1a2"><b>2*</b></a>). Der erste <tt>&lt;div&gt;</tt>-Bereich ist zum Anzeigen der aktuellen Grafik gedacht. Der zweite Bereich enth&auml;lt Verweise, mit deren Hilfe der Anwender vorw&auml;rts und r&uuml;ckw&auml;rts zwischen den Grafiken bl&auml;ttern kann. Beide <tt>&lt;div&gt;</tt>-Bereiche werden mit Hilfe entsprechender Style-Sheet-Angaben absolut positioniert.</p>

<p>Der erste <tt>&lt;div&gt;</tt>-Bereich enth&auml;lt als Inhalt einen <tt>&lt;layer&gt;</tt>-Bereich. Der ist speziell f&uuml;r Netscape gedacht. Diese Form der Verschachtelung hat sich als praktikabel erwiesen. Denn der MS Internet Explorer ignoriert das <tt>&lt;layer&gt;</tt>-Tag. Netscape dagegen interpretiert zwar zuerst das <tt>&lt;div&gt;</tt>-Tag, freut sich dann aber &uuml;ber das innere <tt>&lt;layer&gt;</tt>-Tag, mit dem er bei Dynamischem HTML letztlich doch besser klar kommt.</p>

<p>Innerhalb des Anzeigebereichs f&uuml;r die Grafiken wird zun&auml;chst gar nichts angezeigt. Das Laden der ersten Grafik erfolgt bereits dynamisch mit Hilfe von JavaScript. Der Anfangsbefehl dazu steht im einleitenden <tt>&lt;body&gt;</tt>-Tag. Dort wird mit Hilfe des Event-Handlers <tt>onLoad</tt> die Funktion <tt>Init()</tt> aufgerufen (<a name="a1b3" href="#a1a3"><b>3*</b></a>). Die Funktion <tt>Init()</tt> zeigt die erste Grafik innerhalb des vorgesehenen Anzeigebereichs an (<a name="a1b4" href="#a1a4"><b>4*</b></a>). Dabei wird wie &uuml;blich durch die Abfragen nach dem verf&uuml;gbaren Objekt (MS Internet Exlorer: <tt>document.all</tt>, Netscape: <tt>document.layers</tt>) ermittelt, auf welche Weise das dynamische Einf&uuml;gen geschehen soll. F&uuml;r den MS Internet Explorer wird einfach mit der Eigenschaft <tt>innerHTML</tt> des Objekts mit dem Namen <tt>Bildbereich</tt> dynamisch der HTML-Code zum Einbinden der ersten Grafik geschrieben. Dabei mu&szlig; allerdings auch wieder das <tt>&lt;layer&gt;</tt>-Tag mit geschrieben werden, sonst ginge dieses verloren. Bei Netscape wird der Layer, der f&uuml;r Netscape ein Dokument im Dokument darstellt, mit Hilfe von <tt>dcoument.write()</tt> Inhalt gef&uuml;llt. Wichtig ist es, dabei zuerst <tt>dcoument.open()</tt> und abschlie&szlig;end <tt>document.close()</tt> aufzurufen, sonst funktioniert das Ganze nicht.</p>

<p>Das Bl&auml;ttern zwischen einzelnen Grafiken wird durch die beiden Verweise im zweiten <tt>&lt;div&gt;</tt>-Bereich angesto&szlig;en. Beide Verweise rufen die gleiche Funktion namens <tt>Blaettern()</tt> auf (<a name="a1b5" href="#a1a5"><b>5*</b></a>), jedoch mit unterschiedlicher Parameter&uuml;bergabe. Der Vorw&auml;rtsverweis &uuml;bergibt <tt>1</tt>, der R&uuml;ckw&auml;rtsverweis <tt>-1</tt>. Dadurch kann die Funktion <tt>Blaettern()</tt> diesen Parameter gleich zur Verwaltung benutzen.</p>

<p>Die Funktion <tt>Blaettern()</tt> fragt zun&auml;chst ab, ob entweder das erste oder das letzte Bild der Serie erreicht ist und legt im entsprechenden Fall wieder das letzte bzw. erste Bild als das anzuzeigende fest (<a name="a1b6" href="#a1a6"><b>6*</b></a>). So entsteht ein Endlos-Effekt f&uuml;r den Anwender beim Bl&auml;ttern. Anschlie&szlig;end wird - ganz &auml;hnlich wie in der Funktion <tt>Init()</tt> und  wieder &uuml;ber die Abfrage nach der Verf&uuml;gbarkeit von <tt>document.all</tt> oder <tt>document.layers</tt> - der Inhalt des Anzeigebereichs f&uuml;r das Bild neu geschrieben, und zwar mit dem neuen Bild. Dabei wird jedoch am Ende die Funktion <tt>BildAufbauen()</tt> aufgerufen.</p>

<p>Die Funktion <tt>BildAufbauen()</tt> ist f&uuml;r den dynamischen Aufroll-Effekt beim Anzeigen der neuen Grafik zust&auml;ndig (<a name="a1b7" href="#a1a7"><b>7*</b></a>). Dazu wird von der Eigenschaft <tt>clip</tt> Gebrauch gemacht. Jedoch abh&auml;ngig vom Browser. Beim MS Internet Explorer (<tt>document.all</tt>-Zweig) wird die Style-Sheet-Angabe zu <tt>clip</tt> dynamisch neu geschrieben, und zwar so, da&szlig; die Variable <tt>aktuelleBreite</tt>, die laufend um den Wert der globalen Variablen <tt>Geschwindigkeit</tt> erh&ouml;ht wird, das Aufrollen nach rechts bewirkt. F&uuml;r Netscape (<tt>document.layers</tt>-Zweig) wird einfach die Eigenschaft <tt>clip.right</tt> des betroffenen Layer-Objekts dynamisch um den Wert von <tt>aktuelleBreite</tt> ver&auml;ndert.<br>
Nach Durchlaufen der Wertver&auml;nderung des rechten Clip-Rands ruft sich die Funktion <tt>BildAufbauen()</tt> selbst wieder auf, und zwar innerhalb von <tt>window.setTimeout()</tt>, um einen Rekursionsfehler zu vermeiden.<br>
Am Ende, wenn die oberste if-Bedingung der Funktion <tt>Blaettern()</tt> erf&uuml;llt ist, n&auml;mlich da&szlig; die aktuelle Breite gr&ouml;&szlig;er als die Anzeigebreite der Grafik ist, gelangt die Funktion in den else-Zweig. Dort wird der clip-Wert f&uuml;r rechts auf den Endwert gesetzt, und die Prozedur des Umbl&auml;tterns ist abgeschlossen.</p>




<table cellpadding=4 cellspacing=1 width=100%>
<tr><td colspan=2 bgcolor=#EEEEEE class="doc">
<a href="#top"><img src="xgoup.gif" width=14 height=10 border=0></a>
</td></tr>
<tr><td bgcolor=#EEEEEE class="doc" align=right width=110>weiter:<a href="tga.htm"><img src="xgnext.gif" width=10 height=10 border=0 hspace=10></a></td>
<td bgcolor=#ffffff><img src="x3.gif" width=15 height=10 border=0> <a href="tga.htm"><b>CGI und HTML</b></a>
</td></tr>
<tr>
<td bgcolor=#EEEEEE class="doc" align=right width=110>zur&uuml;ck:<a href="tfcb.htm"><img src="xgprev.gif" width=10 height=10 border=0 hspace=10></a></td>
<td bgcolor=#ffffff width=100%><img src="x3.gif" width=15 height=10 border=0> <a href="tfcb.htm"><b>Verschiebbare Seitenelemente</b></a>
</td>
</tr>
<tr><td colspan=2 bgcolor=#EEEEEE class="doc">&#160;</td></tr>
</table>
<hr noshade size=1>
<p><nobr><img src="x2.gif" width=16 height=13 border=0> <a href="selfhtml.htm"><b>SELFHTML</b></a>/<a href="tq.htm" target="_parent">Quickbar</a>&#160;
<img src="x2.gif" width=16 height=13 border=0> <a href="tf.htm"><b>Dynamisches HTML</b></a>&#160;
<img src="x2.gif" width=16 height=13 border=0> <a href="tfc.htm"><b>L&ouml;sungen f&uuml;r die Praxis</b></a></nobr></p>
<p><nobr><a class="an" name="bottom">&copy; 1998</A> <img src="xgmail.gif" width=15 height=10 border=0>&nbsp;<a href="mailto:muenz@csi.com">Stefan M&uuml;nz, muenz@csi.com</a></nobr></p>


</body>
</html>