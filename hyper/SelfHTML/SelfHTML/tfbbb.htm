<html>
<head>
<title>SELFHTML: Dynamisches HTML / Ans&auml;tze / Datenanbindung (Microsoft) / Beispiel: Daten durchsuchbar machen</title>
<link rel=stylesheet type="text/css" href="wselfhtm.css"> 

<script language="JScript">
function Suchen()
{
 var Datensaetze = 1000;
 document.all.Anzeigetabelle.style.display = "none"; 
 var Suchausdruck = "";
 var Suchbegriffe = 0;
 if(document.Eingabe.SuchDeu.value != "")
  {
   Suchausdruck = Suchausdruck + "Deutsch = " + document.Eingabe.SuchDeu.value;
   Suchbegriffe++;
  } 
 if(document.Eingabe.SuchEng.value != "")
  {
   if(Suchbegriffe > 0)
     Suchausdruck = Suchausdruck + " & Englisch = " + document.Eingabe.SuchEng.value;
   else 
     Suchausdruck = Suchausdruck + "Englisch = " + document.Eingabe.SuchEng.value;
   Suchbegriffe++;
  }
 if(document.Eingabe.SuchFra.value != "")
  {
   if(Suchbegriffe > 0)
     Suchausdruck = Suchausdruck + " & Franzoesisch = " + document.Eingabe.SuchFra.value;
   else 
     Suchausdruck = Suchausdruck + "Franzoesisch = " + document.Eingabe.SuchFra.value;
   Suchbegriffe++;
  }
 if(document.Eingabe.SuchIta.value != "")
  {
   if(Suchbegriffe > 0)
     Suchausdruck = Suchausdruck + " & Italienisch = " + document.Eingabe.SuchIta.value;
   else 
     Suchausdruck = Suchausdruck + "Italienisch = " + document.Eingabe.SuchIta.value;
   Suchbegriffe++;
  }
 if(document.Eingabe.SuchSpa.value != "")
  {
   if(Suchbegriffe > 0)
     Suchausdruck = Suchausdruck + " & Spanisch = " + document.Eingabe.SuchSpa.value;
   else 
     Suchausdruck = Suchausdruck + "Spanisch = " + document.Eingabe.SuchSpa.value;
   Suchbegriffe++;
  }
 document.all.Begriffe.object.Filter = Suchausdruck;
 document.all.Begriffe.Reset();
 document.all.Anzeigetabelle.dataSrc = "#Begriffe";
 if(document.all.Begriffe.recordset.recordCount < Datensaetze)
  {
   document.all.Anzeigetabelle.dataPageSize = Begriffe.recordset.recordCount;
   document.all.Treffer.innerText = Begriffe.recordset.recordCount + " Suchtreffer!";
   document.all.Anzeigetabelle.style.display = "block"; 
  } 
 else 
   document.all.Treffer.innerText = "0 Suchtreffer!";
}
</script>
</head>
<body bgcolor=#ffffff text=#000000 link=#aa5522 vlink=#772200 alink=#000000>


<h2><img src="xmsie4.gif" width=30 height=30 border=0 alt="MS IE4.0"> Beispiel: Daten durchsuchbar machen</h2>

<p><img src="xshow.gif" width=33 height=14 border=0 alt="Beschreibung"><br>
<a href="tfbb.htm#a3"><b>Beschreibung: so wird's gemacht</b></a></p>

<object id="Begriffe" classid="clsid:333C7BC4-460F-11D0-BC04-0080C7055A83">
 <param name="DataURL" value="wtfbba.txt">
 <param name="UseHeader" value="true">
 <param name="Filter" value="">
 <param name="FieldDelim" value=";">
</object>

<p>Die durchsuchbare Datenbank enth&auml;lt 1000 Eintr&auml;ge. Suchen Sie nach Begriffen in einer oder mehreren Sprachen. Bei der Suche in mehreren Sprachen werden die Eingaben lgisch durch UND verkn&uuml;pft. Sie d&uuml;rfen auch das Wildcardzeichen * f&uuml;r Teilausdr&uuml;cke verwenden. Suchen Sie z.B. mal im Feld (Deutsch) nach <B>Arbeits*</B> oder im Feld (Italienisch) nach <B>*ore</B> oder im Feld (Englisch) nach <B>*computer</B>. Um das Beispiel besser zu verstehen, werfen Sie ruhig mal einen Blick auf die <img src="x3.gif" width=15 height=10 border=0>&nbsp;<a href="wtfbba.txt"><b>externe Datendatei</b></a>.</p>

<form name="Eingabe">
Suche nach:<br>
<input name="SuchDeu" type="text" width=40> (Deutsch)<br>
<input name="SuchEng" type="text" width=40> (Englisch)<br>
<input name="SuchFra" type="text" width=40> (Franzoesisch)<br>
<input name="SuchIta" type="text" width=40> (Italienisch)<br>
<input name="SuchSpa" type="text" width=40> (Spanisch)<br>
<input type="button" style="width:150px; height:25px;" value="Suche starten" onClick="Suchen()">
</form>

<table width=100%>
<tr>
<td valign=top colspan=5>
<span id="Treffer" style="color:#0000FF; font-weight:bold;">&#160;</span>
</td>
</tr>
<tr>
<td bgcolor="#EEEEEE" valign=top width=20%><b>Deutsch:</b></td>
<td bgcolor="#EEEEEE" valign=top width=20%><b>Englisch:</b></td>
<td bgcolor="#EEEEEE" valign=top width=20%><b>Franz&ouml;sisch:</b></td>
<td bgcolor="#EEEEEE" valign=top width=20%><b>Italienisch:</b></td>
<td bgcolor="#EEEEEE" valign=top width=20%><b>Spanisch:</b></td>
</tr>
</table>
<table id="Anzeigetabelle" style="display:none" width=100%>
<tr>
<td bgcolor="#FFFFE0" valign=top width=20%><span datafld="Deutsch"></span></td>
<td bgcolor="#FFFFE0" valign=top width=20%><span datafld="Englisch"></span></td>
<td bgcolor="#FFFFE0" valign=top width=20%><span datafld="Franzoesisch"></span></td>
<td bgcolor="#FFFFE0" valign=top width=20%><span datafld="Italienisch"></span></td>
<td bgcolor="#FFFFE0" valign=top width=20%><span datafld="Spanisch"></span></td>
</tr>
</table>
<br>&#160;
</body>
</html>