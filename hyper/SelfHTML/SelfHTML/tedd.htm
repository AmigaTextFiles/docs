<html>
<head>
<title>SELFHTML: JavaScript / Anwendungsbeispiele / Monatskalender</title>
<meta name="description" content="(SELFHTML 7.0) JavaScript, das einen Monatskalender simuliert, bei dem das aktuelle Tagesdatum hervorgehoben ist.">
<meta name="keywords" content="SELFHTML, JavaScript, Monatskalender">
<link rel=stylesheet type="text/css" href="wselfhtm.css">
</head>
<body bgcolor=#ffffff text=#000000 link=#aa5522 vlink=#772200 alink=#000000>

<p><nobr><a class="an" name="top"><img src="x2.gif" width=16 height=13 border=0></a> <a href="selfhtml.htm"><b>SELFHTML</b></a>/<a href="tq.htm" target="_parent">Quickbar</a>&#160;
<img src="x2.gif" width=16 height=13 border=0> <a href="te.htm"><b>JavaScript</b></a>&#160;
<img src="x2.gif" width=16 height=13 border=0> <a href="ted.htm"><b>Anwendungsbeispiele</b></a></nobr></p>
<hr noshade size=1>
<table cellpadding=4 cellspacing=1 width=100%>
<tr>
<td bgcolor=#EEEEEE class="doc" width=110><img src="xweb.gif" width=106 height=109></td>
<td bgcolor=#EEEEEE class="doc" valign=bottom width=100%><h2>Monatskalender</h2></td>
</tr>
<tr>
<td bgcolor=#EEEEEE class="doc" valign=top align=center>
<img src="x5.gif" width=30 height=20 vspace=6 border=0 alt="Diese Seite ist ein Dokument mit Informationstext">
</td>
<td bgcolor=#ffffff valign=top nowrap>

<p>
<img src="xgdown.gif" width=14 height=10 border=0>&nbsp;<a href="#a1"><b>Monatskalender - das Beispiel</b></a>
</p>

</td>
</tr><tr><td colspan=2 bgcolor=#EEEEEE class="doc"><a href="#bottom"><img src="xgdown.gif" width=14 height=10 border=0></a>&#160;</td></tr>
</table>



<h2 class="Sh2"><a class="an" name="a1"><img src="xnetsi2.gif" width=30 height=30 border=0 alt="Netscape2.0"><img src="xmsie3.gif" width=30 height=30 border=0 alt="MS IE 3.0"> Monatskalender</a></h2>

<p><img src="xview.gif" width=30 height=20 border=0 alt="Beispiel" align=absmiddle> <a href="tedda.htm"><b>Anzeigebeispiel: So sieht's aus</b></a></p>

<p>Das Beispiel schreibt in eine HTML-Datei an einer gew&uuml;nschten Stelle einen frei formatierbaren Kalender des aktuellen Monats. Der aktuelle Tag wird darin hervorgehoben dargestellt.</p>

<p><b>Hinweis:</b> Zur besseren Orientierung enth&auml;lt das Beispiel Verweise zu den entsprechenden Erl&auml;uterungen, z.B. <a href="#a1a1"><b>1*</b></a>. Diese Verweise geh&ouml;ren nicht zum Quellcode. Falls Sie das Beispiel in einen Editor kopieren, m&uuml;ssen Sie diese Verweise l&ouml;schen. Andernfalls erhalten Sie JavaScript-Fehlermeldungen.</p>

<h3 class="xmp">Beispiel:</h3>
<table width=100% cellpadding=10><tr><td class="xmpcode" bgcolor=#FFFFE0><pre>
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Seitentitel&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;script language=&quot;JavaScript&quot;&gt;
&lt;!--
<a name="a1a1" href="#a1b1"><b>1*</b></a> var d = new Date();
var dm = d.getMonth() + 1;
var dj = d.getYear();
if(dj &lt; 100) dj+=1900;
Kalender(dm,dj);

<a name="a1a2" href="#a1b2"><b>2*</b></a> function Kalender(Monat,Jahr)
{
Monatsname = new Array
(&quot;Januar&quot;,&quot;Februar&quot;,&quot;M&amp;auml;rz&quot;,&quot;April&quot;,&quot;Mai&quot;,&quot;Juni&quot;,&quot;Juli&quot;,
&quot;August&quot;,&quot;September&quot;,&quot;Oktober&quot;,&quot;November&quot;,&quot;Dezember&quot;);
Tag = new Array (&quot;Mo&quot;,&quot;Di&quot;,&quot;Mi&quot;,&quot;Do&quot;,&quot;Fr&quot;,&quot;Sa&quot;,&quot;So&quot;);

var KSchrArt = &quot;Verdana,Arial&quot;; /* Schriftart Kalenderkopf */
var KSchrGroesse = 3;           /* Schriftgroesse 1-7 Kalenderkopf */
var KSchrFarbe = &quot;#FFFF00&quot;;     /* Schriftfarbe Kalenderkopf */
var Khgrund = &quot;#000066&quot;;        /* Hintergrundfarbe Kalenderkopf */
var TSchrArt = &quot;Verdana,Arial&quot;; /* Schriftart Tagesanzeige */
var TSchrGroesse = 3;           /* Schriftgroesse 1-7 Tagesanzeige */
var TSchrFarbe = &quot;#000000&quot;;     /* Schriftfarbe Tagesanzeige */
var Thgrund = &quot;#D0F0F0&quot;;        /* Hintergrundfarbe Tagesanzeige */
var SoFarbe = &quot;#E00000&quot;;        /* Schriftfarbe f. Sonntage */
var Ahgrund = &quot;#FFFFFF&quot;;        /* Hintergrundfarbe f. heutigen Tag */

<a name="a1a3" href="#a1b3"><b>3*</b></a> var jetzt = new Date();
var DieserMonat = jetzt.getMonth() + 1;
var DiesesJahr = jetzt.getYear();
if(DiesesJahr &lt; 100) DiesesJahr+=1900;
var DieserTag = jetzt.getDate();
<a name="a1a4" href="#a1b4"><b>4*</b></a> var Zeit = new Date(Jahr,Monat-1,1);
var Start = Zeit.getDay();
if(Start &gt; 0) Start--;
else Start = 6;
var Stop = 31;
if(Monat==4 ||Monat==6 || Monat==9 || Monat==11 ) --Stop;
if(Monat==2)
{
 AnzTage=-3;
 if(Jahr%4==0) Stop++;
 if(Jahr%100==0) Stop--;
 if(Jahr%400==0) Stop++;
}
<a name="a1a5" href="#a1b5"><b>5*</b></a> document.write(&quot;&lt;table border=3 cellpadding=1 cellspacing=1&gt;&quot;);
var Monatskopf = Monatsname[Monat-1] + &quot; &quot; + Jahr;
SchreibeKopf(Monatskopf,Khgrund,KSchrFarbe,KSchrGroesse,KSchrArt);
var Tageszahl = 1;
for(i=0;i&lt;=5;i++)
 {
  document.write(&quot;&lt;tr&gt;&quot;);
  for(j=0;j&lt;=5;j++)
   {
    if((i==0)&amp;&amp;(j &lt; Start))
     SchreibeZelle(&quot;&amp;#160;&quot;,Thgrund,TSchrFarbe,TSchrGroesse,TSchrArt);
    else
     {
      if(Tageszahl &gt; Stop)
        SchreibeZelle(&quot;&amp;#160;&quot;,Thgrund,TSchrFarbe,TSchrGroesse,TSchrArt);
      else
       {
        if((Jahr==DiesesJahr)&amp;&amp;(Monat==DieserMonat)&amp;&amp;(Tageszahl==DieserTag))
         SchreibeZelle(Tageszahl,Ahgrund,TSchrFarbe,TSchrGroesse,TSchrArt);
        else
         SchreibeZelle(Tageszahl,Thgrund,TSchrFarbe,TSchrGroesse,TSchrArt);
        Tageszahl++;
       }
      }
     }
    if(Tageszahl &gt; Stop)
      SchreibeZelle(&quot;&amp;#160;&quot;,Thgrund,SoFarbe,TSchrGroesse,TSchrArt);
    else
     {
      if((Jahr==DiesesJahr)&amp;&amp;(Monat==DieserMonat)&amp;&amp;(Tageszahl==DieserTag))
        SchreibeZelle(Tageszahl,Ahgrund,SoFarbe,TSchrGroesse,TSchrArt);
      else
        SchreibeZelle(Tageszahl,Thgrund,SoFarbe,TSchrGroesse,TSchrArt);
      Tageszahl++;
     }
    document.write(&quot;&lt;/tr&gt;&quot;);
  }
document.write(&quot;&lt;/table&gt;&quot;);
}

function SchreibeKopf(Monatstitel,HgFarbe,SchrFarbe,SchrGroesse,SchrArt)
{
document.write(&quot;&lt;tr&gt;&quot;);
document.write(&quot;&lt;td align=center colspan=7 valign=middle bgcolor=&quot;+HgFarbe+&quot;&gt;&quot;);
document.write('&lt;font size='+SchrGroesse+' color='+SchrFarbe+' face=&quot;'+SchrArt+'&quot;&gt;&lt;b&gt;');
document.write(Monatstitel);
document.write(&quot;&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;&quot;);
document.write(&quot;&lt;tr&gt;&quot;);
for(i=0;i&lt;=6;i++)
  SchreibeZelle(Tag[i],HgFarbe,SchrFarbe,SchrGroesse,SchrArt);
document.write(&quot;&lt;/tr&gt;&quot;);
}

function SchreibeZelle(Inhalt,HgFarbe,SchrFarbe,SchrGroesse,SchrArt)
{
document.write(&quot;&lt;td align=center valign=middle bgcolor=&quot;+HgFarbe+&quot;&gt;&quot;);
document.write('&lt;font size='+SchrGroesse+' color='+SchrFarbe+' face=&quot;'+SchrArt+'&quot;&gt;&lt;b&gt;');
document.write(Inhalt);
document.write(&quot;&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;&quot;);
}
//--&gt;
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></td></tr></table>


<h3 class="xpl">Erl&auml;uterung:</h3>

<p><img src="xgoup.gif" width=14 height=10 border=0>&nbsp;<a name="a1b1" href="#a1a1"><b>Aktuelles Datum ermitteln</b></a><br>
Im Scriptbereich wird zun&auml;chst mit <tt>d = new Date()</tt> ein neues Datumsobjekt mit dem aktuellen Zeitpunkt erzeugt. In den Variablen <tt>dm</tt> und <tt>dj</tt> werden anschlie&szlig;end aus dem neuen Datumsobjekt <tt>d</tt> der Monat und das Jahr ermittelt. Mit diesen beiden Variablen wird die Funktion <tt>Kalender()</tt> aufgerufen.</p>


<p><img src="xgoup.gif" width=14 height=10 border=0>&nbsp;<a name="a1b2" href="#a1a2"><b>Funktion <i>Kalender()</i></b></a><br>
Die Funktion <tt>Kalender()</tt> ist als in sich abgeschlossenes Unterprogramm realisiert, das einfach nur einen Monat und ein Jahr erwartet, das als Monatskalender angezeigt werden soll. Auf diese Weise l&auml;&szlig;t sich die Funktion auch noch anderweitig nutzen als zur einmaligen Ausgabe des aktuellen Kalendermonats.</p>

<p>Zu Beginn der Funktion <tt>Kalender()</tt> werden erst einmal verschiedene Variablen definiert. Dazu geh&ouml;ren die gew&uuml;nschten Monatsnamen und die Wochentage, die jeweils als Array-Objekte angelegt werden. Wenn Sie andere, zum Beispiel landesspezifische Namen wie &quot;J&auml;nner&quot; w&uuml;nschen, &auml;ndern Sie den entsprechenden Namen einfach.<br>
Zu den Variablen, die am Beginn von <tt>Kalender()</tt> definiert werden, geh&ouml;ren auch die Angaben zu Farben, Schriftarten und Schriftgr&ouml;&szlig;en f&uuml;r Kalenderhintergrund und Anzeige der Tage. Die Variablendefinitionen sind im Beispiel zum besseren Verst&auml;ndnis auskommentiert. &Auml;ndern Sie diese Werte, wenn Sie den Kalender verwenden m&ouml;chten, nach Ihren W&uuml;nschen.</p>


<p><img src="xgoup.gif" width=14 height=10 border=0>&nbsp;<a name="a1b3" href="#a1a3"><b>Ermitteln, ob aktiver Tag im anzuzeigenden Monat liegt</b></a><br>
Da die Funktion <tt>Kalender()</tt> ja als Parameter &uuml;bergeben bekommt, welchen Monat in welchem Jahr sie ausgeben soll, kann es sich durchaus um einen anderen als den aktuellen Monat handeln (nur im obigen Beispiel wird die Funktion mit dem aktuellen Monat/Jahr aufgerufen). Die Funktion ermittelt deshalb noch einmal separat die Daten des aktuellen Tages (<tt>DieserTag</tt>), des aktuellen Monats (<tt>DieserMonat</tt>) und des aktuellen Jahres (<tt>DiesesJahr</tt>). Die entsprechenden Daten werden sp&auml;ter ben&ouml;tigt, um den aktuellen Tag farblich hervorzuheben, sofern er in dem auszugebenden Monat vorkommt.</p>

<p><img src="xgoup.gif" width=14 height=10 border=0>&nbsp;<a name="a1b4" href="#a1a4"><b>Anzeige in Tabelle vorbereiten</b></a><br>
Der Monatskalender soll mit Hilfe von <tt>document.write()</tt>-Anweisungen in eine HTML-Tabelle geschrieben werden. Zun&auml;chst mu&szlig; jedoch ermittelt werden, wie viele Tage der auszugebende Monat hat, und an welchem Wochentag er beginnt. Davon h&auml;ngt ab, wie die Tage in die Tabelle geschrieben werden.<br>
In der Variablen <tt>Start</tt> wird der Wochentag gespeichert, auf den der erste Tag des auszugebenden Monats f&auml;llt. Dazu wird in einer Variablen <tt>Zeit</tt> ein Datumsobjekt erzeugt, das sich mit <tt>Date(Jahr,Monat-1,1)</tt> auf den ersten Tag des auszugebenden Monats bezieht. Mit <tt>Zeit.getDay()</tt> wird der Wochentag dieses Tages ermittelt (0 f&uuml;r Monatag bis 6 f&uuml;r Sonntag).<br>
In der Variablen <tt>Stop</tt> wird die Anzahl der Tage ermittelt, die der Monat hat. Wenn es einer der Monate 4, 6, 9 oder 11 ist, hat der Monat 30 Tage. Wenn es der Monat 2 ist, ist etwas Kalenderakrobatik erforderlich. Denn dieser Monat kann 28 oder 29 Tage haben, abh&auml;ngig einmal davon, ob es ein Schaltjahr ist (durch 4 teilbar), ob es trotzdem kein Schaltjahr ist (durch 100 teilbar), oder ob es doch wieder ein Schaltjahr ist (durch 400 teilbar).</p>


<p><img src="xgoup.gif" width=14 height=10 border=0>&nbsp;<a name="a1b5" href="#a1a5"><b>Tabelle erzeugen</b></a><br>
Nachdem alle Vorbereitungen getroffen sind, kann die Tabelle mit dem Kalendermonat geschrieben werden. Dies geschieht mit Hilfe von <tt>document.write()</tt>-Befehlen, die dynamisch die entsprechenden HTML-Befehle in die Datei schreiben. Die Funktion <tt>Kalender()</tt> selbst schreibt jedoch nur den Anfang und das Ende der Tabelle. Ansonsten &uuml;bernimmt sie nur die Kontrolle, was genau in welcher Reihenfolge geschrieben werden soll. Um den Tabellenkopf mit Monats- und Jahresangabe sowie den Wochentagnamen zu schreiben, ruft sie die Unterfunktion <tt>SchreibeKopf()</tt> auf. Um die einzelnen Datenzellen zu schreiben, wird jeweils die Unterfunktion <tt>SchreibeZelle()</tt> aufgerufen. Um letztere mit den richtigen Daten zu versorgen, mu&szlig; die <tt>Kalender()</tt>-Funktion die zuvor ermittelten Angaben zum Wochentag des ersten Tages im Monat sowie das aktuelle Tagesdatum ber&uuml;cksichtigen und die entsprechenden Parameter korrekt &uuml;bergeben. Falls eine Zelle leer bleiben soll, wird das erzwungene Leerzeichen <tt>&amp;#160;</tt> &uuml;bergeben, denn nur so wird die Tabellenzelle nachher sichtbar dargestellt, auch wenn sie keinen Inhalt hat. Wenn die Zelle eine Tageszahl anzeigen soll, wird eine entsprechende Variable &uuml;bergeben.<br>
Die Funktionen <tt>SchreibeKopf()</tt> und <tt>SchreibeZelle()</tt> schreiben die einzelnen Datenzellen und setzen dabei die Variablen zur Gestaltung des Kalenders ein.</p>



<table cellpadding=4 cellspacing=1 width=100%>
<tr><td colspan=2 bgcolor=#EEEEEE class="doc">
<a href="#top"><img src="xgoup.gif" width=14 height=10 border=0></a>
</td></tr>
<tr><td bgcolor=#EEEEEE class="doc" align=right width=110>weiter:<a href="tede.htm"><img src="xgnext.gif" width=10 height=10 border=0 hspace=10></a></td>
<td bgcolor=#ffffff><img src="x3.gif" width=15 height=10 border=0> <a href="tede.htm"><b>Pers&ouml;nliche Seitenbesuche z&auml;hlen mit Cookies</b></a>
</td></tr>
<tr>
<td bgcolor=#EEEEEE class="doc" align=right width=110>zur&uuml;ck:<a href="tedc.htm"><img src="xgprev.gif" width=10 height=10 border=0 hspace=10></a></td>
<td bgcolor=#ffffff width=100%><img src="x3.gif" width=15 height=10 border=0> <a href="tedc.htm"><b>Taschenrechner</b></a>
</td>
</tr>
<tr><td colspan=2 bgcolor=#EEEEEE class="doc">&#160;</td></tr>
</table>
<hr noshade size=1>
<p><nobr><img src="x2.gif" width=16 height=13 border=0> <a href="selfhtml.htm"><b>SELFHTML</b></a>/<a href="tq.htm" target="_parent">Quickbar</a>&#160;
<img src="x2.gif" width=16 height=13 border=0> <a href="te.htm"><b>JavaScript</b></a>&#160;
<img src="x2.gif" width=16 height=13 border=0> <a href="ted.htm"><b>Anwendungsbeispiele</b></a></nobr></p>
<p><nobr><a class="an" name="bottom">&copy; 1998</A> <img src="xgmail.gif" width=15 height=10 border=0>&nbsp;<a href="mailto:muenz@csi.com">Stefan M&uuml;nz, muenz@csi.com</a></nobr></p>


</body>
</html>