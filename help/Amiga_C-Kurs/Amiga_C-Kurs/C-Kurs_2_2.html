<html>
<head>
<title>Amiga C Kurs f&uuml;r Einsteiger</title>
<META NAME="description" CONTENT="Amiga C Kurs f&uuml;r Einsteiger">
<META NAME="keywords"    CONTENT="C, Amiga, Programmierung, Kurs, Einsteiger, StormC">
<META NAME="author"      CONTENT="Norman Walter">

<script language="JavaScript" src="JavaScript/C-Kurs_Kapitel.js" type="text/javascript">
</script>

</head>
<body bgcolor="black" link="#DDDDDD" vlink="#BBBBBB">
<center>
<TABLE>
<TD VALIGN="TOP" ALIGN="TOP" WIDTH="140">
<CENTER>
<A HREF="index.html" NAME="Home"><IMG SRC="Home.png" ALT="Home" BORDER="0"></A><BR>
<A HREF="download.html" NAME="Downloads"><IMG SRC="Download.png" ALT="Downloads" BORDER="0"></A><BR>
<A HREF="Links.html" NAME="Links"><IMG SRC="Links.png" ALT="Links" BORDER="0"></A><BR>
<a href="cgi-bin/GB_SHOW.cgi" method="POST"><img SRC="guestbook.png" BORDER=0 alt="Guestbook"></a>
<p>
<A HREF="http://www.norman-interactive.com/email_feedback.html">
<IMG SRC="@.png" Border="0" Alt="e-mail"><BR><small>e-mail</small></A><BR>
<p>

<img src="C-Kurs/C-Kurs_sm.png" alt="Amiga C Kurs f&uuml;r Einsteiger" vspace="20"><BR>

<NOSCRIPT>
<font color="red">
Diese Seite ben&ouml;tigt JavaScript.
Entweder Ihr Browser unterst&uuml;tzt kein JavaScript, oder Sie haben es deaktiviert.
</font>
</NOSCRIPT>

<SCRIPT LANGUAGE="JavaScript">
<!--

  erzeuge_Kapitel(2);

//-->
</SCRIPT>

<p>
</CENTER>
</TD>
<TD VALIGN="TOP" ALIGN="TOP" WIDTH="400" HEIGHT="600">
<center>
<p>
<BR>
<font color="white">

<img src="C-Kurs/C-Kurs.png" alt="Amiga C Kurs f&uul,r Einsteiger"><BR>
</center>
<p>
<font color="gray"><H2>Makros statt Funktionen</H2></font><BR>
<p>
In manchen F&auml;llen k&ouml;nnen wir anstatt Funktionen Makros verwenden.
Beispielsweise k&ouml;nnten wir eine Funktion, die das Maximum zweier
Zahle a und b zur&uuml;ckgibt wie folgt formulieren:

<p>
<center>
<TABLE border="0" cellpadding="5" cellspacing="0" bgcolor="#AAAAAA"><TR>
<TD>
<!-- begin of C code -->
<font color="#008822"><b>//&nbsp;Funktion&nbsp;max&nbsp;gibt&nbsp;das&nbsp;Maximum&nbsp;zweier&nbsp;Ganzzahlen&nbsp;a&nbsp;und&nbsp;b&nbsp;zur&uuml;ck<br></b></font>
<font color="#AA00FF"><b>int</b></font>&nbsp;max(<font color="#AA00FF"><b>int</b></font>&nbsp;a,&nbsp;<font color="#AA00FF"><b>int</b></font>&nbsp;b)<br>
{<br>
&nbsp;&nbsp;<font color="#AA00FF"><b>if</b></font>&nbsp;(a>b)&nbsp;<font color="#AA00FF"><b>return</b></font>&nbsp;a;&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;Falls&nbsp;a&nbsp;gr&ouml;&szlig;er&nbsp;b&nbsp;ist,&nbsp;ist&nbsp;a&nbsp;das&nbsp;Maximum<br></b></font>
&nbsp;&nbsp;<font color="#AA00FF"><b>else</b></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#AA00FF"><b>return</b></font>&nbsp;b;&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;Ansonsten&nbsp;ist&nbsp;b&nbsp;das&nbsp;Maximum<br></b></font>
}<br>

<!-- end of C code -->

</TD>
</TR>
</TABLE>
</center>
<BR>
<p>

Die weitaus k&uuml;rzere Formulierung als Makro ist:

<p>
<center>
<TABLE border="0" cellpadding="5" cellspacing="0" bgcolor="#AAAAAA"><TR>
<TD>
<!-- begin of C code -->
<font color="#008822"><b>//&nbsp;Das&nbsp;Maximum&nbsp;zweier&nbsp;Zahlen&nbsp;a&nbsp;und&nbsp;b&nbsp;als&nbsp;Makro<br></b></font>
#define&nbsp;MAX(a,b)&nbsp;((a)&nbsp;>&nbsp;(b)&nbsp;?&nbsp;(a)&nbsp;:&nbsp;(b))<br>

<!-- end of C code -->

</TD>
</TR>
</TABLE>
</center>
<BR>
<p>

Der <a href="C-Kurs_Operatoren.html">Operator</a> <TT>?</TT> ist die sogenannte "Bedingte Zuweisung".
Falls der Ausdruck (a &gt; b) wahr ist, liefert unser Makro den Wert
der Variable a, ansonsten den Wert der Variable b.
<p>
Sie k&ouml;nnen dieses Makro genau wie eine Funktion benutzen, z.B.:

<p>
<center>
<TABLE border="0" cellpadding="5" cellspacing="0" bgcolor="#AAAAAA"><TR>
<TD>
<!-- begin of C code -->
<font color="#852608"><b>printf</b></font>(<font color="#EEDD05">"Das&nbsp;Maximum&nbsp;ist&nbsp;%d.\n"</font>,MAX(a,b));<br>

<!-- end of C code -->

</TD>
</TR>
</TABLE>
</center>
<BR>
<p>

Solche Makros sind nicht nur sch&ouml;n kurz, sondern Sie bringen auch
einen Geschwindigkeitsvorteil gegen&uuml;ber Funktionen. Im Falle eines
Makros ersetzt der Pr&auml;prozessor einfach nur den entsprechenden Text
im Quelltext. Im Falle einer Funktion w&uuml;rde zur Laufzeit beim
Funktionsaufruf in die Funktion gesprungen und nach dem <TT>return</TT>
zur aufrufenden Funktion zur&uuml;ckgesprungen. Und das kostet nat&uuml;rlich
Zeit, die Sie bei der Verwendung von Makros einsparen k&ouml;nnen.
<p>
Auch die Funktion <TT>Schaltjahr</TT> aus <a href="C-Kurs_1_11.html">Listing 1.11.2</a>
l&auml;&szlig;t sich durch ein Makro ersetzen:

<p>
<center>
<TABLE border="0" cellpadding="5" cellspacing="0" bgcolor="#AAAAAA"><TR>
<TD>
<!-- begin of C code -->
#define&nbsp;Schaltjahr(J)&nbsp;((J&nbsp;%&nbsp;4&nbsp;==&nbsp;0&nbsp;&&&nbsp;J&nbsp;%&nbsp;100&nbsp;!=&nbsp;0)&nbsp;||&nbsp;J&nbsp;%&nbsp;400&nbsp;==&nbsp;0)<br>

<!-- end of C code -->

</TD>
</TR>
</TABLE>
</center>
<BR>
<p>

Allerdings ist &auml;u&szlig;erste Vorsicht geboten, wenn man Makros statt Funktionen
verwendet, denn es k&ouml;nnen unter bestimmten Umst&auml;nden &auml;u&szlig;erst unangenehme
Seiteneffekte auftreten.

<p>
<center>
<TABLE border="0" cellpadding="5" cellspacing="0" bgcolor="#AAAAAA"><TR>
<TD>
<!-- begin of C code -->
<font color="#FFFFFF">
/*&nbsp;&nbsp;Listing&nbsp;2.2.1<br>
&nbsp;*&nbsp;&nbsp;Makros&nbsp;und&nbsp;Seiteneffekte<br>
&nbsp;*/<br></font>
<br>
#include&nbsp;&lt;stdio.h&gt;<br>
<br>
<font color="#FFFFFF">
/*&nbsp;Maximum&nbsp;als&nbsp;Makro&nbsp;*/<br></font>
#define&nbsp;MAX(a,b)&nbsp;((a)&nbsp;>&nbsp;(b)&nbsp;?&nbsp;(a)&nbsp;:&nbsp;(b))<br>
<br>
<font color="#FFFFFF">
/*&nbsp;Maximum&nbsp;als&nbsp;Funktion&nbsp;*/<br></font>
<font color="#AA00FF"><b>int</b></font>&nbsp;max(<font color="#AA00FF"><b>int</b></font>&nbsp;a,&nbsp;<font color="#AA00FF"><b>int</b></font>&nbsp;b)<br>
{<br>
&nbsp;&nbsp;<font color="#AA00FF"><b>if</b></font>&nbsp;(a&nbsp;>&nbsp;b)&nbsp;<font color="#AA00FF"><b>return</b></font>&nbsp;a;<br>
&nbsp;&nbsp;<font color="#AA00FF"><b>return</b></font>&nbsp;b;<br>
}<br>
<br>
<font color="#AA00FF"><b>int</b></font>&nbsp;main(<font color="#AA00FF"><b>void</b></font>)<br>
{<br>
&nbsp;&nbsp;<font color="#AA00FF"><b>int</b></font>&nbsp;i;<br>
&nbsp;&nbsp;<font color="#AA00FF"><b>int</b></font>&nbsp;x,y;<br>
<br>
&nbsp;&nbsp;x=5;y=23;<br>
<br>
&nbsp;&nbsp;i&nbsp;=&nbsp;MAX(x++,y++);<br>
&nbsp;&nbsp;<font color="#852608"><b>printf</b></font>(<font color="#EEDD05">"x=%d&nbsp;y=%d\n"</font>,x,y);&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;Ausgabe:&nbsp;x=6&nbsp;y=25<br></b></font>
<br>
&nbsp;&nbsp;x=5;y=23;<br>
<br>
&nbsp;&nbsp;i&nbsp;=&nbsp;max(x++,y++);<br>
&nbsp;&nbsp;<font color="#852608"><b>printf</b></font>(<font color="#EEDD05">"x=%d&nbsp;y=%d\n"</font>,x,y);&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;Ausgabe:&nbsp;x=6&nbsp;y=24<br></b></font>
<br>
&nbsp;&nbsp;<font color="#AA00FF"><b>return</b></font>&nbsp;0;<br>
}<br>

<!-- end of C code -->

</TD>
</TR>
</TABLE>
</center>
<BR>
<p>

Hier bereitet das Makro <TT>MAX</TT> ein Problem: Bei der Ersetzung
des Textes wird der gr&ouml;&szlig;ere der beiden Werte ein weiteres mal inkrementiert.
Damit ist das Ergebnis dann leider falsch.

<p>

Als weiteres Beispiel folgt die Berechnung der Kreisfl&auml;che:

<p>
<center>
<TABLE border="0" cellpadding="5" cellspacing="0" bgcolor="#AAAAAA"><TR>
<TD>
<!-- begin of C code -->
<font color="#FFFFFF">
/*&nbsp;&nbsp;Listing&nbsp;2.2.2<br>
&nbsp;*&nbsp;&nbsp;Berechnung&nbsp;der&nbsp;Kreisfl&auml;che<br>
&nbsp;*<br>
&nbsp;*/<br></font>
<br>
#include&nbsp;&lt;stdio.h&gt;<br>
<br>
<font color="#008822"><b>//&nbsp;Die&nbsp;Zahl&nbsp;PI&nbsp;als&nbsp;symbolische&nbsp;Konstante<br></b></font>
#define&nbsp;PI&nbsp;3.14159265358979323846<br>
<br>
<font color="#008822"><b>//&nbsp;Makro&nbsp;f&uuml;r&nbsp;die&nbsp;Berechnung&nbsp;der&nbsp;Kreisfl&auml;che<br></b></font>
#define&nbsp;A_Kreis(r)&nbsp;(PI*r*r)<br>
<br>
<font color="#AA00FF"><b>int</b></font>&nbsp;main(<font color="#AA00FF"><b>void</b></font>)<br>
{<br>
&nbsp;&nbsp;<font color="#AA00FF"><b>double</b></font>&nbsp;r;&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;Radius&nbsp;des&nbsp;Kreises<br></b></font>
<br>
&nbsp;&nbsp;<font color="#852608"><b>printf</b></font>(<font color="#EEDD05">"Programm&nbsp;zur&nbsp;Berechnung&nbsp;der&nbsp;Kreisfl&auml;che\n"</font>);<br>
&nbsp;&nbsp;<font color="#852608"><b>printf</b></font>(<font color="#EEDD05">"Bitte&nbsp;geben&nbsp;Sie&nbsp;den&nbsp;Radius&nbsp;des&nbsp;Kreises&nbsp;ein:&nbsp;"</font>);<br>
&nbsp;&nbsp;<font color="#852608"><b>scanf</b></font>(<font color="#EEDD05">"%lf"</font>,&r);<br>
&nbsp;&nbsp;<font color="#852608"><b>printf</b></font>(<font color="#EEDD05">"Kreisfl&auml;che:&nbsp;%lf\n"</font>,A_Kreis(r));<br>
<br>
&nbsp;&nbsp;<font color="#AA00FF"><b>return</b></font>&nbsp;0;<br>
}<br>

<!-- end of C code -->

</TD>
</TR>
</TABLE>
</center>
<BR>
<p>

Hier definieren wir zuerst die Zahl <TT>PI</TT> als <a href="C-Kurs_2_1.html">symbolische Konstante</a>.
In unserem Makro <TT>A_Kreis</TT> benutzen wir diese <a href="C-Kurs_2_1.html">symbolische Konstante</a>
um die Kreisfl&auml;che zu berechnen. Wie wir sehen, k&ouml;nnen Makros auch ineinander eingesetzt werden.

<p>

</font>
</center>
</TD>
</TABLE>

</body>
</html>
