<html>
<head>
<title>Amiga C Kurs f&uuml;r Einsteiger</title>
<META NAME="description" CONTENT="Amiga C Kurs f&uuml;r Einsteiger">
<META NAME="keywords"    CONTENT="C, Amiga, Programmierung, Kurs, Einsteiger, StormC">
<META NAME="author"      CONTENT="Norman Walter">

<script language="JavaScript" src="JavaScript/C-Kurs_Kapitel.js" type="text/javascript">
</script>

</head>
<body bgcolor="black" link="#DDDDDD" vlink="#BBBBBB">
<center>
<TABLE>
<TD VALIGN="TOP" ALIGN="TOP" WIDTH="140">
<CENTER>
<A HREF="index.html" NAME="Home"><IMG SRC="Home.png" ALT="Home" BORDER="0"></A><BR>
<A HREF="download.html" NAME="Downloads"><IMG SRC="Download.png" ALT="Downloads" BORDER="0"></A><BR>
<A HREF="Links.html" NAME="Links"><IMG SRC="Links.png" ALT="Links" BORDER="0"></A><BR>
<a href="cgi-bin/GB_SHOW.cgi" method="POST"><img SRC="guestbook.png" BORDER=0 alt="Guestbook"></a>
<p>
<A HREF="http://www.norman-interactive.com/email_feedback.html">
<IMG SRC="@.png" Border="0" Alt="e-mail"><BR><small>e-mail</small></A><BR>
<p>

<img src="C-Kurs/C-Kurs_sm.png" alt="Amiga C Kurs f&uuml;r Einsteiger" vspace="20"><BR>

<NOSCRIPT>
<font color="red">
Diese Seite ben&ouml;tigt JavaScript.
Entweder Ihr Browser unterst&uuml;tzt kein JavaScript, oder Sie haben es deaktiviert.
</font>
</NOSCRIPT>

<SCRIPT LANGUAGE="JavaScript">
<!--

  erzeuge_Kapitel(7);

//-->
</SCRIPT>

<p>
</CENTER>
</TD>
<TD VALIGN="TOP" ALIGN="TOP" WIDTH="400" HEIGHT="600">
<center>
<p>
<BR>
<font color="white">

<img src="C-Kurs/C-Kurs.png" alt="Amiga C Kurs f&uul,r Einsteiger"><BR>
</center>
<p>
<font color="gray"><H2>Das erste Fenster</H2></font><BR>
<p>
Die Verwaltung von Fenstern und Screens &uuml;bernimmt beim Amiga die
<TT>intuition.library</TT>. Die Intuition API bietet verschiedene
Funktionen zum &Ouml;ffnen von Fenstern. Wir schauen uns in dieser
Lektion die Funktion <TT>OpenWindowTags</TT> an.
<p>
Der Syntax der Funktion <TT>OpenWindowTags</TT> ist:<BR>
<pre>
  <i>Zeiger</i> = OpenWindowTags([<i>NewWindow</i>], [<i>TagItems</i>]);
</pre>
<BR>
<p>
Die Funktion liefert im Erfolgsfall einen <a href="C-Kurs_4_2.html"><i>Zeiger</i> auf eine Struktur</a> vom Typ <TT>Window</TT> zur&uuml;ck, sonst <TT>NULL</TT>. Als Eingabeparameter
erwartet die Funktion <TT>OpenWindowTags</TT> als ersten Parameter
einen (optionalen) <a href="C-Kurs_4_1.html">Zeiger</a> auf eine <TT>NewWindow</TT> <a href="C-Kurs_3_3.html">Struktur</a> oder <TT>NULL</TT>.
Wenn man <TT>NULL</TT> &uuml;bergibt, wird ein Satz von Vorgabeparametern f&uuml;r das
Fenster verwendet, die dann anschlie&szlig;end von den TagItems &uuml;berschrieben werden.
<p>
Der zweite Parameter ist eine Liste von Tags.
Auch wenn man keine TagItems &uuml;bergibt, kann man ein Fenster auf dem Workbench
Screen oder einem anderen Default-Screen &ouml;ffnen.
<p>
Der Datentyp <TT>TagItem</TT> ist in der AmigaOS Header-Datei <TT>utility/tagitem.h</TT>
definiert:

<p>
<center>
<TABLE border="0" cellpadding="5" cellspacing="0" bgcolor="#AAAAAA"><TR>
<TD>
<!-- begin of C code -->
<font color="#AA00FF"><b>typedef</b></font>&nbsp;<font color="#45FF65">ULONG</font>&nbsp;Tag;<br>
<br>
<font color="#AA00FF"><b>struct</b></font>&nbsp;<font color="#45FF65">TagItem</font><br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;Tag&nbsp;&nbsp;&nbsp;ti_Tag;&nbsp;&nbsp;&nbsp;<font color="#FFFFFF">/*&nbsp;identifies&nbsp;the&nbsp;type&nbsp;of&nbsp;data&nbsp;*/<br></font>
&nbsp;&nbsp;&nbsp;&nbsp;ULONG&nbsp;ti_Data;&nbsp;&nbsp;<font color="#FFFFFF">/*&nbsp;type-specific&nbsp;data&nbsp;*/<br></font>
};<br>

<!-- end of C code -->

</TD>
</TR>
</TABLE>
</center>
<BR>
<p>

 
Ein <TT>TagItem</TT> ist eine <a href="C-Kurs_3_3.html">Struktur</a> mit zwei Komponenten:
<TT>ti_Tag</TT> enth&auml;lt den Namen des Tags und <TT>ti_Data</TT> enth&auml;lt
die zugeh&ouml;rigen Daten.
<p>
Wenn wir ein Fenster mit <TT>OpenWindowTags</TT> &ouml;ffnen wollen, m&uuml;ssen wir
also eine Liste solcher TagItems angeben. Die Liste der TagItems wird mit
einem speziellen Tag, n&auml;mlich <TT>TAG_DONE</TT> oder dem Synonym <TT>TAG_END</TT>
abgeschlossen.
<p>
Die Namen der verwendeten Tags sind die verschiedenen Fensterattribute (= Eigenschaften),
die wir sp&auml;ter ausf&uuml;hrlich besprechen werden. Das TagItem <TT>WA_WIDTH</TT> enth&auml;lt z.B.
die Breite des Fensters, mit WA_DepthGadget geben wir (mit <TT>TRUE</TT> oder <TT>FALSE</TT>)
an, ob das Fenster ein Depth Gadget haben soll oder nicht.
<p>
Um die Funktion <TT>OpenWindowTags</TT> nutzen zu k&ouml;nnen, m&uuml;ssen wir
die <TT>intuition.library</TT> zuvor mit <TT>OpenLibrary</TT> &ouml;ffnen, wie wir es bereis in der
<a href="C-Kurs_7_1.html">letzten Lektion</a> besprochen haben.
Da die Funktion <TT>OpenWindowTags</TT> erst ab AmigaOS 2.0 verf&uuml;gbar ist,
&uuml;bergeben wir der Funktion <TT>OpenLibrary</TT> als zweiten Parameter <TT>36L</TT>.
Damit sagen wir, da&szlig; wir mindestens die Version 36 der <TT>intuition.library</TT> &ouml;ffnen
wollen.
<p>
Weil wir den Zeiger <TT>*IntuitionBase</TT> bei der Deklaration als einen
<a href="C-Kurs_4_2.html">Zeiger auf eine Struktur</a> vom Typ <TT>IntuitionBase</TT> angegeben haben,
die Funktion <TT>OpenLibrary</TT> aber einen Zeiger auf eine Struktur vom Typ
<TT>Library</TT> zur&uuml;ckgibt, m&uuml;&szlig;en wir den von der Funktion <TT>OpenLibrary</TT>
zur&uuml;ckgegebenen Zeiger mit einem expliziten <a href="C-Kurs_5_5.html">Typecast</a> in einen
<a href="C-Kurs_4_2.html">Zeiger auf eine Struktur</a> vom Typ <TT>IntuitionBase</TT> umwandeln.
Bei <TT>CloseLibrary</TT> m&uuml;ssen wir genau umgekehrt vorgehen: Die Funktion
erwartet als Eingabeparameter einen Zeiger auf eine Struktur vom Typ <TT>Library</TT>.
Deshalb m&uuml;ssen wir hier den Zeiger auf eine Struktur vom Typ <TT>IntuitioonBase</TT>
in einen Zeiger auf eine Struktur vom Typ <TT>Library</TT> umwandeln.
<p>
Listing 7.2 zeigt, wie man ein Intuition-Fenster mit Hilfe der Funktion
<TT>OpenWindowTags</TT> &ouml;ffnet:

<p>
<center>
<TABLE border="0" cellpadding="5" cellspacing="0" bgcolor="#AAAAAA"><TR>
<TD>
<!-- begin of C code -->
<font color="#FFFFFF">
/*&nbsp;&nbsp;Listing&nbsp;7.2<br>
&nbsp;*&nbsp;&nbsp;Das&nbsp;erste&nbsp;Fenster<br>
&nbsp;*/<br></font>
<br>
#include&nbsp;&lt;exec/types.h&gt;<br>
#include&nbsp;&lt;exec/exec.h&gt;<br>
#include&nbsp;&lt;intuition/intuition.h&gt;<br>
<br>
#include&nbsp;&lt;proto/intuition.h&gt;<br>
#include&nbsp;&lt;proto/dos.h&gt;<br>
#include&nbsp;&lt;proto/exec.h&gt;<br>
<br>
<font color="#008822"><b>//&nbsp;Symbolische&nbsp;Konstanten<br></b></font>
#define&nbsp;WIDTH&nbsp;300&nbsp;&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;Breite&nbsp;des&nbsp;Fensters<br></b></font>
#define&nbsp;HEIGHT&nbsp;300&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;H&ouml;he&nbsp;des&nbsp;Fensters<br></b></font>
<br>
<font color="#AA00FF"><b>struct</b></font>&nbsp;<font color="#45FF65">Window</font>&nbsp;*Fenster;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;Zeiger&nbsp;auf&nbsp;Window-Struktur<br></b></font>
<font color="#AA00FF"><b>struct</b></font>&nbsp;<font color="#45FF65">IntuitionBase</font>&nbsp;*<font color="#45FF65">IntuitionBase</font>;&nbsp;&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;Zeiger&nbsp;auf&nbsp;IntuitionBase-Struktur<br></b></font>
<br>
<font color="#AA00FF"><b>int</b></font>&nbsp;main(<font color="#AA00FF"><b>void</b></font>)<br>
{<br>
<br>
&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;Intuition&nbsp;Library&nbsp;&ouml;ffnen<br></b></font>
&nbsp;&nbsp;<font color="#45FF65">IntuitionBase</font>&nbsp;=&nbsp;(<font color="#AA00FF"><b>struct</b></font>&nbsp;<font color="#45FF65">IntuitionBase</font>&nbsp;*)&nbsp;<font color="#FFFFAA">OpenLibrary</font>(<font color="#EEDD05">"intuition.library"</font>,0L);<br>
<br>
&nbsp;&nbsp;<font color="#AA00FF"><b>if</b></font>&nbsp;(<font color="#45FF65">IntuitionBase</font>&nbsp;!=&nbsp;NULL)<br>
&nbsp;&nbsp;{<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;Fenster&nbsp;mittels&nbsp;Tags&nbsp;&ouml;ffnen<br></b></font>
&nbsp;&nbsp;&nbsp;&nbsp;Fenster&nbsp;=&nbsp;<font color="#FFFFAA">OpenWindowTags</font>(NULL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_Left,&nbsp;100,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;Abstand&nbsp;vom&nbsp;linken&nbsp;Rand<br></b></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_Top,&nbsp;100,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;Abstand&nbsp;vom&nbsp;oberen&nbsp;Rand<br></b></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_Width,&nbsp;WIDTH,&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;Breite<br></b></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_Height,&nbsp;HEIGHT,&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;H&ouml;he<br></b></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_Title,&nbsp;<font color="#EEDD05">"Mein&nbsp;erstes&nbsp;Fenster"</font>,&nbsp;<font color="#008822"><b>//&nbsp;Fenstertitel<br></b></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_CloseGadget,&nbsp;TRUE,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;Close-Gadget<br></b></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_DragBar,&nbsp;TRUE,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;Ziehleiste<br></b></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_DepthGadget,&nbsp;TRUE,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;Depth-Gadget<br></b></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_IDCMP,&nbsp;IDCMP_CLOSEWINDOW,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_Activate,&nbsp;TRUE,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;Fenster&nbsp;aktivieren<br></b></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAG_DONE);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#AA00FF"><b>if</b></font>&nbsp;(Fenster&nbsp;!=&nbsp;NULL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;Auf&nbsp;Close-Gadget&nbsp;warten<br></b></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#FFFFAA">Wait</font>(1L&nbsp;&lt;&lt;&nbsp;Fenster-&gt;UserPort-&gt;mp_SigBit);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#FFFFAA">CloseWindow</font>(Fenster);&nbsp;&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;Fenster&nbsp;schlie&szlig;en<br></b></font>
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<font color="#008822"><b>//&nbsp;end&nbsp;if<br></b></font>
<br>
&nbsp;&nbsp;}&nbsp;<font color="#008822"><b>//&nbsp;end&nbsp;if<br></b></font>
<br>
&nbsp;&nbsp;<font color="#008822"><b>//&nbsp;Library&nbsp;schlie&szlig;en<br></b></font>
&nbsp;&nbsp;<font color="#AA00FF"><b>if</b></font>&nbsp;(<font color="#45FF65">IntuitionBase</font>&nbsp;!=&nbsp;NULL)&nbsp;<font color="#FFFFAA">CloseLibrary</font>((<font color="#AA00FF"><b>struct</b></font>&nbsp;<font color="#45FF65">Library</font>&nbsp;*)<font color="#45FF65">IntuitionBase</font>);<br>
<br>
&nbsp;&nbsp;<font color="#AA00FF"><b>return</b></font>&nbsp;0;<br>
<br>
}<br>

<!-- end of C code -->

</TD>
</TR>
</TABLE>
</center>
<BR>
<p>

Das Resultat sollte wie folgt aussehen:
<p>
<center>
<img src="C-Kurs/erstesFenster.png"><BR>
</center>
<p>
Nachdem wir das Fenster ge&ouml;ffnet haben, warten wir mit
<TT>Wait(1L &lt;&lt; Fenster-&gt;UserPort-&gt;mp_SigBit);</TT> darauf,
da&szlig; der Benutzer das Close Gadget angeklickt hat. Dazu fragen wir
in der <TT>Window</TT> <a href="C-Kurs_3_3.html">Struktur</a>, auf die unsere Zeigervariable <TT>Fenster</TT>
gerade zeigt, im <TT>UserPort</TT> das <TT>mp_SigBit</TT> ab.
Wie das genau funktioniert, brauchen Sie jetzt nicht zu verstehen.
Die Funktion <TT>Wait</TT> wartet hier, bis dieses Signal (das Anklicken des Close Gadget)
ankommt. Erst dann wird das Programm fortgesetzt.
<p>
Anschlie&szlig;end wird das Fenster mit Hilfe der Funktion <TT>CloseWindow</TT> wieder
geschlossen. Die Funktion <TT>CloseWindow</TT> erwartet als Eingabeparameter einen
<a href="C-Kurs_4_2.html">Zeiger auf eine Struktur</a> vom Typ <TT>Window</TT>.
Das zugeh&ouml;rige Fenster wird dann geschlossen.
<p>
</font>
</center>
</TD>
</TABLE>

</body>
</html>
