<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- AG2HTML: CONVERTER=AG2HTML/1.1 FORMAT=AMIGAGUIDE/39.2 FILE="V44_Changes.guide" NODE="Picture Datatype" TITLE="V44_Changes.guide/Picture Datatype" TOC="Main" NEXT="Installer" PREV="ASL Library" -->
<head>
<title>V44_Changes.guide/Picture Datatype</title>
</head>
<body text="#000000" bgcolor="#AAAAAA">
<a href="../V44_Changes_guide/node0000.html"><img src="../images/toc.gif" alt="[Contents]" border=0></a>
<img src="../images/index_d.gif" alt="[Index]">
<img src="../images/help_d.gif" alt="[Help]">
<img src="../images/retrace_d.gif" alt="[Retrace]">
<a href="../V44_Changes_guide/node000F.html"><img src="../images/prev.gif" alt="[Browse &#060;]" border=0></a>
<a href="../V44_Changes_guide/node0011.html"><img src="../images/next.gif" alt="[Browse &#062;]" border=0></a>
<hr>
<pre>
<!-- AG2HTML: BODY=START -->

The Picture Datatype
********************

   The V40 <b>picture.datatype</b> distributed with OS 3.1 had several weak
points and missing features which made it inadequate when the first RTG
systems with true-color support became available.  For this reason,
nowadays the original V40/V42 version has been obsoleted by third party
replacements featuring true-color support and other useful extensions.

   OS 3.5 integrates a rewritten <b>picture.datatype</b> whose API tries to be
as compatible as possible to these unofficial versions.

   The V44 <b>picture.datatype</b> works transparently with both `CyberGraphX'
and `Picasso 96'. It also integrates color reduction algorithms to
convert high/true-color pictures to palette-mapped bitmaps. The API
allows the programmer to choose among several quantization and
dithering techniques to get better quality or faster conversion.

General concepts
================

<b>palette-mapped</b>
     a picture, bitmap or screen is said to be palette-mapped when the
     color of its pixels must be determined by looking up a color
     palette containing the RGB triplets associated with an index
     value. The palette is also called CLUT (Color Look-Up Table).

<b>direct-mapped</b>
     a picture, bitmap or screen whose pixels directly contain an RGB
     triplet. Direct-mapped pictures do not need a palette.

<b>native bitmap</b>
     a bitmap in which the image data is represented by bitplanes in
     the native format of the Amiga chipset (OCS/ECS/AGA).

<b>RTG bitmap</b>
     a bitmap with a custom pixel format which may not be accessed
     directly. Drawing into the bitmap must be performed through the
     functions provided by the <b>graphics.library</b> or by the RTG system.

Backwards compatibility
=======================

   For backwards compatibility, the unofficial V43 <b>picture.datatype</b>
implementations which were distributed with `CyberGraphX' and `Picasso
96' behaved just like the V42 and eariler implementations by default.
The picture returned to the application was stored in a native planar
bitmap, up to 8 bitplanes deep.

   In order to let the datatype allocate custom bitmaps (chunky 8bpp or
hi/truecolor), the application should set the PDTA_DestMode attribute
to PMODE_V43.

   This has changed as of V44. PMODE_V43 is now active by default.
Applications should never expect to get a native bitmap from the
picture.datatype unless they explicitly ask for PMODE_V42.

   The following summary shows the different behaviour kept by all the
known implementations of the <b>picture.datatype</b>:

<b>picture.datatype V40/V42 (OS 3.1)</b>
     PDTA_DestMode is ignored.

<b>picture.datatype V43 (CyberGraphX)</b>
     PDTA_DestMode defaults to PMODE_V42. The returned bitmap is always
     a planar one, with up to 8 bitplanes.

<b>picture.datatype V43 (Picasso 96)</b>
     PDTA_DestMode defaults to <b>PMODE_V42</b>. However, the returned bitmap
     is <b>NOT</b> native.

<b>picture.datatype V44 (OS 3.5)</b>
     PDTA_DestMode defaults to <b>PMODE_V43</b>. It can be explicitly forced
     to <b>PMODE_V42</b>.

   The V42 mode is retained in <b>picture.datatype</b> V44 for backwards
compatibility only. Use of the V42 mode in new applications is <b>STRONGLY
DISCOURAGED</b>. The V43 mode provides better performance for both the
internal operations carried out by the datatype and for most bitmap to
screen blitting operations.

New methods in unofficial V43 <b>picture.datatype</b>
==============================================

<b>PDTM_WRITEPIXELARRAY</b>
     Transfer pixel data to the picture object in the specified format

<b>PDTM_READPIXELARRAY</b>
     Transfer pixel data from the picture object in the specified format

New tags in unofficial V43 <b>picture.datatype</b>
===========================================

<b>PDTA_SourceMode</b>
     Set the sub datatype interface mode

<b>PDTA_DestMode</b>
     Set the app datatype interface mode

<b>PDTA_UseFriendBitMap</b>
     Allocates the resulting bitmap as a friend bitmap

<b>PDTA_MaskPlane</b>
     NULL or mask plane for use with BltMaskBitMapRastPort()

New tags in V44
===============

<b>PDTA_WhichPicture</b>
     Index number of the picture to load

<b>PDTA_GetNumPictures</b>
     Get the number of pictures stored in the file

<b>PDTA_MaxDitherPens</b>
     Maximum number of colours to use for dithering

<b>PDTA_DitherQuality</b>
     Quality of the dithering algorithm to be used during color
     quantization

<b>PDTA_AllocatedPens</b>
     Pointer to the allocated pen table
<!-- AG2HTML: BODY=END -->
</pre>
</body>
</html>
