@DATABASE "ARB51"
@INDEX "ARB:Misc/Index.Text/Main"
@HELP "ARB:Misc/Help/Main"
@NODE "Main" "ARexx For Beginners - Article 51 - Using ARexx With Other Programs"

@{B}@{U}@{JCENTER}AREXX FOR BEGINNERS

ARTICLE 51 - USING AREXX WITH OTHER PROGRAMS

BY FRANK BUNTON@{UB}@{UU}

@{" COPYRIGHT © FRANK P. BUNTON 1995-1998 " LINK "ARB:Misc/Read_Me_First!!/Copyright"}


@{" General Comments                                           " LINK "General"}
@{" Creating A window For ARexx Programs                       " LINK "Creating"}
@{"   Method 1 - READLN() for Input and WRITELN() for Output   " LINK "ReadWrite"}
@{"   Method 2 - OPEN New CLI for New STDIN and STDOUT Streams " LINK "NewCLI"}
@{"   Method 3 - CLOSE a Stream and OPEN a New Stream Window   " LINK "Stream"}


@{JCENTER}=== End of Text ===
@{JLEFT}
@ENDNODE

@NODE "General" "Article 51 - Using ARexx With Other Programs - General Comments"

@{B}@{U}@{JCENTER}GENERAL COMMENTS@{UB}@{UU}
@{JLEFT}
As there are now a vast number of programs available that can use ARexx,
I cannot possibly hope to explain how to use ARexx with all of them. Apart
from the time it would take, I just do not have copies of them all!! Thus
I do not know what those programs use when you are communicating with
them. As I have @{"mentioned before" LINK "ARB:Articles_21-30/23.Talking-Programs-1/instructions"}, such commands are part of the external
program. They are @{B}not@{UB} part of ARexx.

What I aim to do in the articles from here on is to talk about using ARexx
with Amigaguide or Multiview (and if you are reading this you will no doubt
have a copy of one or other of these programs!) and with the text editor
ED. This is provided as part the system with all Amigas and so all readers
should have it. However, if you are still using Workbench 1 then your
version of ED will @{B}not@{UB} have ARexx capabilities.

Maybe seeing how to use it with ED will give you some clue as to how to
use it with other programs.

If you have a look around Aminet you are sure to find lots of ARexx scripts
that are for use with the programs that you have. Get hold of them and read
them in conjunction with this manual and your program's manual. By
observing what they do when you run them and analysing the scripts you
should be able to learn how to program ARexx scipts for the program.

If you want to reread the articles that talk about the instructions and
principles used in communicating with other programs, then click
on:-

@{JCENTER}
@{"Articles 23" LINK "ARB:Articles_21-30/23.Talking-Programs-1/MAIN"}    and    @{"Article 24" LINK "ARB:Articles_21-30/24.Talking-Programs-2/MAIN"}
@{JLEFT}
Other articles will deal with using ARexx with these external programs:-
@{JCENTER}
@{" Using ARexx With ED Part 1            " LINK "ARB:Articles_51-60/52.ARexx_With_Ed_Pt-1/MAIN"}
@{" Using ARexx With ED Part 2            " LINK "ARB:Articles_51-60/53.ARexx_With_Ed_Pt-2/MAIN"}
@{" Character Transpose Program For ED    " LINK "ARB:Articles_51-60/54.ARexx_With_Ed_Transpose/MAIN"}
@{" Search & Replace Program For ED       " LINK "ARB:Articles_51-60/55.ARexx_With_Ed_SearchReplace/MAIN"}
@{" Using ARexx With Amigaguide/Multiview " LINK "ARB:Articles_51-60/56.ARexx_With_AG&MV/MAIN"}

@{JCENTER}=== End of Text ===
@{JLEFT}
@ENDNODE

@NODE "Creating" "Article 51 - Using ARexx With Other Programs - Creating Window For ARexx Programs"

@{B}@{U}@{JCENTER}CREATING A WINDOW FOR AREXX PROGRAMS STARTED FROM HOST PROGRAMS@{UB}@{UU}
@{JLEFT}
When you start up an ARexx program from AmigaDOS using a Shell/CLI window,
the ARexx program uses the window from which it was started for its STDIN
and STDOUT @{"streams" LINK "ARB:Misc/Glossary/Streams"}.

However, when an ARexx program is started from within another program
(i.e. from a host program) such as "ED" or "Amigaguide/Multiview" then
things are a bit different.

In some cases, the host program will open a window for the use of the
ARexx program and it will have the usual STDIN and STDOUT streams. Note,
however, that in some cases, this console window will NOT open until input
or output is needed!

Problems can arise, however, if the host program does NOT open a new console
window for ARexx. This seems to happen in a lot of cases. Maybe the program
writers intended that ARexx should do its work in the background without
the need for any user input and without any user visible output.

Way back in Article 2 I demonstrated an ARexx program that was run from
within "Amigaguide/Multiview" (the program displaying these articles).
@{"Click here" RX "ARB:Articles_01-10/testprogram"} to see it run again and @{"click here" LINK "ARB:Articles_01-10/testprogram.guide/MAIN"} to read the program.

This program used the following line to open a window with the logical
name STDOUT:-

  CALL OPEN('STDOUT','CON:140/50/360/50/TEST WINDOW FOR MULTIVIEW AREXX
       PROGRAM')

The above program had no need of a STDIN stream.

The problem we have to solve is how to make the same window allow the
user to INPUT and the program to OUTPUT into the same window.

There are a number of ways to do this which are described under these
headings:-
@{JCENTER}
@{" Method 1 - READLN() for Input and WRITELN() for Output   " LINK "ReadWrite"}
@{" Method 2 - OPEN New CLI for New STDIN and STDOUT Streams " LINK "NewCLI"}
@{" Method 3 - CLOSE a Stream and OPEN a New Stream Window   " LINK "Stream"}


@{JCENTER}=== End of Text ===
@{JLEFT}
@ENDNODE

@NODE "ReadWRite" "Article 51 - Using ARexx With Other Programs - Read() and Write() Method"

@{B}@{U}@{JCENTER}USE BOTH READLN() AND WRITELN() FOR INPUT AND OUTPUT@{UB}@{UU}
@{JLEFT}
We have already discussed the @{"method for opening a console window" LINK "ARB:Articles_21-30/28.file_Handling/console"} and
gave an @{"example" LINK "ARB:Articles_21-30/28.File_Handling/console"27} of its usage.

Example 51-1 is another example of its use.

@{"Click here" LINK "ARB:Articles_51-60/Example51-1.guide/MAIN"} to read the program.

@{"Click here" RX "ARB:Articles_51-60/Example51-1"} to see it in operations.

The program should need little explanation. It simply opens a window with
the logical file name "WindowFile" then has two internal functions which
are called to write to the file or read from the file:-

- Function Write:  uses WRITELN()  to write to the window

- Function Read:   uses READLN()   to read from the window


@{JCENTER}=== End of Text ===
@{JLEFT}
@ENDNODE

@NODE "NewCLI" "Article 51 - Using ARexx With Other Programs - STDIN and STDOUT Method"

@{B}@{U}@{JCENTER}USE BOTH STDIN AND STDOUT FOR INPUT AND OUTPUT@{UB}@{UU}
@{JLEFT}
When we discussed the use of @{"PRAGMA()" LINK "ARB:Articles_21-30/26.Pragma/General"} with the @{"'*'" LINK "ARB:Articles_21-30/26.Pragma/*"} option I mentioned
the problems with using PRAGMA('*') for this purpose.

The way I do it is a little cumbersome but the main thing is that it is
simple and @{B}it works!!@{UB}

However, before using it, you should make sure that the program that you
want to use it from does not have any other simpler way of doing the same
thing.

My method should be capable of being used with @{B}any@{UB} program that has ARexx
capabilities but which does not open a window for ARexx to use as STDIN
and STDOUT.

I have demonstrated my method in the following set of three disk based
program and script files. They can be activated by @{"clicking here" RX "ARB:Articles_51-60/Example51-2"}.

(Note that some programs, including Amigaguide/Multiview, need only
@{"two steps" LINK "NewCLI"55} but I am using all three steps here to demonstrate the method.)

The three files are:-

* @{B}1st File@{UB} @{"Example51-2.guide" LINK "ARB:Articles_51-60/Example51-2.guide/MAIN"} is a simple ARexx script with two lines:-

  - The first line makes AmigaDOS the host.

  - The second line sends the AmigaDOS command NEWCLI with a window
    specification and tells it to use the file @{B}Example51-2.script@{UB}

  If you use this in another program, then change the ".guide" suffix to
  that appropriate to the other program.

* @{B}2nd File@{UB} @{"Example51-2.script" LINK "ARB:Articles_51-60/Example51-2.script/MAIN"} is a simple AmigaDOS script with one line:-

  - The one line uses the AmigaDOS command RX to run the main
    ARexx program @{B}Example51-2.rexx@{UB}.

* @{B}3rd File@{UB} @{"Example51-2.rexx" LINK "ARB:Articles_51-60/Example51-2.rexx/MAIN"} is the ARexx program itself

  Because it is called from within a new Shell/CLI window it can be an
  absolutely normal ARexx program using SAY for output and PULL for
  input using the normal STDOUT and STDIN streams set up by the
  new Shell/CLI window.

  Note that the final line of this program:-

    ADDRESS 'COMMAND' 'EndCLI'

  is needed to get rid of the Shell/CLI window that was opened.

@{B}@{U}IMPORTANT NOTE@{UB}@{UU}

If the program in which you are using the above method has the capability
of sending commands direct to AmigaDOS then the first program can be
omitted.

Amigaguide/Multiview @{B}does@{UB} have this capability. I used all three disk
files just to illustrate the full method.

Using two disk files only can be demonstrated by @{"Clicking here" SYSTEM "NEWCLI CON:50/11/540/200/Window_for_Example51-3 FROM ARB:Articles_51-60/Example51-3.script"}

* @{B}1st step@{UB} (equivalent to the @{"first disk file above" LINK "NewCLI"25}) is to embed the
  following line into the text you are reading:-

  \@{"Clicking here" SYSTEM "NEWCLI CON:50/11/540/200/Window_for_Example51-3
  FROM ARB:Articles_51-60/Example51-3.script"}

  Note that this is all within one line without any line feeds in it.

  It uses the Amigaguide/Multiview attribute command SYSTEM to send an
  AmigaDOS command which is:-

  NEWCLI CON:50/11/540/200/Window_for_Example51-3 FROM
  ARB:Articles_51-60/Example51-3.script

  This opens a new CLI window and executes the file Example51-3.script
  in that window. The ARexx program run from it adopts the CLI's
  STDIN and STDOUT streams.

* @{B}1st File@{UB} @{"Example51-3.script" LINK "ARB:Articles_51-60/Example51-3.script/MAIN"} is a simple AmigaDOS script with one line.

  - The one line uses the AmigaDOS command RX to run the main
    ARexx program @{B}Example51-3.rexx@{UB}.

  - It is virtually the same as Example51-2.script which is the
    @{"2nd file used above" LINK "NewCLI"35}.

* @{B}2nd File@{UB} @{"Example51-3.rexx" LINK "ARB:Articles_51-60/Example51-3.rexx/MAIN"} is the ARexx program itself.

  - It is virtually the same as @{"Example51-2.rexx" LINK "NewCLI"40}


@{JCENTER}=== End of Text ===
@{JLEFT}
@ENDNODE

@NODE "Stream" "Article 51 - Using ARexx With Other Programs - CLOSE a Stream and OPEN a New Stream Window"

@{B}@{U}@{JCENTER}CLOSE A STREAM AND OPEN A NEW STREAM WINDOW@{UB}@{UU}
@{JLEFT}
This method consists of one of these procedures:-

@{B}Procedure 1@{UB}:-

* Close STDIN
* Open a new window with logical file name "STDIN" to handle input,
* Use WRITELN() to write to logical file "STDIN" for output.

@{B}Procedure 2@{UB}

* Close STDOUT
* Open a new window with logical filename "STDOUT" to handle output,
* Use READLN() to read from logical file "STDOUT" for input

Which of these two procedures you use would depend on  whether you had:-

- more input than output (Use Procedure 1),

- more output than input (Use Procedure 2).

Either way, it has the advantages shown below:-

- Only one internal function (for either reading or writing) is needed
  instead of @{"two internal functions" LINK "ReadWrite"}

- Only one disk program file is needed instead of @{"three" LINK "NewCLI"23} or @{"two" LINK "NewCLI"62}

- The problems with @{"PRAGMA('*')" LINK "ARB:Articles_21-30/26.Pragma/*"}  are avoided.

@{B}Example51-4 illustrates Procedure 1@{UB}.

@{"Click here" LINK "ARB:Articles_51-60/Example51-4.guide/MAIN"} to read it.

@{"Click here" RX "ARB:Articles_51-60/Example51-4"} to run it.

@{B}Example51-5 illustrates Procedure 2@{UB}.

@{"Click here" LINK "ARB:Articles_51-60/Example51-5.guide/MAIN"} to read it.

@{"Click here" RX "ARB:Articles_51-60/Example51-5"} to run it.


@{JCENTER}=== End of Text ===
@{JLEFT}
@ENDNODE
